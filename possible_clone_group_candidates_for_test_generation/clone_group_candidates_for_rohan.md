# Possible Clone Group Candidates for Random Input Test

## Candidates with size > 2

### commons_math_3_6_1

### 1

<span style="color:red"> More tests could be generated by using different numerical parameters, especially through the testing of important angles like 90 or 180 degrees. </span>

[317, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDSTest', 'testComposeVectorOperator', 809, 836]

[317, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDSTest', 'testComposeFrameTransform', 838, 865]

[317, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDSTest', 'testComposeInverseVectorOperator', 895, 922]

[317, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDSTest', 'testComposeInverseframeTransform', 924, 951]

[317, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDfpTest', 'testComposeVectorOperator', 646, 673]

[317, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDfpTest', 'testComposeInverseVectorOperator', 734, 761]

```java
    @Test
    public void testComposeVectorOperator() throws MathIllegalArgumentException {

        FieldRotation<DerivativeStructure> r1       = new FieldRotation<DerivativeStructure>(createVector(2, -3, 5),
                                                                                             createAngle(1.7),
                                                                                             RotationConvention.VECTOR_OPERATOR);
        FieldRotation<DerivativeStructure> r2       = new FieldRotation<DerivativeStructure>(createVector(-1, 3, 2),
                                                                                             createAngle(0.3),
                                                                                             RotationConvention.VECTOR_OPERATOR);
        FieldRotation<DerivativeStructure> r3       = r2.compose(r1, RotationConvention.VECTOR_OPERATOR);
        FieldRotation<DerivativeStructure> r3Double = r2.compose(new Rotation(r1.getQ0().getReal(),
                                                                              r1.getQ1().getReal(),
                                                                              r1.getQ2().getReal(),
                                                                              r1.getQ3().getReal(),
                                                                              false),
                                                                 RotationConvention.VECTOR_OPERATOR);

        for (double x = -0.9; x < 0.9; x += 0.2) {
            for (double y = -0.9; y < 0.9; y += 0.2) {
                for (double z = -0.9; z < 0.9; z += 0.2) {
                    FieldVector3D<DerivativeStructure> u = createVector(x, y, z);
                    checkVector(r2.applyTo(r1.applyTo(u)), r3.applyTo(u));
                    checkVector(r2.applyTo(r1.applyTo(u)), r3Double.applyTo(u));
                }
            }
        }

    }

    @Test
    public void testComposeFrameTransform() throws MathIllegalArgumentException {

        FieldRotation<DerivativeStructure> r1       = new FieldRotation<DerivativeStructure>(createVector(2, -3, 5),
                                                                                             createAngle(1.7),
                                                                                             RotationConvention.FRAME_TRANSFORM);
        FieldRotation<DerivativeStructure> r2       = new FieldRotation<DerivativeStructure>(createVector(-1, 3, 2),
                                                                                             createAngle(0.3),
                                                                                             RotationConvention.FRAME_TRANSFORM);
        FieldRotation<DerivativeStructure> r3       = r2.compose(r1, RotationConvention.FRAME_TRANSFORM);
        FieldRotation<DerivativeStructure> r3Double = r2.compose(new Rotation(r1.getQ0().getReal(),
                                                                              r1.getQ1().getReal(),
                                                                              r1.getQ2().getReal(),
                                                                              r1.getQ3().getReal(),
                                                                              false),
                                                                 RotationConvention.FRAME_TRANSFORM);

        for (double x = -0.9; x < 0.9; x += 0.2) {
            for (double y = -0.9; y < 0.9; y += 0.2) {
                for (double z = -0.9; z < 0.9; z += 0.2) {
                    FieldVector3D<DerivativeStructure> u = createVector(x, y, z);
                    checkVector(r1.applyTo(r2.applyTo(u)), r3.applyTo(u));
                    checkVector(r1.applyTo(r2.applyTo(u)), r3Double.applyTo(u));
                }
            }
        }

    }

    @Test
    public void testComposeInverseVectorOperator() throws MathIllegalArgumentException {

        FieldRotation<DerivativeStructure> r1 = new FieldRotation<DerivativeStructure>(createVector(2, -3, 5),
                                                                                       createAngle(1.7),
                                                                                       RotationConvention.VECTOR_OPERATOR);
        FieldRotation<DerivativeStructure> r2 = new FieldRotation<DerivativeStructure>(createVector(-1, 3, 2),
                                                                                       createAngle(0.3),
                                                                                       RotationConvention.VECTOR_OPERATOR);
        FieldRotation<DerivativeStructure> r3 = r2.composeInverse(r1, RotationConvention.VECTOR_OPERATOR);
        FieldRotation<DerivativeStructure> r3Double = r2.composeInverse(new Rotation(r1.getQ0().getReal(),
                                                                                     r1.getQ1().getReal(),
                                                                                     r1.getQ2().getReal(),
                                                                                     r1.getQ3().getReal(),
                                                                                     false),
                                                                        RotationConvention.VECTOR_OPERATOR);

        for (double x = -0.9; x < 0.9; x += 0.2) {
            for (double y = -0.9; y < 0.9; y += 0.2) {
                for (double z = -0.9; z < 0.9; z += 0.2) {
                    FieldVector3D<DerivativeStructure> u = createVector(x, y, z);
                    checkVector(r2.applyInverseTo(r1.applyTo(u)), r3.applyTo(u));
                    checkVector(r2.applyInverseTo(r1.applyTo(u)), r3Double.applyTo(u));
                }
            }
        }

    }

    @Test
    public void testComposeInverseframeTransform() throws MathIllegalArgumentException {

        FieldRotation<DerivativeStructure> r1 = new FieldRotation<DerivativeStructure>(createVector(2, -3, 5),
                                                                                       createAngle(1.7),
                                                                                       RotationConvention.FRAME_TRANSFORM);
        FieldRotation<DerivativeStructure> r2 = new FieldRotation<DerivativeStructure>(createVector(-1, 3, 2),
                                                                                       createAngle(0.3),
                                                                                       RotationConvention.FRAME_TRANSFORM);
        FieldRotation<DerivativeStructure> r3 = r2.composeInverse(r1, RotationConvention.FRAME_TRANSFORM);
        FieldRotation<DerivativeStructure> r3Double = r2.composeInverse(new Rotation(r1.getQ0().getReal(),
                                                                                     r1.getQ1().getReal(),
                                                                                     r1.getQ2().getReal(),
                                                                                     r1.getQ3().getReal(),
                                                                                     false),
                                                                        RotationConvention.FRAME_TRANSFORM);

        for (double x = -0.9; x < 0.9; x += 0.2) {
            for (double y = -0.9; y < 0.9; y += 0.2) {
                for (double z = -0.9; z < 0.9; z += 0.2) {
                    FieldVector3D<DerivativeStructure> u = createVector(x, y, z);
                    checkVector(r1.applyTo(r2.applyInverseTo(u)), r3.applyTo(u));
                    checkVector(r1.applyTo(r2.applyInverseTo(u)), r3Double.applyTo(u));
                }
            }
        }

    }

    @Test
    public void testComposeVectorOperator() throws MathIllegalArgumentException {

        FieldRotation<Dfp> r1       = new FieldRotation<Dfp>(createVector(2, -3, 5),
                                                             createAngle(1.7),
                                                             RotationConvention.VECTOR_OPERATOR);
        FieldRotation<Dfp> r2       = new FieldRotation<Dfp>(createVector(-1, 3, 2),
                                                             createAngle(0.3),
                                                             RotationConvention.VECTOR_OPERATOR);
        FieldRotation<Dfp> r3       = r2.compose(r1, RotationConvention.VECTOR_OPERATOR);
        FieldRotation<Dfp> r3Double = r2.compose(new Rotation(r1.getQ0().getReal(),
                                                      r1.getQ1().getReal(),
                                                      r1.getQ2().getReal(),
                                                      r1.getQ3().getReal(),
                                                      false),
                                                 RotationConvention.VECTOR_OPERATOR);

        for (double x = -0.9; x < 0.9; x += 0.2) {
            for (double y = -0.9; y < 0.9; y += 0.2) {
                for (double z = -0.9; z < 0.9; z += 0.2) {
                    FieldVector3D<Dfp> u = createVector(x, y, z);
                    checkVector(r2.applyTo(r1.applyTo(u)), r3.applyTo(u));
                    checkVector(r2.applyTo(r1.applyTo(u)), r3Double.applyTo(u));
                }
            }
        }

    }

    @Test
    public void testComposeInverseVectorOperator() throws MathIllegalArgumentException {

        FieldRotation<Dfp> r1 = new FieldRotation<Dfp>(createVector(2, -3, 5),
                                                       createAngle(1.7),
                                                       RotationConvention.VECTOR_OPERATOR);
        FieldRotation<Dfp> r2 = new FieldRotation<Dfp>(createVector(-1, 3, 2),
                                                       createAngle(0.3),
                                                       RotationConvention.VECTOR_OPERATOR);
        FieldRotation<Dfp> r3 = r2.composeInverse(r1, RotationConvention.VECTOR_OPERATOR);
        FieldRotation<Dfp> r3Double = r2.composeInverse(new Rotation(r1.getQ0().getReal(),
                                                             r1.getQ1().getReal(),
                                                             r1.getQ2().getReal(),
                                                             r1.getQ3().getReal(),
                                                             false),
                                                        RotationConvention.VECTOR_OPERATOR);

        for (double x = -0.9; x < 0.9; x += 0.2) {
            for (double y = -0.9; y < 0.9; y += 0.2) {
                for (double z = -0.9; z < 0.9; z += 0.2) {
                    FieldVector3D<Dfp> u = createVector(x, y, z);
                    checkVector(r2.applyInverseTo(r1.applyTo(u)), r3.applyTo(u));
                    checkVector(r2.applyInverseTo(r1.applyTo(u)), r3Double.applyTo(u));
                }
            }
        }

    }
```

### 2

<span style="color:red"> Similar idea to Candidate **1** </span>

[381, 'src/test/java', 'org.apache.commons.math3.optim.nonlinear.scalar.noderiv', 'SimplexOptimizerMultiDirectionalTest', 'testMinimize1', 48, 67]

[381, 'src/test/java', 'org.apache.commons.math3.optim.nonlinear.scalar.noderiv', 'SimplexOptimizerNelderMeadTest', 'testMinimize1', 53, 72]

[381, 'src/test/java', 'org.apache.commons.math3.optim.nonlinear.scalar.noderiv', 'SimplexOptimizerNelderMeadTest', 'testMaximize1', 95, 114]

```java
    @Test
    public void testMinimize1() {
        SimplexOptimizer optimizer = new SimplexOptimizer(1e-11, 1e-30);
        final FourExtrema fourExtrema = new FourExtrema();

        final PointValuePair optimum
            = optimizer.optimize(new MaxEval(200),
                                 new ObjectiveFunction(fourExtrema),
                                 GoalType.MINIMIZE,
                                 new InitialGuess(new double[] { -3, 0 }),
                                 new MultiDirectionalSimplex(new double[] { 0.2, 0.2 }));
        Assert.assertEquals(fourExtrema.xM, optimum.getPoint()[0], 4e-6);
        Assert.assertEquals(fourExtrema.yP, optimum.getPoint()[1], 3e-6);
        Assert.assertEquals(fourExtrema.valueXmYp, optimum.getValue(), 8e-13);
        Assert.assertTrue(optimizer.getEvaluations() > 120);
        Assert.assertTrue(optimizer.getEvaluations() < 150);

        // Check that the number of iterations is updated (MATH-949).
        Assert.assertTrue(optimizer.getIterations() > 0);
    }

    @Test
    public void testMinimize1() {
        SimplexOptimizer optimizer = new SimplexOptimizer(1e-10, 1e-30);
        final FourExtrema fourExtrema = new FourExtrema();

        final PointValuePair optimum
            = optimizer.optimize(new MaxEval(100),
                                 new ObjectiveFunction(fourExtrema),
                                 GoalType.MINIMIZE,
                                 new InitialGuess(new double[] { -3, 0 }),
                                 new NelderMeadSimplex(new double[] { 0.2, 0.2 }));
        Assert.assertEquals(fourExtrema.xM, optimum.getPoint()[0], 2e-7);
        Assert.assertEquals(fourExtrema.yP, optimum.getPoint()[1], 2e-5);
        Assert.assertEquals(fourExtrema.valueXmYp, optimum.getValue(), 6e-12);
        Assert.assertTrue(optimizer.getEvaluations() > 60);
        Assert.assertTrue(optimizer.getEvaluations() < 90);

        // Check that the number of iterations is updated (MATH-949).
        Assert.assertTrue(optimizer.getIterations() > 0);
    }

    @Test
    public void testMaximize1() {
        SimplexOptimizer optimizer = new SimplexOptimizer(1e-10, 1e-30);
        final FourExtrema fourExtrema = new FourExtrema();

        final PointValuePair optimum
            = optimizer.optimize(new MaxEval(100),
                                 new ObjectiveFunction(fourExtrema),
                                 GoalType.MAXIMIZE,
                                 new InitialGuess(new double[] { -3, 0 }),
                                 new NelderMeadSimplex(new double[] { 0.2, 0.2 }));
        Assert.assertEquals(fourExtrema.xM, optimum.getPoint()[0], 1e-5);
        Assert.assertEquals(fourExtrema.yM, optimum.getPoint()[1], 3e-6);
        Assert.assertEquals(fourExtrema.valueXmYm, optimum.getValue(), 3e-12);
        Assert.assertTrue(optimizer.getEvaluations() > 60);
        Assert.assertTrue(optimizer.getEvaluations() < 90);

        // Check that the number of iterations is updated (MATH-949).
        Assert.assertTrue(optimizer.getIterations() > 0);
    }
```

### 3

<span style="color:red"> Similar idea to Candidate **1** </span>

[415, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDSTest', 'testAxisAngleVectorOperator', 88, 127]

[415, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDSTest', 'testAxisAngleFrameTransform', 129, 168]

[415, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDfpTest', 'testAxisAngleVectorOperator', 87, 126]

[415, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDfpTest', 'testAxisAngleFrameTransform', 128, 167]

```java
    @Test
    public void testAxisAngleVectorOperator() throws MathIllegalArgumentException {

        FieldRotation<DerivativeStructure> r = new FieldRotation<DerivativeStructure>(createAxis(10, 10, 10),
                                                                                      createAngle(2 * FastMath.PI / 3) ,
                                                                                      RotationConvention.VECTOR_OPERATOR);
        checkVector(r.applyTo(createVector(1, 0, 0)), createVector(0, 1, 0));
        checkVector(r.applyTo(createVector(0, 1, 0)), createVector(0, 0, 1));
        checkVector(r.applyTo(createVector(0, 0, 1)), createVector(1, 0, 0));
        double s = 1 / FastMath.sqrt(3);
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector( s,  s,  s));
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(-s, -s, -s));
        checkAngle(r.getAngle(), 2 * FastMath.PI / 3);

        try {
            new FieldRotation<DerivativeStructure>(createAxis(0, 0, 0),
                                                   createAngle(2 * FastMath.PI / 3),
                                                   RotationConvention.VECTOR_OPERATOR);
            Assert.fail("an exception should have been thrown");
        } catch (MathIllegalArgumentException e) {
        }

        r = new FieldRotation<DerivativeStructure>(createAxis(0, 0, 1),
                                                   createAngle(1.5 * FastMath.PI),
                                                   RotationConvention.VECTOR_OPERATOR);
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(0, 0, -1));
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(0, 0, +1));
        checkAngle(r.getAngle(), 0.5 * FastMath.PI);

        r = new FieldRotation<DerivativeStructure>(createAxis(0, 1, 0),
                                                   createAngle(FastMath.PI),
                                                   RotationConvention.VECTOR_OPERATOR);
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(0, +1, 0));
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(0, -1, 0));
        checkAngle(r.getAngle(), FastMath.PI);

        checkVector(createRotation(1, 0, 0, 0, false).getAxis(RotationConvention.VECTOR_OPERATOR), createVector(+1, 0, 0));
        checkVector(createRotation(1, 0, 0, 0, false).getAxis(RotationConvention.FRAME_TRANSFORM), createVector(-1, 0, 0));

    }

    @Test
    public void testAxisAngleFrameTransform() throws MathIllegalArgumentException {

        FieldRotation<DerivativeStructure> r = new FieldRotation<DerivativeStructure>(createAxis(10, 10, 10),
                                                                                      createAngle(2 * FastMath.PI / 3) ,
                                                                                      RotationConvention.FRAME_TRANSFORM);
        checkVector(r.applyTo(createVector(1, 0, 0)), createVector(0, 0, 1));
        checkVector(r.applyTo(createVector(0, 1, 0)), createVector(1, 0, 0));
        checkVector(r.applyTo(createVector(0, 0, 1)), createVector(0, 1, 0));
        double s = 1 / FastMath.sqrt(3);
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector( s,  s,  s));
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(-s, -s, -s));
        checkAngle(r.getAngle(), 2 * FastMath.PI / 3);

        try {
            new FieldRotation<DerivativeStructure>(createAxis(0, 0, 0),
                                                   createAngle(2 * FastMath.PI / 3),
                                                   RotationConvention.FRAME_TRANSFORM);
            Assert.fail("an exception should have been thrown");
        } catch (MathIllegalArgumentException e) {
        }

        r = new FieldRotation<DerivativeStructure>(createAxis(0, 0, 1),
                                                   createAngle(1.5 * FastMath.PI),
                                                   RotationConvention.FRAME_TRANSFORM);
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(0, 0, -1));
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(0, 0, +1));
        checkAngle(r.getAngle(), 0.5 * FastMath.PI);

        r = new FieldRotation<DerivativeStructure>(createAxis(0, 1, 0),
                                                   createAngle(FastMath.PI),
                                                   RotationConvention.FRAME_TRANSFORM);
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(0, +1, 0));
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(0, -1, 0));
        checkAngle(r.getAngle(), FastMath.PI);

        checkVector(createRotation(1, 0, 0, 0, false).getAxis(RotationConvention.FRAME_TRANSFORM), createVector(-1, 0, 0));
        checkVector(createRotation(1, 0, 0, 0, false).getAxis(RotationConvention.VECTOR_OPERATOR), createVector(+1, 0, 0));

    }

    @Test
    public void testAxisAngleVectorOperator() throws MathIllegalArgumentException {

        FieldRotation<Dfp> r = new FieldRotation<Dfp>(createAxis(10, 10, 10),
                                                      createAngle(2 * FastMath.PI / 3) ,
                                                      RotationConvention.VECTOR_OPERATOR);
        checkVector(r.applyTo(createVector(1, 0, 0)), createVector(0, 1, 0));
        checkVector(r.applyTo(createVector(0, 1, 0)), createVector(0, 0, 1));
        checkVector(r.applyTo(createVector(0, 0, 1)), createVector(1, 0, 0));
        double s = 1 / FastMath.sqrt(3);
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector( s,  s,  s));
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(-s, -s, -s));
        checkAngle(r.getAngle(), 2 * FastMath.PI / 3);

        try {
            new FieldRotation<Dfp>(createAxis(0, 0, 0),
                                   createAngle(2 * FastMath.PI / 3),
                                   RotationConvention.VECTOR_OPERATOR);
            Assert.fail("an exception should have been thrown");
        } catch (MathIllegalArgumentException e) {
        }

        r = new FieldRotation<Dfp>(createAxis(0, 0, 1),
                                   createAngle(1.5 * FastMath.PI),
                                   RotationConvention.VECTOR_OPERATOR);
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(0, 0, -1));
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(0, 0, +1));
        checkAngle(r.getAngle(), 0.5 * FastMath.PI);

        r = new FieldRotation<Dfp>(createAxis(0, 1, 0),
                                   createAngle(FastMath.PI),
                                   RotationConvention.VECTOR_OPERATOR);
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(0, +1, 0));
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(0, -1, 0));
        checkAngle(r.getAngle(), FastMath.PI);

        checkVector(createRotation(1, 0, 0, 0, false).getAxis(RotationConvention.VECTOR_OPERATOR), createVector(+1, 0, 0));
        checkVector(createRotation(1, 0, 0, 0, false).getAxis(RotationConvention.FRAME_TRANSFORM), createVector(-1, 0, 0));

    }

    @Test
    public void testAxisAngleFrameTransform() throws MathIllegalArgumentException {

        FieldRotation<Dfp> r = new FieldRotation<Dfp>(createAxis(10, 10, 10),
                                                      createAngle(2 * FastMath.PI / 3) ,
                                                      RotationConvention.FRAME_TRANSFORM);
        checkVector(r.applyTo(createVector(1, 0, 0)), createVector(0, 0, 1));
        checkVector(r.applyTo(createVector(0, 1, 0)), createVector(1, 0, 0));
        checkVector(r.applyTo(createVector(0, 0, 1)), createVector(0, 1, 0));
        double s = 1 / FastMath.sqrt(3);
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector( s,  s,  s));
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(-s, -s, -s));
        checkAngle(r.getAngle(), 2 * FastMath.PI / 3);

        try {
            new FieldRotation<Dfp>(createAxis(0, 0, 0),
                                   createAngle(2 * FastMath.PI / 3),
                                   RotationConvention.FRAME_TRANSFORM);
            Assert.fail("an exception should have been thrown");
        } catch (MathIllegalArgumentException e) {
        }

        r = new FieldRotation<Dfp>(createAxis(0, 0, 1),
                                   createAngle(1.5 * FastMath.PI),
                                   RotationConvention.FRAME_TRANSFORM);
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(0, 0, -1));
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(0, 0, +1));
        checkAngle(r.getAngle(), 0.5 * FastMath.PI);

        r = new FieldRotation<Dfp>(createAxis(0, 1, 0),
                                   createAngle(FastMath.PI),
                                   RotationConvention.FRAME_TRANSFORM);
        checkVector(r.getAxis(RotationConvention.FRAME_TRANSFORM), createVector(0, +1, 0));
        checkVector(r.getAxis(RotationConvention.VECTOR_OPERATOR), createVector(0, -1, 0));
        checkAngle(r.getAngle(), FastMath.PI);

        checkVector(createRotation(1, 0, 0, 0, false).getAxis(RotationConvention.FRAME_TRANSFORM), createVector(-1, 0, 0));
        checkVector(createRotation(1, 0, 0, 0, false).getAxis(RotationConvention.VECTOR_OPERATOR), createVector(+1, 0, 0));

    }
```

### 4

<span style="color:red"> The tests have differences in operations. More tests may be introduced to this family of test groups. 
Currently this is not refactorable, and shall be considered a good candidate for bug searching, especially for the case of division. </span>

[662, 'src/test/java', 'org.apache.commons.math3.analysis.differentiation', 'SparseGradientTest', 'testVarAddition', 55, 69]

[662, 'src/test/java', 'org.apache.commons.math3.analysis.differentiation', 'SparseGradientTest', 'testSubtraction', 71, 85]

[662, 'src/test/java', 'org.apache.commons.math3.analysis.differentiation', 'SparseGradientTest', 'testDivision', 87, 100]

```java
    @Test
    public void testVarAddition() {
        final double v1 = 1.0;
        final double v2 = 2.0;
        final int id1 = -1;
        final int id2 = 3;
        final SparseGradient var1 = SparseGradient.createVariable(id1, v1);
        final SparseGradient var2 = SparseGradient.createVariable(id2, v2);
        final SparseGradient sum = var1.add(var2);

        Assert.assertEquals(v1 + v2, sum.getValue(), 1.0e-15); // returns the value
        Assert.assertEquals(2, sum.numVars());
        Assert.assertEquals(1.0, sum.getDerivative(id1), 1.0e-15);
        Assert.assertEquals(1.0, sum.getDerivative(id2), 1.0e-15);
    }

    @Test
    public void testSubtraction() {
        final double v1 = 1.0;
        final double v2 = 2.0;
        final int id1 = -1;
        final int id2 = 3;
        final SparseGradient var1 = SparseGradient.createVariable(id1, v1);
        final SparseGradient var2 = SparseGradient.createVariable(id2, v2);
        final SparseGradient sum = var1.subtract(var2);

        Assert.assertEquals(v1 - v2, sum.getValue(), 1.0e-15); // returns the value
        Assert.assertEquals(2, sum.numVars());
        Assert.assertEquals(1.0, sum.getDerivative(id1), 1.0e-15);
        Assert.assertEquals(-1.0, sum.getDerivative(id2), 1.0e-15);
    }

    @Test
    public void testDivision() {
        final double v1 = 1.0;
        final double v2 = 2.0;
        final int id1 = -1;
        final int id2 = 3;
        final SparseGradient var1 = SparseGradient.createVariable(id1, v1);
        final SparseGradient var2 = SparseGradient.createVariable(id2, v2);
        final SparseGradient out = var1.divide(var2);
        Assert.assertEquals(v1 / v2, out.getValue(), 1.0e-15); // returns the value
        Assert.assertEquals(2, out.numVars());
        Assert.assertEquals(1 / v2, out.getDerivative(id1), 1.0e-15);
        Assert.assertEquals(-1 / (v2 * v2), out.getDerivative(id2), 1.0e-15);
    }
```

### commons_io_2.5

### 5

<span style="color:red"> Could generate more tests for case non-sensitive scenario, or with different strings containing special characters to have more possiblities to find bugs </span>

[218, 'src/test/java', 'org.apache.commons.io', 'IOCaseTestCase', 'test_checkEquals_functionality', 127, 151]

[218, 'src/test/java', 'org.apache.commons.io', 'IOCaseTestCase', 'test_checkStartsWith_functionality', 166, 190]

[218, 'src/test/java', 'org.apache.commons.io', 'IOCaseTestCase', 'test_checkEndsWith_functionality', 205, 229]

```java
    @Test
    public void test_checkEquals_functionality() throws Exception {
        assertFalse(IOCase.SENSITIVE.checkEquals("ABC", ""));
        assertFalse(IOCase.SENSITIVE.checkEquals("ABC", "A"));
        assertFalse(IOCase.SENSITIVE.checkEquals("ABC", "AB"));
        assertTrue(IOCase.SENSITIVE.checkEquals("ABC", "ABC"));
        assertFalse(IOCase.SENSITIVE.checkEquals("ABC", "BC"));
        assertFalse(IOCase.SENSITIVE.checkEquals("ABC", "C"));
        assertFalse(IOCase.SENSITIVE.checkEquals("ABC", "ABCD"));
        assertFalse(IOCase.SENSITIVE.checkEquals("", "ABC"));
        assertTrue(IOCase.SENSITIVE.checkEquals("", ""));

        try {
            IOCase.SENSITIVE.checkEquals("ABC", null);
            fail();
        } catch (final NullPointerException ignore) {}
        try {
            IOCase.SENSITIVE.checkEquals(null, "ABC");
            fail();
        } catch (final NullPointerException ignore) {}
        try {
            IOCase.SENSITIVE.checkEquals(null, null);
            fail();
        } catch (final NullPointerException ignore) {}
    }

    @Test
    public void test_checkStartsWith_functionality() throws Exception {
        assertTrue(IOCase.SENSITIVE.checkStartsWith("ABC", ""));
        assertTrue(IOCase.SENSITIVE.checkStartsWith("ABC", "A"));
        assertTrue(IOCase.SENSITIVE.checkStartsWith("ABC", "AB"));
        assertTrue(IOCase.SENSITIVE.checkStartsWith("ABC", "ABC"));
        assertFalse(IOCase.SENSITIVE.checkStartsWith("ABC", "BC"));
        assertFalse(IOCase.SENSITIVE.checkStartsWith("ABC", "C"));
        assertFalse(IOCase.SENSITIVE.checkStartsWith("ABC", "ABCD"));
        assertFalse(IOCase.SENSITIVE.checkStartsWith("", "ABC"));
        assertTrue(IOCase.SENSITIVE.checkStartsWith("", ""));

        try {
            IOCase.SENSITIVE.checkStartsWith("ABC", null);
            fail();
        } catch (final NullPointerException ignore) {}
        try {
            IOCase.SENSITIVE.checkStartsWith(null, "ABC");
            fail();
        } catch (final NullPointerException ignore) {}
        try {
            IOCase.SENSITIVE.checkStartsWith(null, null);
            fail();
        } catch (final NullPointerException ignore) {}
    }

    @Test
    public void test_checkEndsWith_functionality() throws Exception {
        assertTrue(IOCase.SENSITIVE.checkEndsWith("ABC", ""));
        assertFalse(IOCase.SENSITIVE.checkEndsWith("ABC", "A"));
        assertFalse(IOCase.SENSITIVE.checkEndsWith("ABC", "AB"));
        assertTrue(IOCase.SENSITIVE.checkEndsWith("ABC", "ABC"));
        assertTrue(IOCase.SENSITIVE.checkEndsWith("ABC", "BC"));
        assertTrue(IOCase.SENSITIVE.checkEndsWith("ABC", "C"));
        assertFalse(IOCase.SENSITIVE.checkEndsWith("ABC", "ABCD"));
        assertFalse(IOCase.SENSITIVE.checkEndsWith("", "ABC"));
        assertTrue(IOCase.SENSITIVE.checkEndsWith("", ""));

        try {
            IOCase.SENSITIVE.checkEndsWith("ABC", null);
            fail();
        } catch (final NullPointerException ignore) {}
        try {
            IOCase.SENSITIVE.checkEndsWith(null, "ABC");
            fail();
        } catch (final NullPointerException ignore) {}
        try {
            IOCase.SENSITIVE.checkEndsWith(null, null);
            fail();
        } catch (final NullPointerException ignore) {}
    }
```

### 6

<span style="color:red"> Possible to generate more tests with varying file name for the binary file, or with encoding formats other than UTF8 </span>

[467, 'src/test/java', 'org.apache.commons.io.input', 'ReversedLinesFileReaderTestParamBlockSize', 'testIsoFileDefaults', 85, 90]

[467, 'src/test/java', 'org.apache.commons.io.input', 'ReversedLinesFileReaderTestParamBlockSize', 'testUTF8FileWindowsBreaks', 92, 97]

[467, 'src/test/java', 'org.apache.commons.io.input', 'ReversedLinesFileReaderTestParamBlockSize', 'testUTF8FileCRBreaks', 99, 104]

[467, 'src/test/java', 'org.apache.commons.io.input', 'ReversedLinesFileReaderTestParamBlockSize', 'testUTF8File', 106, 111]

[467, 'src/test/java', 'org.apache.commons.io.input', 'ReversedLinesFileReaderTestParamBlockSize', 'testUTF8FileWindowsBreaksSmallBlockSize2VerifyBlockSpanningNewLines', 184, 189]

```java
    @Test
    public void testIsoFileDefaults() throws URISyntaxException, IOException {
        final File testFileIso = new File(this.getClass().getResource("/test-file-iso8859-1.bin").toURI());
        reversedLinesFileReader = new ReversedLinesFileReader(testFileIso, testParamBlockSize, ISO_8859_1);
        assertFileWithShrinkingTestLines(reversedLinesFileReader);
    }

    @Test
    public void testUTF8FileWindowsBreaks() throws URISyntaxException, IOException {
        final File testFileIso = new File(this.getClass().getResource("/test-file-utf8-win-linebr.bin").toURI());
        reversedLinesFileReader = new ReversedLinesFileReader(testFileIso, testParamBlockSize, UTF_8);
        assertFileWithShrinkingTestLines(reversedLinesFileReader);
    }

    @Test
    public void testUTF8FileCRBreaks() throws URISyntaxException, IOException {
        final File testFileIso = new File(this.getClass().getResource("/test-file-utf8-cr-only.bin").toURI());
        reversedLinesFileReader = new ReversedLinesFileReader(testFileIso, testParamBlockSize, UTF_8);
        assertFileWithShrinkingTestLines(reversedLinesFileReader);
    }

    @Test
    public void testUTF8File() throws URISyntaxException, IOException {
        final File testFileIso = new File(this.getClass().getResource("/test-file-utf8.bin").toURI());
        reversedLinesFileReader = new ReversedLinesFileReader(testFileIso, testParamBlockSize, UTF_8);
        assertFileWithShrinkingTestLines(reversedLinesFileReader);
    }

    @Test
    public void testUTF8FileWindowsBreaksSmallBlockSize2VerifyBlockSpanningNewLines() throws URISyntaxException, IOException {
        final File testFileUtf8 = new File(this.getClass().getResource("/test-file-utf8-win-linebr.bin").toURI());
        reversedLinesFileReader = new ReversedLinesFileReader(testFileUtf8, testParamBlockSize, UTF_8);
        assertFileWithShrinkingTestLines(reversedLinesFileReader);
    }
```

### solr_6.6.6

### 7

<span style="color:red"> This clone group contains varying styles of url in the test cases. It is a good candidate to generate more test cases for bug search.</span>

[2158, 'src/test', 'org.apache.solr.handler.component', 'TestHttpShardHandlerFactory', 'testWhitelistHostCheckerSingleHost', 124, 128]

[2158, 'src/test', 'org.apache.solr.handler.component', 'TestHttpShardHandlerFactory', 'testWhitelistHostCheckerMultipleHost', 130, 134]

[2158, 'src/test', 'org.apache.solr.handler.component', 'TestHttpShardHandlerFactory', 'testWhitelistHostCheckerNoProtocolInParameter', 142, 146]

[2158, 'src/test', 'org.apache.solr.handler.component', 'TestHttpShardHandlerFactory', 'testWhitelistHostCheckerNonWhitelistedHostHttps', 172, 176]

[2158, 'src/test', 'org.apache.solr.handler.component', 'TestHttpShardHandlerFactory', 'testWhitelistHostCheckerCoreSpecific', 190, 195]

```java
  @Test
  public void testWhitelistHostCheckerSingleHost() {
    WhitelistHostChecker checker = new WhitelistHostChecker("http://abc-1.com:8983/solr", true);
    checker.checkWhitelist("http://abc-1.com:8983/solr", Arrays.asList(new String[]{"http://abc-1.com:8983/solr"}));
  }

  @Test
  public void testWhitelistHostCheckerMultipleHost() {
    WhitelistHostChecker checker = new WhitelistHostChecker("http://abc-1.com:8983, http://abc-2.com:8983, http://abc-3.com:8983", true);
    checker.checkWhitelist("http://abc-1.com:8983/solr", Arrays.asList(new String[]{"http://abc-1.com:8983/solr"}));
  }

  @Test
  public void testWhitelistHostCheckerNoProtocolInParameter() {
    WhitelistHostChecker checker = new WhitelistHostChecker("http://abc-1.com:8983, http://abc-2.com:8983, http://abc-3.com:8983", true);
    checker.checkWhitelist("abc-1.com:8983/solr", Arrays.asList(new String[]{"abc-1.com:8983/solr"}));
  }

  @Test
  public void testWhitelistHostCheckerNonWhitelistedHostHttps() {
    WhitelistHostChecker checker = new WhitelistHostChecker("http://abc-1.com:8983, http://abc-2.com:8983, http://abc-3.com:8983", true);
    checker.checkWhitelist("https://abc-1.com:8983/solr", Arrays.asList(new String[]{"https://abc-1.com:8983/solr"}));
  }

  @Test
  public void testWhitelistHostCheckerCoreSpecific() {
    // cores are removed completely so it doesn't really matter if they were set in config
    WhitelistHostChecker checker = new WhitelistHostChecker("http://abc-1.com:8983/solr/core1, http://abc-2.com:8983/solr2/core2", true);
    checker.checkWhitelist("http://abc-1.com:8983/solr/core2", Arrays.asList(new String[]{"http://abc-1.com:8983/solr/core2"}));
  }
```


### 8

<span style="color:red"> There could be more tests generated in atomic updates test, such as to remove double or boolean, or maybe test for update.</span>

[2295, 'src/test', 'org.apache.solr.update.processor', 'AtomicUpdatesTest', 'testRemove', 48, 113]

[2295, 'src/test', 'org.apache.solr.update.processor', 'AtomicUpdatesTest', 'testRemoveIntegerUsingStringType', 250, 312]

[2295, 'src/test', 'org.apache.solr.update.processor', 'AtomicUpdatesTest', 'testRemoveFloatUsingStringType', 768, 834]

```java
  @Test
  public void testRemove() throws Exception {
    SolrInputDocument doc;

    doc = new SolrInputDocument();
    doc.setField("id", "1");
    doc.setField("cat", new String[]{"aaa", "bbb", "ccc", "ccc", "ddd"});
    assertU(adoc(doc));

    doc = new SolrInputDocument();
    doc.setField("id", "2");
    doc.setField("cat", new String[]{"aaa", "bbb", "bbb", "ccc", "ddd"});
    assertU(adoc(doc));


    doc = new SolrInputDocument();
    doc.setField("id", "20");
    doc.setField("cat", new String[]{"aaa", "ccc", "ddd"});
    assertU(adoc(doc));

    doc = new SolrInputDocument();
    doc.setField("id", "21");
    doc.setField("cat", new String[]{"aaa", "bbb", "ddd"});
    assertU(adoc(doc));


    assertU(commit());

    assertQ(req("q", "cat:*", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "cat:bbb", "indent", "true"), "//result[@numFound = '3']");


    doc = new SolrInputDocument();
    doc.setField("id", "1");
    List<String> removeList = new ArrayList<String>();
    removeList.add("bbb");
    removeList.add("ccc");
    doc.setField("cat", ImmutableMap.of("remove", removeList)); //behavior when hitting Solr through ZK
    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "cat:*", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "cat:bbb", "indent", "true"), "//result[@numFound = '2']");

    doc = new SolrInputDocument();
    doc.setField("id", "21");
    removeList = new ArrayList<String>();
    removeList.add("bbb");
    removeList.add("ccc");
    doc.setField("cat", ImmutableMap.of("remove", removeList)); //behavior when hitting Solr through ZK
    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "cat:*", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "cat:bbb", "indent", "true"), "//result[@numFound = '1']");

    doc = new SolrInputDocument();
    doc.setField("id", "1");
    doc.setField("cat", ImmutableMap.of("remove", "aaa")); //behavior when hitting Solr directly

    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "cat:*", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "cat:aaa", "indent", "true"), "//result[@numFound = '3']");
  }

  @Test
  public void testRemoveIntegerUsingStringType() throws Exception {
    SolrInputDocument doc;

    doc = new SolrInputDocument();
    doc.setField("id", "1001");
    doc.setField("intRemove", new String[]{"111", "222", "333", "333", "444"});
    assertU(adoc(doc));

    doc = new SolrInputDocument();
    doc.setField("id", "1002");
    doc.setField("intRemove", new String[]{"111", "222", "222", "333", "444"});
    assertU(adoc(doc));

    doc = new SolrInputDocument();
    doc.setField("id", "1020");
    doc.setField("intRemove", new String[]{"111", "333", "444"});
    assertU(adoc(doc));

    doc = new SolrInputDocument();
    doc.setField("id", "1021");
    doc.setField("intRemove", new String[]{"111", "222", "444"});
    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "intRemove:[* TO *]", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "intRemove:222", "indent", "true"), "//result[@numFound = '3']");


    doc = new SolrInputDocument();
    doc.setField("id", "1001");
    List<String> removeList = new ArrayList<String>();
    removeList.add("222");
    removeList.add("333");
    doc.setField("intRemove", ImmutableMap.of("remove", removeList)); //behavior when hitting Solr through ZK
    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "intRemove:[* TO *]", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "intRemove:222", "indent", "true"), "//result[@numFound = '2']");

    doc = new SolrInputDocument();
    doc.setField("id", "1021");
    removeList = new ArrayList<String>();
    removeList.add("222");
    removeList.add("333");
    doc.setField("intRemove", ImmutableMap.of("remove", removeList)); //behavior when hitting Solr through ZK
    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "intRemove:[* TO *]", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "intRemove:222", "indent", "true"), "//result[@numFound = '1']");

    doc = new SolrInputDocument();
    doc.setField("id", "1001");
    doc.setField("intRemove", ImmutableMap.of("remove", "111")); //behavior when hitting Solr directly

    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "intRemove:[* TO *]", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "intRemove:111", "indent", "true"), "//result[@numFound = '3']");
  }

  @Test
  public void testRemoveFloatUsingStringType() throws Exception {
    SolrInputDocument doc;

    doc = new SolrInputDocument();
    doc.setField("id", "10001");
    doc.setField("floatRemove", new String[]{"111.111", "222.222", "333.333", "333.333", "444.444"});

    assertU(adoc(doc));

    doc = new SolrInputDocument();
    doc.setField("id", "10002");
    doc.setField("floatRemove", new String[]{"111.111", "222.222", "222.222", "333.333", "444.444"});
    assertU(adoc(doc));


    doc = new SolrInputDocument();
    doc.setField("id", "10020");
    doc.setField("floatRemove", new String[]{"111.111", "333.333", "444.444"});
    assertU(adoc(doc));

    doc = new SolrInputDocument();
    doc.setField("id", "10021");
    doc.setField("floatRemove", new String[]{"111.111", "222.222", "444.444"});
    assertU(adoc(doc));

    assertU(commit());

    assertQ(req("q", "floatRemove:[* TO *]", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "floatRemove:\"222.222\"", "indent", "true"), "//result[@numFound = '3']");


    doc = new SolrInputDocument();
    doc.setField("id", "10001");
    List<String> removeList = new ArrayList<String>();
    removeList.add("222.222");
    removeList.add("333.333");

    doc.setField("floatRemove", ImmutableMap.of("remove", removeList)); //behavior when hitting Solr through ZK
    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "floatRemove:[* TO *]", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "floatRemove:\"222.222\"", "indent", "true"), "//result[@numFound = '2']");

    doc = new SolrInputDocument();
    doc.setField("id", "10021");
    removeList = new ArrayList<String>();
    removeList.add("222.222");
    removeList.add("333.333");
    doc.setField("floatRemove", ImmutableMap.of("remove", removeList)); //behavior when hitting Solr through ZK
    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "floatRemove:[* TO *]", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "floatRemove:\"222.222\"", "indent", "true"), "//result[@numFound = '1']");

    doc = new SolrInputDocument();
    doc.setField("id", "10001");
    doc.setField("floatRemove", ImmutableMap.of("remove", "111.111")); //behavior when hitting Solr directly

    assertU(adoc(doc));
    assertU(commit());

    assertQ(req("q", "floatRemove:[* TO *]", "indent", "true"), "//result[@numFound = '4']");
    assertQ(req("q", "floatRemove:\"111.111\"", "indent", "true"), "//result[@numFound = '3']");
  }
```

### lucene_6.6.6

### 9

[456, 'src/test', 'org.apache.lucene.codecs.lucene54', 'TestLucene54DocValuesFormat', 'testSortedVariableLengthManyVsStoredFields', 113, 119]

[456, 'src/test', 'org.apache.lucene.codecs.lucene54', 'TestLucene54DocValuesFormat', 'testTermsEnumFixedWidth', 121, 127]

[456, 'src/test', 'org.apache.lucene.codecs.lucene54', 'TestLucene54DocValuesFormat', 'testTermsEnumVariableWidth', 129, 135]

[456, 'src/test', 'org.apache.lucene.codecs.lucene54', 'TestLucene54DocValuesFormat', 'testTermsEnumRandomMany', 137, 143]
```java
  @Nightly
  public void testSortedVariableLengthManyVsStoredFields() throws Exception {
    int numIterations = atLeast(1);
    for (int i = 0; i < numIterations; i++) {
      doTestSortedVsStoredFields(TestUtil.nextInt(random(), 1024, 2049), 1, 500);
    }
  }

  @Slow
  public void testTermsEnumFixedWidth() throws Exception {
    int numIterations = atLeast(1);
    for (int i = 0; i < numIterations; i++) {
      doTestTermsEnumRandom(TestUtil.nextInt(random(), 1025, 5121), 10, 10);
    }
  }

  @Slow
  public void testTermsEnumVariableWidth() throws Exception {
    int numIterations = atLeast(1);
    for (int i = 0; i < numIterations; i++) {
      doTestTermsEnumRandom(TestUtil.nextInt(random(), 1025, 5121), 1, 500);
    }
  }

  @Nightly
  public void testTermsEnumRandomMany() throws Exception {
    int numIterations = atLeast(1);
    for (int i = 0; i < numIterations; i++) {
      doTestTermsEnumRandom(TestUtil.nextInt(random(), 1025, 8121), 1, 500);
    }
  }
```

### joda_time_2.10

### 10

<span style="color:red">There are more options to test the date time format, especially for the leap year day for bug search.</span>

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_weekyear_month_week_2010', 452, 456]

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_weekyear_month_week_2011', 458, 462]

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_weekyear_month_week_2012', 464, 468]

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_year_month_week_2010', 478, 482]

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_year_month_week_2011', 484, 488]

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_year_month_week_2012', 490, 494]

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_year_month_week_2013', 496, 500]

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_year_month_week_2014', 502, 506]

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_year_month_week_2015', 508, 512]

[481, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatter', 'testParseLocalDate_year_month_week_2016', 514, 518]

```java
public void testParseLocalDate_weekyear_month_week_2010() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("xxxx-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2010, 1, 4, chrono), f.parseLocalDate("2010-01-01"));
}

public void testParseLocalDate_weekyear_month_week_2011() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("xxxx-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2011, 1, 3, chrono), f.parseLocalDate("2011-01-01"));
}

public void testParseLocalDate_weekyear_month_week_2012() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("xxxx-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2012, 1, 2, chrono), f.parseLocalDate("2012-01-01"));
}

public void testParseLocalDate_year_month_week_2010() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("yyyy-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2010, 1, 4, chrono), f.parseLocalDate("2010-01-01"));
}

public void testParseLocalDate_year_month_week_2011() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("yyyy-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2011, 1, 3, chrono), f.parseLocalDate("2011-01-01"));
}

public void testParseLocalDate_year_month_week_2012() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("yyyy-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2012, 1, 2, chrono), f.parseLocalDate("2012-01-01"));
}

public void testParseLocalDate_year_month_week_2013() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("yyyy-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2012, 12, 31, chrono), f.parseLocalDate("2013-01-01"));  // 2013-01-01 would be better, but this is OK
}

public void testParseLocalDate_year_month_week_2014() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("yyyy-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2013, 12, 30, chrono), f.parseLocalDate("2014-01-01"));  // 2014-01-01 would be better, but this is OK
}

public void testParseLocalDate_year_month_week_2015() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("yyyy-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2014, 12, 29, chrono), f.parseLocalDate("2015-01-01"));  // 2015-01-01 would be better, but this is OK
}

public void testParseLocalDate_year_month_week_2016() {
    Chronology chrono = GJChronology.getInstanceUTC();
    DateTimeFormatter f = DateTimeFormat.forPattern("yyyy-MM-ww").withChronology(chrono);
    assertEquals(new LocalDate(2016, 1, 4, chrono), f.parseLocalDate("2016-01-01"));
}
```

### jfreechart_1.0.10

### 11

<span style="color:red"> This group of clone instances specifically tests to make sure that no exceptions are thrown, if the chart is with a **null** info object (in the creation of buffered image). </span>

<span style="color:red"> From the test generation perspective, there could be more tests by filling the info object with some values other than null. The purpose of testing may be different, but it may be good for bug search. </span>

[122, 'tests', 'org.jfree.chart.renderer.xy.junit', 'StackedXYAreaRendererTests', 'testDrawWithNullInfo', 204, 235]

[122, 'tests', 'org.jfree.chart.renderer.xy.junit', 'XYAreaRenderer2Tests', 'testDrawWithNullInfo', 184, 215]

[122, 'tests', 'org.jfree.chart.renderer.xy.junit', 'XYAreaRendererTests', 'testDrawWithNullInfo', 212, 243]

[122, 'tests', 'org.jfree.chart.renderer.xy.junit', 'XYStepAreaRendererTests', 'testDrawWithNullInfo', 189, 220]

[122, 'tests', 'org.jfree.chart.renderer.xy.junit', 'XYStepRendererTests', 'testDrawWithNullInfo', 174, 205]

```java
public void testDrawWithNullInfo() {
    boolean success = false;
    try {
        DefaultTableXYDataset dataset = new DefaultTableXYDataset();

        XYSeries s1 = new XYSeries("Series 1", true, false);
        s1.add(5.0, 5.0);
        s1.add(10.0, 15.5);
        s1.add(15.0, 9.5);
        s1.add(20.0, 7.5);
        dataset.addSeries(s1);

        XYSeries s2 = new XYSeries("Series 2", true, false);
        s2.add(5.0, 5.0);
        s2.add(10.0, 15.5);
        s2.add(15.0, 9.5);
        s2.add(20.0, 3.5);
        dataset.addSeries(s2);
        XYPlot plot = new XYPlot(dataset,
                new NumberAxis("X"), new NumberAxis("Y"),
                new StackedXYAreaRenderer());
        JFreeChart chart = new JFreeChart(plot);
        /* BufferedImage image = */ chart.createBufferedImage(300, 200,
                null);
        success = true;
    }
    catch (NullPointerException e) {
        e.printStackTrace();
        success = false;
    }
    assertTrue(success);
}

public void testDrawWithNullInfo() {
    boolean success = false;
    try {
        DefaultTableXYDataset dataset = new DefaultTableXYDataset();

        XYSeries s1 = new XYSeries("Series 1", true, false);
        s1.add(5.0, 5.0);
        s1.add(10.0, 15.5);
        s1.add(15.0, 9.5);
        s1.add(20.0, 7.5);
        dataset.addSeries(s1);

        XYSeries s2 = new XYSeries("Series 2", true, false);
        s2.add(5.0, 5.0);
        s2.add(10.0, 15.5);
        s2.add(15.0, 9.5);
        s2.add(20.0, 3.5);
        dataset.addSeries(s2);
        XYPlot plot = new XYPlot(dataset,
                new NumberAxis("X"), new NumberAxis("Y"),
                new XYAreaRenderer2());
        JFreeChart chart = new JFreeChart(plot);
        /* BufferedImage image = */ chart.createBufferedImage(300, 200,
                null);
        success = true;
    }
    catch (NullPointerException e) {
        e.printStackTrace();
        success = false;
    }
    assertTrue(success);
}

public void testDrawWithNullInfo() {
    boolean success = false;
    try {
        DefaultTableXYDataset dataset = new DefaultTableXYDataset();

        XYSeries s1 = new XYSeries("Series 1", true, false);
        s1.add(5.0, 5.0);
        s1.add(10.0, 15.5);
        s1.add(15.0, 9.5);
        s1.add(20.0, 7.5);
        dataset.addSeries(s1);

        XYSeries s2 = new XYSeries("Series 2", true, false);
        s2.add(5.0, 5.0);
        s2.add(10.0, 15.5);
        s2.add(15.0, 9.5);
        s2.add(20.0, 3.5);
        dataset.addSeries(s2);
        XYPlot plot = new XYPlot(dataset,
                new NumberAxis("X"), new NumberAxis("Y"),
                new XYAreaRenderer());
        JFreeChart chart = new JFreeChart(plot);
        /* BufferedImage image = */ chart.createBufferedImage(300, 200,
                null);
        success = true;
    }
    catch (NullPointerException e) {
        e.printStackTrace();
        success = false;
    }
    assertTrue(success);
}

public void testDrawWithNullInfo() {
    boolean success = false;
    try {
        DefaultTableXYDataset dataset = new DefaultTableXYDataset();

        XYSeries s1 = new XYSeries("Series 1", true, false);
        s1.add(5.0, 5.0);
        s1.add(10.0, 15.5);
        s1.add(15.0, 9.5);
        s1.add(20.0, 7.5);
        dataset.addSeries(s1);

        XYSeries s2 = new XYSeries("Series 2", true, false);
        s2.add(5.0, 5.0);
        s2.add(10.0, 15.5);
        s2.add(15.0, 9.5);
        s2.add(20.0, 3.5);
        dataset.addSeries(s2);
        XYPlot plot = new XYPlot(dataset,
                new NumberAxis("X"), new NumberAxis("Y"),
                new XYStepAreaRenderer());
        JFreeChart chart = new JFreeChart(plot);
        /* BufferedImage image = */ chart.createBufferedImage(300, 200,
                null);
        success = true;
    }
    catch (NullPointerException e) {
        e.printStackTrace();
        success = false;
    }
    assertTrue(success);
}

public void testDrawWithNullInfo() {
    boolean success = false;
    try {
        DefaultTableXYDataset dataset = new DefaultTableXYDataset();

        XYSeries s1 = new XYSeries("Series 1", true, false);
        s1.add(5.0, 5.0);
        s1.add(10.0, 15.5);
        s1.add(15.0, 9.5);
        s1.add(20.0, 7.5);
        dataset.addSeries(s1);

        XYSeries s2 = new XYSeries("Series 2", true, false);
        s2.add(5.0, 5.0);
        s2.add(10.0, 15.5);
        s2.add(15.0, 9.5);
        s2.add(20.0, 3.5);
        dataset.addSeries(s2);
        XYPlot plot = new XYPlot(dataset,
                new NumberAxis("X"), new NumberAxis("Y"),
                new XYStepRenderer());
        JFreeChart chart = new JFreeChart(plot);
        /* BufferedImage image = */ chart.createBufferedImage(300, 200,
                null);
        success = true;
    }
    catch (NullPointerException e) {
        e.printStackTrace();
        success = false;
    }
    assertTrue(success);
}
```

### 12

<span style="color:red"> There are many clone groups reported with the same method name of "testCloning", with "similarity" of 1.0, and there are many similar instances left out of the groups. There are many possibilities in tests generation for this family of clone groups. </span>


[8, 'tests', 'org.jfree.chart.axis.junit', 'CategoryAxis3DTests', 'testCloning', 82, 94]

[8, 'tests', 'org.jfree.chart.axis.junit', 'CategoryAxisTests', 'testCloning', 173, 185]

[8, 'tests', 'org.jfree.chart.axis.junit', 'ColorBarTests', 'testCloning', 116, 128]

[8, 'tests', 'org.jfree.chart.axis.junit', 'SubCategoryAxisTests', 'testCloning', 127, 139]

```java
public void testCloning() {
    CategoryAxis3D a1 = new CategoryAxis3D("Test");
    CategoryAxis3D a2 = null;
    try {
        a2 = (CategoryAxis3D) a1.clone();
    }
    catch (CloneNotSupportedException e) {
        System.err.println("Failed to clone.");
    }
    assertTrue(a1 != a2);
    assertTrue(a1.getClass() == a2.getClass());
    assertTrue(a1.equals(a2));
}

public void testCloning() {
    CategoryAxis a1 = new CategoryAxis("Test");
    CategoryAxis a2 = null;
    try {
        a2 = (CategoryAxis) a1.clone();
    }
    catch (CloneNotSupportedException e) {
        System.err.println("Failed to clone.");
    }
    assertTrue(a1 != a2);
    assertTrue(a1.getClass() == a2.getClass());
    assertTrue(a1.equals(a2));
}

public void testCloning() {
    ColorBar c1 = new ColorBar("Test");
    ColorBar c2 = null;
    try {
        c2 = (ColorBar) c1.clone();
    }
    catch (CloneNotSupportedException e) {
        System.err.println("Failed to clone.");
    }
    assertTrue(c1 != c2);
    assertTrue(c1.getClass() == c2.getClass());
    assertTrue(c1.equals(c2));
}

public void testCloning() {
    SubCategoryAxis a1 = new SubCategoryAxis("Test");
    SubCategoryAxis a2 = null;
    try {
        a2 = (SubCategoryAxis) a1.clone();
    }
    catch (CloneNotSupportedException e) {
        System.err.println("Failed to clone.");
    }
    assertTrue(a1 != a2);
    assertTrue(a1.getClass() == a2.getClass());
    assertTrue(a1.equals(a2));
} 
```

[457, 'tests', 'org.jfree.data.xy.junit', 'VectorSeriesTests', 'testCloning', 141, 154]

[457, 'tests', 'org.jfree.data.xy.junit', 'XIntervalSeriesTests', 'testCloning', 140, 153]

[457, 'tests', 'org.jfree.data.xy.junit', 'YIntervalSeriesTests', 'testCloning', 139, 152]

```java
public void testCloning() {
    VectorSeries s1 = new VectorSeries("s1");
    s1.add(1.0, 0.5, 1.5, 2.0);
    VectorSeries s2 = null;
    try {
        s2 = (VectorSeries) s1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(s1 != s2);
    assertTrue(s1.getClass() == s2.getClass());
    assertTrue(s1.equals(s2));
}

public void testCloning() {
    XIntervalSeries s1 = new XIntervalSeries("s1");
    s1.add(1.0, 0.5, 1.5, 2.0);
    XIntervalSeries s2 = null;
    try {
        s2 = (XIntervalSeries) s1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(s1 != s2);
    assertTrue(s1.getClass() == s2.getClass());
    assertTrue(s1.equals(s2));
}

public void testCloning() {
    YIntervalSeries s1 = new YIntervalSeries("s1");
    s1.add(1.0, 0.5, 1.5, 2.0);
    YIntervalSeries s2 = null;
    try {
        s2 = (YIntervalSeries) s1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(s1 != s2);
    assertTrue(s1.getClass() == s2.getClass());
    assertTrue(s1.equals(s2));
}
```


[511, 'tests', 'org.jfree.chart.renderer.category.junit', 'LineAndShapeRendererTests', 'testCloning', 175, 190]

[511, 'tests', 'org.jfree.chart.renderer.category.junit', 'LineRenderer3DTests', 'testCloning', 124, 139]

[511, 'tests', 'org.jfree.chart.renderer.category.junit', 'ScatterRendererTests', 'testCloning', 138, 152]

```java
public void testCloning() {
    LineAndShapeRenderer r1 = new LineAndShapeRenderer();
    LineAndShapeRenderer r2 = null;
    try {
        r2 = (LineAndShapeRenderer) r1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(r1 != r2);
    assertTrue(r1.getClass() == r2.getClass());
    assertTrue(r1.equals(r2));

    assertTrue(checkIndependence(r1, r2));

}

public void testCloning() {
    LineRenderer3D r1 = new LineRenderer3D();
    LineRenderer3D r2 = null;
    try {
        r2 = (LineRenderer3D) r1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(r1 != r2);
    assertTrue(r1.getClass() == r2.getClass());
    assertTrue(r1.equals(r2));

    assertTrue(checkIndependence(r1, r2));

}

public void testCloning() {
    ScatterRenderer r1 = new ScatterRenderer();
    ScatterRenderer r2 = null;
    try {
        r2 = (ScatterRenderer) r1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(r1 != r2);
    assertTrue(r1.getClass() == r2.getClass());
    assertTrue(r1.equals(r2));

    assertTrue(checkIndependence(r1, r2));
}
```

[574, 'tests', 'org.jfree.data.xy.junit', 'VectorSeriesCollectionTests', 'testCloning', 108, 127]

[574, 'tests', 'org.jfree.data.xy.junit', 'XIntervalSeriesCollectionTests', 'testCloning', 111, 130]

[574, 'tests', 'org.jfree.data.xy.junit', 'YIntervalSeriesCollectionTests', 'testCloning', 111, 130]

```java
public void testCloning() {
    VectorSeries s1 = new VectorSeries("Series");
    s1.add(1.0, 1.1, 1.2, 1.3);
    VectorSeriesCollection c1 = new VectorSeriesCollection();
    c1.addSeries(s1);
    VectorSeriesCollection c2 = null;
    try {
        c2 = (VectorSeriesCollection) c1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(c1 != c2);
    assertTrue(c1.getClass() == c2.getClass());
    assertTrue(c1.equals(c2));

    // check independence
    s1.setDescription("XYZ");
    assertFalse(c1.equals(c2));
}

public void testCloning() {
    XIntervalSeriesCollection c1 = new XIntervalSeriesCollection();
    XIntervalSeries s1 = new XIntervalSeries("Series");
    s1.add(1.0, 1.1, 1.2, 1.3);
    c1.addSeries(s1);
    XIntervalSeriesCollection c2 = null;
    try {
        c2 = (XIntervalSeriesCollection) c1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(c1 != c2);
    assertTrue(c1.getClass() == c2.getClass());
    assertTrue(c1.equals(c2));

    // check independence
    s1.setDescription("XYZ");
    assertFalse(c1.equals(c2));
}

public void testCloning() {
    YIntervalSeriesCollection c1 = new YIntervalSeriesCollection();
    YIntervalSeries s1 = new YIntervalSeries("Series");
    s1.add(1.0, 1.1, 1.2, 1.3);
    c1.addSeries(s1);
    YIntervalSeriesCollection c2 = null;
    try {
        c2 = (YIntervalSeriesCollection) c1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(c1 != c2);
    assertTrue(c1.getClass() == c2.getClass());
    assertTrue(c1.equals(c2));

    // check independence
    s1.setDescription("XYZ");
    assertFalse(c1.equals(c2));
}
```


[587, 'tests', 'org.jfree.chart.plot.dial.junit', 'AbstractDialLayerTests', 'testCloning', 98, 117]

[587, 'tests', 'org.jfree.chart.plot.dial.junit', 'ArcDialFrameTests', 'testCloning', 159, 177]

[587, 'tests', 'org.jfree.chart.plot.dial.junit', 'StandardDialFrameTests', 'testCloning', 141, 159]

[587, 'tests', 'org.jfree.chart.plot.dial.junit', 'StandardDialRangeTests', 'testCloning', 131, 149]

```java
public void testCloning() {
    // test a default instance
    DialCap c1 = new DialCap();
    DialCap c2 = null;
    try {
        c2 = (DialCap) c1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(c1 != c2);
    assertTrue(c1.getClass() == c2.getClass());
    assertTrue(c1.equals(c2));

    // check that the listener lists are independent
    MyDialLayerChangeListener l1 = new MyDialLayerChangeListener();
    c1.addChangeListener(l1);
    assertTrue(c1.hasListener(l1));
    assertFalse(c2.hasListener(l1));
}

public void testCloning() {
    ArcDialFrame f1 = new ArcDialFrame();
    ArcDialFrame f2 = null;
    try {
        f2 = (ArcDialFrame) f1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(f1 != f2);
    assertTrue(f1.getClass() == f2.getClass());
    assertTrue(f1.equals(f2));

    // check that the listener lists are independent
    MyDialLayerChangeListener l1 = new MyDialLayerChangeListener();
    f1.addChangeListener(l1);
    assertTrue(f1.hasListener(l1));
    assertFalse(f2.hasListener(l1));
}

public void testCloning() {
    StandardDialFrame f1 = new StandardDialFrame();
    StandardDialFrame f2 = null;
    try {
        f2 = (StandardDialFrame) f1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(f1 != f2);
    assertTrue(f1.getClass() == f2.getClass());
    assertTrue(f1.equals(f2));

    // check that the listener lists are independent
    MyDialLayerChangeListener l1 = new MyDialLayerChangeListener();
    f1.addChangeListener(l1);
    assertTrue(f1.hasListener(l1));
    assertFalse(f2.hasListener(l1));
}

public void testCloning() {
    StandardDialRange r1 = new StandardDialRange();
    StandardDialRange r2 = null;
    try {
        r2 = (StandardDialRange) r1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(r1 != r2);
    assertTrue(r1.getClass() == r2.getClass());
    assertTrue(r1.equals(r2));

    // check that the listener lists are independent
    MyDialLayerChangeListener l1 = new MyDialLayerChangeListener();
    r1.addChangeListener(l1);
    assertTrue(r1.hasListener(l1));
    assertFalse(r2.hasListener(l1));
}
```

[845, 'tests', 'org.jfree.data.xy.junit', 'VectorDataItemTests', 'testCloning', 125, 137]

[845, 'tests', 'org.jfree.data.xy.junit', 'XIntervalDataItemTests', 'testCloning', 130, 142]

[845, 'tests', 'org.jfree.data.xy.junit', 'YIntervalDataItemTests', 'testCloning', 129, 141]

```java
public void testCloning() {
    VectorDataItem v1 = new VectorDataItem(1.0, 2.0, 3.0, 4.0);
    VectorDataItem v2 = null;
    try {
        v2 = (VectorDataItem) v1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(v1 != v2);
    assertTrue(v1.getClass() == v2.getClass());
    assertTrue(v1.equals(v2));
}

public void testCloning() {
    XIntervalDataItem item1 = new XIntervalDataItem(1.0, 2.0, 3.0, 4.0);
    XIntervalDataItem item2 = null;
    try {
        item2 = (XIntervalDataItem) item1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(item1 != item2);
    assertTrue(item1.getClass() == item2.getClass());
    assertTrue(item1.equals(item2));
}

public void testCloning() {
    YIntervalDataItem item1 = new YIntervalDataItem(1.0, 2.0, 1.5, 2.5);
    YIntervalDataItem item2 = null;
    try {
        item2 = (YIntervalDataItem) item1.clone();
    }
    catch (CloneNotSupportedException e) {
        e.printStackTrace();
    }
    assertTrue(item1 != item2);
    assertTrue(item1.getClass() == item2.getClass());
    assertTrue(item1.equals(item2));
}
```

### jmeter_5.1.1

### 13

<span style="color:red"> There are more ways to varying the linked list of *CompoundVariable* other than the differences in "template", and thus possible to generate more similar tests for this group for bug search. </span>

[302, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtractionFromVariable', 116, 134]

[302, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtractionFromVariable2', 136, 154]

[302, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtractionFromVariable3', 156, 174]

[302, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtractionFromVariable4', 176, 194]

[302, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtractionFromVariable5', 196, 214]

[302, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtractionFromVariable6', 216, 234]

[302, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtractionFromVariable7', 236, 254]

[302, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtractionFromVariable8', 256, 274]

[302, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtractionFromVariable9', 276, 294]

```java
    @Test
    public void testVariableExtractionFromVariable() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("(\\d+)\\s+(\\w+)"));
        params.add(new CompoundVariable("$2$")); // template
        params.add(new CompoundVariable("1")); // match number
        params.add(new CompoundVariable("-")); // ALL separator
        params.add(new CompoundVariable("default"));
        params.add(new CompoundVariable("OUTVAR"));
        params.add(new CompoundVariable(INPUT_VARIABLE_NAME));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1", vars.getObject("OUTVAR_matchNr"));
        assertEquals("times", match);
        assertEquals("times", vars.getObject("OUTVAR"));
        assertEquals("123 times", vars.getObject("OUTVAR_g0"));
        assertEquals("123", vars.getObject("OUTVAR_g1"));
        assertEquals("times", vars.getObject("OUTVAR_g2"));
    }

    @Test
    public void testVariableExtractionFromVariable2() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("(\\d+)\\s+(\\w+)"));
        params.add(new CompoundVariable("$1$$2$")); // template
        params.add(new CompoundVariable("1")); // match number
        params.add(new CompoundVariable("-")); // ALL separator
        params.add(new CompoundVariable("default"));
        params.add(new CompoundVariable("OUTVAR"));
        params.add(new CompoundVariable(INPUT_VARIABLE_NAME));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1", vars.getObject("OUTVAR_matchNr"));
        assertEquals("123times", match);
        assertEquals("123times", vars.getObject("OUTVAR"));
        assertEquals("123 times", vars.getObject("OUTVAR_g0"));
        assertEquals("123", vars.getObject("OUTVAR_g1"));
        assertEquals("times", vars.getObject("OUTVAR_g2"));
    }

    @Test
    public void testVariableExtractionFromVariable3() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("(\\d+)\\s+(\\w+)"));
        params.add(new CompoundVariable("pre$2$post")); // template
        params.add(new CompoundVariable("1")); // match number
        params.add(new CompoundVariable("-")); // ALL separator
        params.add(new CompoundVariable("default"));
        params.add(new CompoundVariable("OUTVAR"));
        params.add(new CompoundVariable(INPUT_VARIABLE_NAME));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1", vars.getObject("OUTVAR_matchNr"));
        assertEquals("pretimespost", match);
        assertEquals("pretimespost", vars.getObject("OUTVAR"));
        assertEquals("123 times", vars.getObject("OUTVAR_g0"));
        assertEquals("123", vars.getObject("OUTVAR_g1"));
        assertEquals("times", vars.getObject("OUTVAR_g2"));
    }

    @Test
    public void testVariableExtractionFromVariable4() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("(\\d+)\\s+(\\w+)"));
        params.add(new CompoundVariable("pre$2$")); // template
        params.add(new CompoundVariable("1")); // match number
        params.add(new CompoundVariable("-")); // ALL separator
        params.add(new CompoundVariable("default"));
        params.add(new CompoundVariable("OUTVAR"));
        params.add(new CompoundVariable(INPUT_VARIABLE_NAME));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1", vars.getObject("OUTVAR_matchNr"));
        assertEquals("pretimes", match);
        assertEquals("pretimes", vars.getObject("OUTVAR"));
        assertEquals("123 times", vars.getObject("OUTVAR_g0"));
        assertEquals("123", vars.getObject("OUTVAR_g1"));
        assertEquals("times", vars.getObject("OUTVAR_g2"));
    }

    @Test
    public void testVariableExtractionFromVariable5() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("(\\d+)\\s+(\\w+)"));
        params.add(new CompoundVariable("$2$post")); // template
        params.add(new CompoundVariable("1")); // match number
        params.add(new CompoundVariable("-")); // ALL separator
        params.add(new CompoundVariable("default"));
        params.add(new CompoundVariable("OUTVAR"));
        params.add(new CompoundVariable(INPUT_VARIABLE_NAME));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1", vars.getObject("OUTVAR_matchNr"));
        assertEquals("timespost", match);
        assertEquals("timespost", vars.getObject("OUTVAR"));
        assertEquals("123 times", vars.getObject("OUTVAR_g0"));
        assertEquals("123", vars.getObject("OUTVAR_g1"));
        assertEquals("times", vars.getObject("OUTVAR_g2"));
    }

    @Test
    public void testVariableExtractionFromVariable6() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("(\\d+)\\s+(\\w+)"));
        params.add(new CompoundVariable("$2$$2$")); // template
        params.add(new CompoundVariable("1")); // match number
        params.add(new CompoundVariable("-")); // ALL separator
        params.add(new CompoundVariable("default"));
        params.add(new CompoundVariable("OUTVAR"));
        params.add(new CompoundVariable(INPUT_VARIABLE_NAME));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1", vars.getObject("OUTVAR_matchNr"));
        assertEquals("timestimes", match);
        assertEquals("timestimes", vars.getObject("OUTVAR"));
        assertEquals("123 times", vars.getObject("OUTVAR_g0"));
        assertEquals("123", vars.getObject("OUTVAR_g1"));
        assertEquals("times", vars.getObject("OUTVAR_g2"));
    }

    @Test
    public void testVariableExtractionFromVariable7() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("(\\d+)\\s+(\\w+)"));
        params.add(new CompoundVariable("pre$1$mid$2$post")); // template
        params.add(new CompoundVariable("1")); // match number
        params.add(new CompoundVariable("-")); // ALL separator
        params.add(new CompoundVariable("default"));
        params.add(new CompoundVariable("OUTVAR"));
        params.add(new CompoundVariable(INPUT_VARIABLE_NAME));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1", vars.getObject("OUTVAR_matchNr"));
        assertEquals("pre123midtimespost", match);
        assertEquals("pre123midtimespost", vars.getObject("OUTVAR"));
        assertEquals("123 times", vars.getObject("OUTVAR_g0"));
        assertEquals("123", vars.getObject("OUTVAR_g1"));
        assertEquals("times", vars.getObject("OUTVAR_g2"));
    }

    @Test
    public void testVariableExtractionFromVariable8() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("(\\d+)\\s+(\\w+)"));
        params.add(new CompoundVariable("pre$1$mid$2$")); // template
        params.add(new CompoundVariable("1")); // match number
        params.add(new CompoundVariable("-")); // ALL separator
        params.add(new CompoundVariable("default"));
        params.add(new CompoundVariable("OUTVAR"));
        params.add(new CompoundVariable(INPUT_VARIABLE_NAME));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1", vars.getObject("OUTVAR_matchNr"));
        assertEquals("pre123midtimes", match);
        assertEquals("pre123midtimes", vars.getObject("OUTVAR"));
        assertEquals("123 times", vars.getObject("OUTVAR_g0"));
        assertEquals("123", vars.getObject("OUTVAR_g1"));
        assertEquals("times", vars.getObject("OUTVAR_g2"));
    }

    @Test
    public void testVariableExtractionFromVariable9() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("(\\d+)\\s+(\\w+)"));
        params.add(new CompoundVariable("$1$mid$2$post")); // template
        params.add(new CompoundVariable("1")); // match number
        params.add(new CompoundVariable("-")); // ALL separator
        params.add(new CompoundVariable("default"));
        params.add(new CompoundVariable("OUTVAR"));
        params.add(new CompoundVariable(INPUT_VARIABLE_NAME));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1", vars.getObject("OUTVAR_matchNr"));
        assertEquals("123midtimespost", match);
        assertEquals("123midtimespost", vars.getObject("OUTVAR"));
        assertEquals("123 times", vars.getObject("OUTVAR_g0"));
        assertEquals("123", vars.getObject("OUTVAR_g1"));
        assertEquals("times", vars.getObject("OUTVAR_g2"));
    }
```

<span style="color:red"> similar idea as in the previous clone group. </span>

[682, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtraction', 69, 78]

[682, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtraction2', 296, 305]

[682, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testComma', 332, 341]

[682, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtraction3', 343, 352]

[682, 'test/src', 'org.apache.jmeter.functions', 'TestRegexFunction', 'testVariableExtraction4', 400, 409]

```java
    @Test
    public void testVariableExtraction() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("<value field=\"(pinposition\\d+)\">(\\d+)</value>"));
        params.add(new CompoundVariable("$2$"));
        params.add(new CompoundVariable("2"));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("5", match);
    }

    @Test
    public void testVariableExtraction2() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("<value field=\"(pinposition\\d+)\">(\\d+)</value>"));
        params.add(new CompoundVariable("$1$"));
        params.add(new CompoundVariable("3"));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("pinposition3", match);
    }

    @Test
    public void testComma() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("<value,? field=\"(pinposition\\d+)\">(\\d+)</value>"));
        params.add(new CompoundVariable("$1$"));
        params.add(new CompoundVariable("3"));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("pinposition3", match);
    }

    @Test
    public void testVariableExtraction3() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("<value field=\"(pinposition\\d+)\">(\\d+)</value>"));
        params.add(new CompoundVariable("_$1$"));
        params.add(new CompoundVariable("2"));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("_pinposition2", match);
    }

    @Test
    public void testVariableExtraction4() throws Exception {
        params = new LinkedList<>();
        params.add(new CompoundVariable("<value field=\"(pinposition\\d+)\">(\\d+)</value>"));
        params.add(new CompoundVariable("$2$, "));
        params.add(new CompoundVariable(".333"));
        variable.setParameters(params);
        String match = variable.execute(result, null);
        assertEquals("1, ", match);
    }
``` 

### gson_2.8.5

### 14

<span style="color:red"> There could be more variations to the String *target* to generate more tests </span>

[95, 'src/test/java', 'com.google.gson.functional', 'NamingPolicyTest', 'testGsonWithNonDefaultFieldNamingPolicyDeserialiation', 52, 57]

[95, 'src/test/java', 'com.google.gson.functional', 'NamingPolicyTest', 'testGsonWithLowerCaseDotPolicyDeserialiation', 73, 78]

[95, 'src/test/java', 'com.google.gson.functional', 'NamingPolicyTest', 'testGsonWithLowerCaseDashPolicyDeserialiation', 80, 85]

[95, 'src/test/java', 'com.google.gson.functional', 'NamingPolicyTest', 'testGsonWithLowerCaseUnderscorePolicyDeserialiation', 95, 101]

[95, 'src/test/java', 'com.google.gson.functional', 'NamingPolicyTest', 'testGsonWithUpperCamelCaseSpacesPolicyDeserialiation', 136, 142]

```java
  public void testGsonWithNonDefaultFieldNamingPolicyDeserialiation() {
    Gson gson = builder.setFieldNamingPolicy(FieldNamingPolicy.UPPER_CAMEL_CASE).create();
    String target = "{\"SomeConstantStringInstanceField\":\"someValue\"}";
    StringWrapper deserializedObject = gson.fromJson(target, StringWrapper.class);
    assertEquals("someValue", deserializedObject.someConstantStringInstanceField);
  }

  public void testGsonWithLowerCaseDotPolicyDeserialiation() {
    Gson gson = builder.setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_DOTS).create();
    String target = "{\"some.constant.string.instance.field\":\"someValue\"}";
    StringWrapper deserializedObject = gson.fromJson(target, StringWrapper.class);
    assertEquals("someValue", deserializedObject.someConstantStringInstanceField);
  }

  public void testGsonWithLowerCaseDashPolicyDeserialiation() {
    Gson gson = builder.setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_DASHES).create();
    String target = "{\"some-constant-string-instance-field\":\"someValue\"}";
    StringWrapper deserializedObject = gson.fromJson(target, StringWrapper.class);
    assertEquals("someValue", deserializedObject.someConstantStringInstanceField);
  }

  public void testGsonWithLowerCaseUnderscorePolicyDeserialiation() {
    Gson gson = builder.setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_UNDERSCORES)
        .create();
    String target = "{\"some_constant_string_instance_field\":\"someValue\"}";
    StringWrapper deserializedObject = gson.fromJson(target, StringWrapper.class);
    assertEquals("someValue", deserializedObject.someConstantStringInstanceField);
  }

  public void testGsonWithUpperCamelCaseSpacesPolicyDeserialiation() {
    Gson gson = builder.setFieldNamingPolicy(FieldNamingPolicy.UPPER_CAMEL_CASE_WITH_SPACES)
        .create();
    String target = "{\"Some Constant String Instance Field\":\"someValue\"}";
    StringWrapper deserializedObject = gson.fromJson(target, StringWrapper.class);
    assertEquals("someValue", deserializedObject.someConstantStringInstanceField);
  }
```

### 15

<span style="color:red"> It is possible to bring in more field naming policy to generate more test cases </span>

[326, 'src/test/java', 'com.google.gson.functional', 'FieldNamingTest', 'testIdentity', 32, 38]

[326, 'src/test/java', 'com.google.gson.functional', 'FieldNamingTest', 'testUpperCamelCase', 40, 46]

[326, 'src/test/java', 'com.google.gson.functional', 'FieldNamingTest', 'testUpperCamelCaseWithSpaces', 48, 54]

[326, 'src/test/java', 'com.google.gson.functional', 'FieldNamingTest', 'testLowerCaseWithUnderscores', 56, 62]

[326, 'src/test/java', 'com.google.gson.functional', 'FieldNamingTest', 'testLowerCaseWithDashes', 64, 70]

```java
  public void testIdentity() {
    Gson gson = getGsonWithNamingPolicy(IDENTITY);
    assertEquals("{'lowerCamel':1,'UpperCamel':2,'_lowerCamelLeadingUnderscore':3," +
        "'_UpperCamelLeadingUnderscore':4,'lower_words':5,'UPPER_WORDS':6," +
        "'annotatedName':7,'lowerId':8}",
        gson.toJson(new TestNames()).replace('\"', '\''));
  }

  public void testUpperCamelCase() {
    Gson gson = getGsonWithNamingPolicy(UPPER_CAMEL_CASE);
    assertEquals("{'LowerCamel':1,'UpperCamel':2,'_LowerCamelLeadingUnderscore':3," +
        "'_UpperCamelLeadingUnderscore':4,'Lower_words':5,'UPPER_WORDS':6," +
        "'annotatedName':7,'LowerId':8}",
        gson.toJson(new TestNames()).replace('\"', '\''));
  }

  public void testUpperCamelCaseWithSpaces() {
    Gson gson = getGsonWithNamingPolicy(UPPER_CAMEL_CASE_WITH_SPACES);
    assertEquals("{'Lower Camel':1,'Upper Camel':2,'_Lower Camel Leading Underscore':3," +
        "'_ Upper Camel Leading Underscore':4,'Lower_words':5,'U P P E R_ W O R D S':6," +
        "'annotatedName':7,'Lower Id':8}",
        gson.toJson(new TestNames()).replace('\"', '\''));
  }

  public void testLowerCaseWithUnderscores() {
    Gson gson = getGsonWithNamingPolicy(LOWER_CASE_WITH_UNDERSCORES);
    assertEquals("{'lower_camel':1,'upper_camel':2,'_lower_camel_leading_underscore':3," +
        "'__upper_camel_leading_underscore':4,'lower_words':5,'u_p_p_e_r__w_o_r_d_s':6," +
        "'annotatedName':7,'lower_id':8}",
        gson.toJson(new TestNames()).replace('\"', '\''));
  }

  public void testLowerCaseWithDashes() {
    Gson gson = getGsonWithNamingPolicy(LOWER_CASE_WITH_DASHES);
    assertEquals("{'lower-camel':1,'upper-camel':2,'_lower-camel-leading-underscore':3," +
        "'_-upper-camel-leading-underscore':4,'lower_words':5,'u-p-p-e-r_-w-o-r-d-s':6," +
        "'annotatedName':7,'lower-id':8}",
        gson.toJson(new TestNames()).replace('\"', '\''));
  }
```

### zookeeper_3.5.4

### 16

<span style="color:red"> This is already a parameterized clone group. Random inputs testing may help finding bugs. </span>

[657, 'src/java/test', 'org.apache.zookeeper.test', 'FLETest', 'testSingleElection', 264, 271]

[657, 'src/java/test', 'org.apache.zookeeper.test', 'FLETest', 'testDoubleElection', 274, 281]

[657, 'src/java/test', 'org.apache.zookeeper.test', 'FLETest', 'testTripleElection', 283, 290]

```java
@Test
public void testSingleElection() throws Exception {
    try{
        runElection(1);
    } catch (Exception e) {
        Assert.fail(e.toString());
    }
}

@Test
public void testDoubleElection() throws Exception {
    try{
        runElection(2);
    } catch (Exception e) {
        Assert.fail(e.toString());
    }
}

@Test
public void testTripleElection() throws Exception {
    try{
        runElection(3);
    } catch (Exception e) {
        Assert.fail(e.toString());
    }
}

    /**
     * Test leader election for a number of rounds. In all rounds but the last one
     * we kill the leader.
     * 
     * @param rounds
     * @throws Exception
     */
    private void runElection(int rounds) throws Exception {
        ConcurrentHashMap<Long, HashSet<Integer> > quora = 
            new ConcurrentHashMap<Long, HashSet<Integer> >();

        LOG.info("TestLE: " + getTestName()+ ", " + count);

        /*
         * Creates list of peers.
         */
        for(int i = 0; i < count; i++) {
            port[i] = PortAssignment.unique();
            peers.put(Long.valueOf(i),
                new QuorumServer(i,
                    new InetSocketAddress(
                        "127.0.0.1", PortAssignment.unique()),
                    new InetSocketAddress(
                        "127.0.0.1", PortAssignment.unique()),
                    new InetSocketAddress(
                        "127.0.0.1", port[i])));
            tmpdir[i] = ClientBase.createTmpDir();           
        }

        /*
         * Start one LEThread for each peer we want to run.
         */
        for(int i = 0; i < count; i++) {
            QuorumPeer peer = new QuorumPeer(peers, tmpdir[i], tmpdir[i],
                    port[i], 3, i, 1000, 2, 2);
            peer.startLeaderElection();
            LEThread thread = new LEThread(this, peer, i, rounds, quora);
            thread.start();
            threads.add(thread);
        }
        LOG.info("Started threads " + getTestName());

        int waitCounter = 0;
        synchronized(this){
            while(((successCount <= count/2) || (leader == -1))
                && (waitCounter < MAX_LOOP_COUNTER))
            {
                this.wait(200);
                waitCounter++;
            }
        }
        LOG.info("Success count: " + successCount);

        /*
        * Lists what threads haven't joined. A thread doesn't join if
        * it hasn't decided upon a leader yet. It can happen that a
        * peer is slow or disconnected, and it can take longer to
        * nominate and connect to the current leader.
        */
       for (int i = 0; i < threads.size(); i++) {
            if (threads.get(i).isAlive()) {
                LOG.info("Threads didn't join: " + i);
            }
        }

       /*
        * If we have a majority, then we are good to go.
        */
       if(successCount <= count/2){
           Assert.fail("Fewer than a a majority has joined");
       }

       /*
        * I'm done so joining.
        */
       if(!joinedThreads.contains(leader)){
           Assert.fail("Leader hasn't joined: " + leader);
       }
    }
```

### 17

<span style="color:red"> More random padding sizes may be introduced for bug search. </span>

[449, 'src/java/test', 'org.apache.zookeeper.server.persistence', 'FileTxnLogTest', 'testCalculateFileSizeWithPaddingWhenNotToCurrentSize', 50, 54]

[449, 'src/java/test', 'org.apache.zookeeper.server.persistence', 'FileTxnLogTest', 'testCalculateFileSizeWithPaddingWhenCloseToCurrentSize', 56, 60]

[449, 'src/java/test', 'org.apache.zookeeper.server.persistence', 'FileTxnLogTest', 'testFileSizeGreaterThanPosition', 62, 66]

```java
  @Test
  public void testCalculateFileSizeWithPaddingWhenNotToCurrentSize() {
    Assert.assertEquals("file should not be padded",
      10 * KB, FilePadding.calculateFileSizeWithPadding(5 * KB, 10 * KB, 10 * KB));
  }

  @Test
  public void testCalculateFileSizeWithPaddingWhenCloseToCurrentSize() {
    Assert.assertEquals("file should be padded an additional 10 KB",
      20 * KB, FilePadding.calculateFileSizeWithPadding(7 * KB, 10 * KB, 10 * KB));
  }

  @Test
  public void testFileSizeGreaterThanPosition() {
    Assert.assertEquals("file should be padded to 40 KB",
      40 * KB, FilePadding.calculateFileSizeWithPadding(31 * KB, 10 * KB, 10 * KB));
  }
``` 

### commons_collections_4.3

### 18

<span style="color:red"> Random inputs could be generated for keyset, keys or values for bug search. </span>

[1069, 'src/test/java', 'org.apache.commons.collections4.multimap', 'UnmodifiableMultiValuedMapTest', 'testUnmodifiableKeySet', 145, 173]

[1069, 'src/test/java', 'org.apache.commons.collections4.multimap', 'UnmodifiableMultiValuedMapTest', 'testUnmodifiableValues', 175, 203]

[1069, 'src/test/java', 'org.apache.commons.collections4.multimap', 'UnmodifiableMultiValuedMapTest', 'testUnmodifiableKeys', 234, 262]

```java

@SuppressWarnings("unchecked")
public void testUnmodifiableKeySet() {
    resetFull();
    final Set<K> keySet = getMap().keySet();
    try {
        keySet.add((K) "four");
        fail();
    } catch (final UnsupportedOperationException e) {
    }

    try {
        keySet.remove("four");
        fail();
    } catch (final UnsupportedOperationException e) {
    }

    try {
        keySet.clear();
        fail();
    } catch (final UnsupportedOperationException e) {
    }

    final Iterator<K> it = keySet.iterator();
    try {
        it.remove();
        fail();
    } catch (final UnsupportedOperationException e) {
    }
}

@SuppressWarnings("unchecked")
public void testUnmodifiableValues() {
    resetFull();
    final Collection<V> values = getMap().values();
    try {
        values.add((V) "four");
        fail();
    } catch (final UnsupportedOperationException e) {
    }

    try {
        values.remove("four");
        fail();
    } catch (final UnsupportedOperationException e) {
    }

    try {
        values.clear();
        fail();
    } catch (final UnsupportedOperationException e) {
    }

    final Iterator<V> it = values.iterator();
    try {
        it.remove();
        fail();
    } catch (final UnsupportedOperationException e) {
    }
}

@SuppressWarnings("unchecked")
public void testUnmodifiableKeys() {
    resetFull();
    final MultiSet<K> keys = getMap().keys();
    try {
        keys.add((K) "four");
        fail();
    } catch (final UnsupportedOperationException e) {
    }

    try {
        keys.remove("four");
        fail();
    } catch (final UnsupportedOperationException e) {
    }

    try {
        keys.clear();
        fail();
    } catch (final UnsupportedOperationException e) {
    }

    final Iterator<K> it = keys.iterator();
    try {
        it.remove();
        fail();
    } catch (final UnsupportedOperationException e) {
    }
}

```

## Candidates with size = 2

### commons_math_3_6_1

### 1

<span style="color:red"> Random inputs could be generated for both exp and log functions. Testing the undefined log(0) may be good direction for bug search. </span>

[175, 'src/test/java', 'org.apache.commons.math3.analysis.differentiation', 'SparseGradientTest', 'testExpm1Definition', 531, 540]

[175, 'src/test/java', 'org.apache.commons.math3.analysis.differentiation', 'SparseGradientTest', 'testLog1pDefinition', 550, 559]

```java

@Test
public void testExpm1Definition() {
    for (double x = 0.1; x < 1.2; x += 0.001) {
        SparseGradient sgX = SparseGradient.createVariable(0, x);
        SparseGradient expm11 = sgX.expm1();
        SparseGradient expm12 = sgX.exp().subtract(sgX.getField().getOne());
        SparseGradient zero = expm11.subtract(expm12);
        checkF0F1(zero, 0.0, 0.0);
    }
}

@Test
public void testLog1pDefinition() {
    for (double x = 0.1; x < 1.2; x += 0.001) {
        SparseGradient sgX = SparseGradient.createVariable(0, x);
        SparseGradient log1p1 = sgX.log1p();
        SparseGradient log1p2 = sgX.add(sgX.getField().getOne()).log();
        SparseGradient zero = log1p1.subtract(log1p2);
        checkF0F1(zero, 0.0, 0.0);
    }
}

```

### 2

<span style="color:red"> Bug search can be conducted over the undefined fractions with denominator of 0. </span>

[193, 'src/test/java', 'org.apache.commons.math3.fraction', 'BigFractionTest', 'testDigitLimitConstructor', 147, 160]

[193, 'src/test/java', 'org.apache.commons.math3.fraction', 'FractionTest', 'testDigitLimitConstructor', 121, 134]

```java
@Test
public void testDigitLimitConstructor() throws ConvergenceException {
    assertFraction(2, 5, new BigFraction(0.4, 9));
    assertFraction(2, 5, new BigFraction(0.4, 99));
    assertFraction(2, 5, new BigFraction(0.4, 999));

    assertFraction(3, 5, new BigFraction(0.6152, 9));
    assertFraction(8, 13, new BigFraction(0.6152, 99));
    assertFraction(510, 829, new BigFraction(0.6152, 999));
    assertFraction(769, 1250, new BigFraction(0.6152, 9999));

    // MATH-996
    assertFraction(1, 2, new BigFraction(0.5000000001, 10));
}

@Test
public void testDigitLimitConstructor() throws ConvergenceException  {
    assertFraction(2, 5, new Fraction(0.4,   9));
    assertFraction(2, 5, new Fraction(0.4,  99));
    assertFraction(2, 5, new Fraction(0.4, 999));

    assertFraction(3, 5,      new Fraction(0.6152,    9));
    assertFraction(8, 13,     new Fraction(0.6152,   99));
    assertFraction(510, 829,  new Fraction(0.6152,  999));
    assertFraction(769, 1250, new Fraction(0.6152, 9999));

    // MATH-996
    assertFraction(1, 2, new Fraction(0.5000000001, 10));
}
```

### 3

<span style="color:red"> Testing the geometric mean's behavior by feeding in zero of negative values.</span>

[230, 'src/test/java', 'org.apache.commons.math3.stat.descriptive', 'SummaryStatisticsTest', 'testOverrideMeanWithMathClass', 332, 341]

[230, 'src/test/java', 'org.apache.commons.math3.stat.descriptive', 'SummaryStatisticsTest', 'testOverrideGeoMeanWithMathClass', 343, 352]

```java

@Test
public void testOverrideMeanWithMathClass() {
    double[] scores = {1, 2, 3, 4};
    SummaryStatistics stats = new SummaryStatistics();
    stats.setMeanImpl(new Mean());
    for(double i : scores) {
      stats.addValue(i);
    }
    Assert.assertEquals((new Mean()).evaluate(scores),stats.getMean(), 0);
}

@Test
public void testOverrideGeoMeanWithMathClass() {
    double[] scores = {1, 2, 3, 4};
    SummaryStatistics stats = new SummaryStatistics();
    stats.setGeoMeanImpl(new GeometricMean());
    for(double i : scores) {
      stats.addValue(i);
    }
    Assert.assertEquals((new GeometricMean()).evaluate(scores),stats.getGeometricMean(), 0);
}

``` 

### 4

<span style="color:red"> Random inputs may be generated to test the behavior for both *Array2DRowRealMatrix* and *BlockRealMatrix*.</span>

[392, 'src/test/java', 'org.apache.commons.math3.linear', 'QRSolverTest', 'testOverdetermined', 145, 167]

[392, 'src/test/java', 'org.apache.commons.math3.linear', 'RRQRSolverTest', 'testOverdetermined', 148, 170]

```java

@Test
public void testOverdetermined() {
    final Random r    = new Random(5559252868205245l);
    int          p    = (7 * BlockRealMatrix.BLOCK_SIZE) / 4;
    int          q    = (5 * BlockRealMatrix.BLOCK_SIZE) / 4;
    RealMatrix   a    = createTestMatrix(r, p, q);
    RealMatrix   xRef = createTestMatrix(r, q, BlockRealMatrix.BLOCK_SIZE + 3);

    // build a perturbed system: A.X + noise = B
    RealMatrix b = a.multiply(xRef);
    final double noise = 0.001;
    b.walkInOptimizedOrder(new DefaultRealMatrixChangingVisitor() {
        @Override
        public double visit(int row, int column, double value) {
            return value * (1.0 + noise * (2 * r.nextDouble() - 1));
        }
    });

    // despite perturbation, the least square solution should be pretty good
    RealMatrix x = new QRDecomposition(a).getSolver().solve(b);
    Assert.assertEquals(0, x.subtract(xRef).getNorm(), 0.01 * noise * p * q);

}

    private RealMatrix createTestMatrix(final Random r, final int rows, final int columns) {
        RealMatrix m = MatrixUtils.createRealMatrix(rows, columns);
        m.walkInOptimizedOrder(new DefaultRealMatrixChangingVisitor() {
                @Override
                    public double visit(int row, int column, double value) {
                    return 2.0 * r.nextDouble() - 1.0;
                }
            });
        return m;
    }



@Test
public void testOverdetermined() {
    final Random r    = new Random(5559252868205245l);
    int          p    = (7 * BlockRealMatrix.BLOCK_SIZE) / 4;
    int          q    = (5 * BlockRealMatrix.BLOCK_SIZE) / 4;
    RealMatrix   a    = createTestMatrix(r, p, q);
    RealMatrix   xRef = createTestMatrix(r, q, BlockRealMatrix.BLOCK_SIZE + 3);

    // build a perturbed system: A.X + noise = B
    RealMatrix b = a.multiply(xRef);
    final double noise = 0.001;
    b.walkInOptimizedOrder(new DefaultRealMatrixChangingVisitor() {
        @Override
        public double visit(int row, int column, double value) {
            return value * (1.0 + noise * (2 * r.nextDouble() - 1));
        }
    });

    // despite perturbation, the least square solution should be pretty good
    RealMatrix x = new RRQRDecomposition(a).getSolver().solve(b);
    Assert.assertEquals(0, x.subtract(xRef).getNorm(), 0.01 * noise * p * q);

}

    private RealMatrix createTestMatrix(final Random r, final int rows, final int columns) {
        RealMatrix m = MatrixUtils.createRealMatrix(rows, columns);
        m.walkInOptimizedOrder(new DefaultRealMatrixChangingVisitor() {
                @Override
                    public double visit(int row, int column, double value) {
                    return 2.0 * r.nextDouble() - 1.0;
                }
            });
        return m;
    }

// createRealMatrix function in MatrixUtils.java

    /**
     * Returns a {@link RealMatrix} with specified dimensions.
     * <p>The type of matrix returned depends on the dimension. Below
     * 2<sup>12</sup> elements (i.e. 4096 elements or 64&times;64 for a
     * square matrix) which can be stored in a 32kB array, a {@link
     * Array2DRowRealMatrix} instance is built. Above this threshold a {@link
     * BlockRealMatrix} instance is built.</p>
     * <p>The matrix elements are all set to 0.0.</p>
     * @param rows number of rows of the matrix
     * @param columns number of columns of the matrix
     * @return  RealMatrix with specified dimensions
     * @see #createRealMatrix(double[][])
     */
    public static RealMatrix createRealMatrix(final int rows, final int columns) {
        return (rows * columns <= 4096) ?
                new Array2DRowRealMatrix(rows, columns) : new BlockRealMatrix(rows, columns);
    }
    
```

### 5

<span style="color:red"> Random inputs testing may help finding bugs regarding the behavior of GaussianCurveFitter.</span>

[463, 'src/test/java', 'org.apache.commons.math3.fitting', 'GaussianCurveFitterTest', 'testFit01', 181, 189]

[463, 'src/test/java', 'org.apache.commons.math3.fitting', 'GaussianCurveFitterTest', 'testFit07', 294, 302]

```java

@Test
public void testFit01() {
    GaussianCurveFitter fitter = GaussianCurveFitter.create();
    double[] parameters = fitter.fit(createDataset(DATASET1).toList());

    Assert.assertEquals(3496978.1837704973, parameters[0], 1e-4);
    Assert.assertEquals(4.054933085999146, parameters[1], 1e-4);
    Assert.assertEquals(0.015039355620304326, parameters[2], 1e-4);
}

@Test
public void testFit07() {
    GaussianCurveFitter fitter = GaussianCurveFitter.create();
    double[] parameters = fitter.fit(createDataset(DATASET5).toList());

    Assert.assertEquals(3514384.729342235, parameters[0], 1e-4);
    Assert.assertEquals(4.054970307455625, parameters[1], 1e-4);
    Assert.assertEquals(0.015029412832160017, parameters[2], 1e-4);
}

```

### 6

<span style="color:red"> More tests could be generated by using different numerical parameters, especially through the testing of important angles like 90 or 180 degrees. </span>

[538, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDSTest', 'testApplyInverseTo', 1133, 1185]

[538, 'src/test/java', 'org.apache.commons.math3.geometry.euclidean.threed', 'FieldRotationDfpTest', 'testApplyInverseTo', 900, 950]

```java

@Test
public void testApplyInverseTo() throws MathIllegalArgumentException {

    DerivativeStructure[] in      = new DerivativeStructure[3];
    DerivativeStructure[] out     = new DerivativeStructure[3];
    DerivativeStructure[] rebuilt = new DerivativeStructure[3];
    FieldRotation<DerivativeStructure> r = new FieldRotation<DerivativeStructure>(createVector(2, -3, 5),
                                                                                  createAngle(1.7),
                                                                                  RotationConvention.VECTOR_OPERATOR);
    for (double lambda = 0; lambda < 6.2; lambda += 0.2) {
        for (double phi = -1.55; phi < 1.55; phi += 0.2) {
            FieldVector3D<DerivativeStructure> u = createVector(FastMath.cos(lambda) * FastMath.cos(phi),
                                      FastMath.sin(lambda) * FastMath.cos(phi),
                                      FastMath.sin(phi));
            r.applyInverseTo(r.applyTo(u));
            checkVector(u, r.applyInverseTo(r.applyTo(u)));
            checkVector(u, r.applyTo(r.applyInverseTo(u)));
            in[0] = u.getX();
            in[1] = u.getY();
            in[2] = u.getZ();
            r.applyTo(in, out);
            r.applyInverseTo(out, rebuilt);
            Assert.assertEquals(in[0].getReal(), rebuilt[0].getReal(), 1.0e-12);
            Assert.assertEquals(in[1].getReal(), rebuilt[1].getReal(), 1.0e-12);
            Assert.assertEquals(in[2].getReal(), rebuilt[2].getReal(), 1.0e-12);
        }
    }

    r = createRotation(1, 0, 0, 0, false);
    for (double lambda = 0; lambda < 6.2; lambda += 0.2) {
        for (double phi = -1.55; phi < 1.55; phi += 0.2) {
            FieldVector3D<DerivativeStructure> u = createVector(FastMath.cos(lambda) * FastMath.cos(phi),
                                      FastMath.sin(lambda) * FastMath.cos(phi),
                                      FastMath.sin(phi));
            checkVector(u, r.applyInverseTo(r.applyTo(u)));
            checkVector(u, r.applyTo(r.applyInverseTo(u)));
        }
    }

    r = new FieldRotation<DerivativeStructure>(createVector(0, 0, 1),
                                               createAngle(FastMath.PI),
                                               RotationConvention.VECTOR_OPERATOR);
    for (double lambda = 0; lambda < 6.2; lambda += 0.2) {
        for (double phi = -1.55; phi < 1.55; phi += 0.2) {
            FieldVector3D<DerivativeStructure> u = createVector(FastMath.cos(lambda) * FastMath.cos(phi),
                                      FastMath.sin(lambda) * FastMath.cos(phi),
                                      FastMath.sin(phi));
            checkVector(u, r.applyInverseTo(r.applyTo(u)));
            checkVector(u, r.applyTo(r.applyInverseTo(u)));
        }
    }

}

@Test
public void testApplyInverseTo() throws MathIllegalArgumentException {

    Dfp[] in      = new Dfp[3];
    Dfp[] out     = new Dfp[3];
    Dfp[] rebuilt = new Dfp[3];
    FieldRotation<Dfp> r = new FieldRotation<Dfp>(createVector(2, -3, 5),
                                                  createAngle(1.7),
                                                  RotationConvention.VECTOR_OPERATOR);
    for (double lambda = 0; lambda < 6.2; lambda += 0.2) {
        for (double phi = -1.55; phi < 1.55; phi += 0.2) {
            FieldVector3D<Dfp> u = createVector(FastMath.cos(lambda) * FastMath.cos(phi),
                                      FastMath.sin(lambda) * FastMath.cos(phi),
                                      FastMath.sin(phi));
            r.applyInverseTo(r.applyTo(u));
            checkVector(u, r.applyInverseTo(r.applyTo(u)));
            checkVector(u, r.applyTo(r.applyInverseTo(u)));
            in[0] = u.getX();
            in[1] = u.getY();
            in[2] = u.getZ();
            r.applyTo(in, out);
            r.applyInverseTo(out, rebuilt);
            Assert.assertEquals(in[0].getReal(), rebuilt[0].getReal(), 1.0e-12);
            Assert.assertEquals(in[1].getReal(), rebuilt[1].getReal(), 1.0e-12);
            Assert.assertEquals(in[2].getReal(), rebuilt[2].getReal(), 1.0e-12);
        }
    }

    r = createRotation(1, 0, 0, 0, false);
    for (double lambda = 0; lambda < 6.2; lambda += 0.2) {
        for (double phi = -1.55; phi < 1.55; phi += 0.2) {
            FieldVector3D<Dfp> u = createVector(FastMath.cos(lambda) * FastMath.cos(phi),
                                      FastMath.sin(lambda) * FastMath.cos(phi),
                                      FastMath.sin(phi));
            checkVector(u, r.applyInverseTo(r.applyTo(u)));
            checkVector(u, r.applyTo(r.applyInverseTo(u)));
        }
    }

    r = new FieldRotation<Dfp>(createVector(0, 0, 1), createAngle(FastMath.PI), RotationConvention.VECTOR_OPERATOR);
    for (double lambda = 0; lambda < 6.2; lambda += 0.2) {
        for (double phi = -1.55; phi < 1.55; phi += 0.2) {
            FieldVector3D<Dfp> u = createVector(FastMath.cos(lambda) * FastMath.cos(phi),
                                      FastMath.sin(lambda) * FastMath.cos(phi),
                                      FastMath.sin(phi));
            checkVector(u, r.applyInverseTo(r.applyTo(u)));
            checkVector(u, r.applyTo(r.applyInverseTo(u)));
        }
    }

}

```

### 7 

<span style="color:red"> Random testing may be a good approach to test the behaviour of interpolate methods. </span>

[595, 'src/test/java', 'org.apache.commons.math3.analysis.interpolation', 'DividedDifferenceInterpolatorTest', 'testExpm1Function', 80, 109]

[595, 'src/test/java', 'org.apache.commons.math3.analysis.interpolation', 'NevilleInterpolatorTest', 'testExpm1Function', 80, 109]

```java

@Test
public void testExpm1Function() {
    UnivariateFunction f = new Expm1();
    UnivariateInterpolator interpolator = new DividedDifferenceInterpolator();
    double x[], y[], z, expected, result, tolerance;

    // 5 interpolating points on interval [-1, 1]
    int n = 5;
    double min = -1.0, max = 1.0;
    x = new double[n];
    y = new double[n];
    for (int i = 0; i < n; i++) {
        x[i] = min + i * (max - min) / n;
        y[i] = f.value(x[i]);
    }
    double derivativebound = FastMath.E;
    UnivariateFunction p = interpolator.interpolate(x, y);

    z = 0.0; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);

    z = 0.5; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);

    z = -0.5; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);
}

@Test
public void testExpm1Function() {
    UnivariateFunction f = new Expm1();
    UnivariateInterpolator interpolator = new NevilleInterpolator();
    double x[], y[], z, expected, result, tolerance;

    // 5 interpolating points on interval [-1, 1]
    int n = 5;
    double min = -1.0, max = 1.0;
    x = new double[n];
    y = new double[n];
    for (int i = 0; i < n; i++) {
        x[i] = min + i * (max - min) / n;
        y[i] = f.value(x[i]);
    }
    double derivativebound = FastMath.E;
    UnivariateFunction p = interpolator.interpolate(x, y);

    z = 0.0; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);

    z = 0.5; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);

    z = -0.5; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);
}

```

### 8 

<span style="color:red"> Same idea as Candidate **7**.</span>

[693, 'src/test/java', 'org.apache.commons.math3.analysis.interpolation', 'DividedDifferenceInterpolatorTest', 'testSinFunction', 48, 73]

[693, 'src/test/java', 'org.apache.commons.math3.analysis.interpolation', 'NevilleInterpolatorTest', 'testSinFunction', 48, 73]

```java

@Test
public void testSinFunction() {
    UnivariateFunction f = new Sin();
    UnivariateInterpolator interpolator = new DividedDifferenceInterpolator();
    double x[], y[], z, expected, result, tolerance;

    // 6 interpolating points on interval [0, 2*PI]
    int n = 6;
    double min = 0.0, max = 2 * FastMath.PI;
    x = new double[n];
    y = new double[n];
    for (int i = 0; i < n; i++) {
        x[i] = min + i * (max - min) / n;
        y[i] = f.value(x[i]);
    }
    double derivativebound = 1.0;
    UnivariateFunction p = interpolator.interpolate(x, y);

    z = FastMath.PI / 4; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);

    z = FastMath.PI * 1.5; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);
}

@Test
public void testSinFunction() {
    UnivariateFunction f = new Sin();
    UnivariateInterpolator interpolator = new NevilleInterpolator();
    double x[], y[], z, expected, result, tolerance;

    // 6 interpolating points on interval [0, 2*PI]
    int n = 6;
    double min = 0.0, max = 2 * FastMath.PI;
    x = new double[n];
    y = new double[n];
    for (int i = 0; i < n; i++) {
        x[i] = min + i * (max - min) / n;
        y[i] = f.value(x[i]);
    }
    double derivativebound = 1.0;
    UnivariateFunction p = interpolator.interpolate(x, y);

    z = FastMath.PI / 4; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);

    z = FastMath.PI * 1.5; expected = f.value(z); result = p.value(z);
    tolerance = FastMath.abs(derivativebound * partialerror(x, z));
    Assert.assertEquals(expected, result, tolerance);
}

```

### 9

<span style="color:red"> Test the convergence exception, and perhaps other behavior for the distributions with random testing.</span>

[649, 'src/test/java', 'org.apache.commons.math3.distribution', 'LogNormalDistributionTest', 'testExtremeValues', 207, 224]

[649, 'src/test/java', 'org.apache.commons.math3.distribution', 'ParetoDistributionTest', 'testExtremeValues', 173, 190]
 
```java

@Test
public void testExtremeValues() {
    LogNormalDistribution d = new LogNormalDistribution(0, 1);
    for (int i = 0; i < 1e5; i++) { // make sure no convergence exception
        double upperTail = d.cumulativeProbability(i);
        if (i <= 72) { // make sure not top-coded
            Assert.assertTrue(upperTail < 1.0d);
        }
        else { // make sure top coding not reversed
            Assert.assertTrue(upperTail > 0.99999);
        }
    }

    Assert.assertEquals(d.cumulativeProbability(Double.MAX_VALUE), 1, 0);
    Assert.assertEquals(d.cumulativeProbability(-Double.MAX_VALUE), 0, 0);
    Assert.assertEquals(d.cumulativeProbability(Double.POSITIVE_INFINITY), 1, 0);
    Assert.assertEquals(d.cumulativeProbability(Double.NEGATIVE_INFINITY), 0, 0);
}

@Test
public void testExtremeValues() {
    ParetoDistribution d = new ParetoDistribution(1, 1);
    for (int i = 0; i < 1e5; i++) { // make sure no convergence exception
        double upperTail = d.cumulativeProbability(i);
        if (i <= 1000) { // make sure not top-coded
            Assert.assertTrue(upperTail < 1.0d);
        }
        else { // make sure top coding not reversed
            Assert.assertTrue(upperTail > 0.999);
        }
    }

    Assert.assertEquals(d.cumulativeProbability(Double.MAX_VALUE), 1, 0);
    Assert.assertEquals(d.cumulativeProbability(-Double.MAX_VALUE), 0, 0);
    Assert.assertEquals(d.cumulativeProbability(Double.POSITIVE_INFINITY), 1, 0);
    Assert.assertEquals(d.cumulativeProbability(Double.NEGATIVE_INFINITY), 0, 0);
}
```

### 10

<span style="color:red"> Many parameters for the *optimize* function makes this clone pair a very good candidate for random testing. </span>

[1043, 'src/test/java', 'org.apache.commons.math3.optim.nonlinear.vector.jacobian', 'GaussNewtonOptimizerTest', 'testConstraintsUnsupported', 104, 112]

[1043, 'src/test/java', 'org.apache.commons.math3.optim.nonlinear.vector.jacobian', 'LevenbergMarquardtOptimizerTest', 'testConstraintsUnsupported', 113, 121]

```java

@Test(expected=MathUnsupportedOperationException.class)
public void testConstraintsUnsupported() {
    createOptimizer().optimize(new MaxEval(100),
                               new Target(new double[] { 2 }),
                               new Weight(new double[] { 1 }),
                               new InitialGuess(new double[] { 1, 2 }),
                               new SimpleBounds(new double[] { -10, 0 },
                                                new double[] { 20, 30 }));
}

@Test(expected=MathUnsupportedOperationException.class)
public void testConstraintsUnsupported() {
    createOptimizer().optimize(new MaxEval(100),
                               new Target(new double[] { 2 }),
                               new Weight(new double[] { 1 }),
                               new InitialGuess(new double[] { 1, 2 }),
                               new SimpleBounds(new double[] { -10, 0 },
                                                new double[] { 20, 30 }));
}

```

[1562, 'src/test/java', 'org.apache.commons.math3.optim.nonlinear.scalar.noderiv', 'SimplexOptimizerMultiDirectionalTest', 'testBoundsUnsupported', 34, 46]

[1562, 'src/test/java', 'org.apache.commons.math3.optim.nonlinear.scalar.noderiv', 'SimplexOptimizerNelderMeadTest', 'testBoundsUnsupported', 39, 51]

```java

@Test(expected=MathUnsupportedOperationException.class)
public void testBoundsUnsupported() {
    SimplexOptimizer optimizer = new SimplexOptimizer(1e-10, 1e-30);
    final FourExtrema fourExtrema = new FourExtrema();

    optimizer.optimize(new MaxEval(100),
                       new ObjectiveFunction(fourExtrema),
                       GoalType.MINIMIZE,
                       new InitialGuess(new double[] { -3, 0 }),
                       new NelderMeadSimplex(new double[] { 0.2, 0.2 }),
                       new SimpleBounds(new double[] { -5, -1 },
                                        new double[] { 5, 1 }));
}

@Test(expected=MathUnsupportedOperationException.class)
public void testBoundsUnsupported() {
    SimplexOptimizer optimizer = new SimplexOptimizer(1e-10, 1e-30);
    final FourExtrema fourExtrema = new FourExtrema();

    optimizer.optimize(new MaxEval(100),
                       new ObjectiveFunction(fourExtrema),
                       GoalType.MINIMIZE,
                       new InitialGuess(new double[] { -3, 0 }),
                       new NelderMeadSimplex(new double[] { 0.2, 0.2 }),
                       new SimpleBounds(new double[] { -5, -1 },
                                        new double[] { 5, 1 }));
}

```

### 11

<span style="color:red"> There could be more ways to test the behavior of the iteration listener through the random inputs testing. </span>

[1810, 'src/test/java', 'org.apache.commons.math3.linear', 'ConjugateGradientTest', 'testUnpreconditionedNormOfResidual', 510, 554]

[1810, 'src/test/java', 'org.apache.commons.math3.linear', 'SymmLQTest', 'testUnpreconditionedNormOfResidual', 594, 638]

```java

@Test
public void testUnpreconditionedNormOfResidual() {
    final int n = 5;
    final int maxIterations = 100;
    final RealLinearOperator a = new HilbertMatrix(n);
    final IterativeLinearSolver solver;
    final IterationListener listener = new IterationListener() {

        private void doTestNormOfResidual(final IterationEvent e) {
            final IterativeLinearSolverEvent evt;
            evt = (IterativeLinearSolverEvent) e;
            final RealVector x = evt.getSolution();
            final RealVector b = evt.getRightHandSideVector();
            final RealVector r = b.subtract(a.operate(x));
            final double rnorm = r.getNorm();
            Assert.assertEquals("iteration performed (residual)",
                rnorm, evt.getNormOfResidual(),
                FastMath.max(1E-5 * rnorm, 1E-10));
        }

        public void initializationPerformed(final IterationEvent e) {
            doTestNormOfResidual(e);
        }

        public void iterationPerformed(final IterationEvent e) {
            doTestNormOfResidual(e);
        }

        public void iterationStarted(final IterationEvent e) {
            doTestNormOfResidual(e);
        }

        public void terminationPerformed(final IterationEvent e) {
            doTestNormOfResidual(e);
        }
    };
    solver = new ConjugateGradient(maxIterations, 1E-10, true);
    solver.getIterationManager().addIterationListener(listener);
    final RealVector b = new ArrayRealVector(n);
    for (int j = 0; j < n; j++) {
        b.set(0.);
        b.setEntry(j, 1.);
        solver.solve(a, b);
    }
}

@Test
public void testUnpreconditionedNormOfResidual() {
    final int n = 5;
    final int maxIterations = 100;
    final RealLinearOperator a = new HilbertMatrix(n);
    final IterativeLinearSolver solver;
    final IterationListener listener = new IterationListener() {

        private void doTestNormOfResidual(final IterationEvent e) {
            final IterativeLinearSolverEvent evt;
            evt = (IterativeLinearSolverEvent) e;
            final RealVector x = evt.getSolution();
            final RealVector b = evt.getRightHandSideVector();
            final RealVector r = b.subtract(a.operate(x));
            final double rnorm = r.getNorm();
            Assert.assertEquals("iteration performed (residual)",
                rnorm, evt.getNormOfResidual(),
                FastMath.max(1E-5 * rnorm, 1E-10));
        }

        public void initializationPerformed(final IterationEvent e) {
            doTestNormOfResidual(e);
        }

        public void iterationPerformed(final IterationEvent e) {
            doTestNormOfResidual(e);
        }

        public void iterationStarted(final IterationEvent e) {
            doTestNormOfResidual(e);
        }

        public void terminationPerformed(final IterationEvent e) {
            doTestNormOfResidual(e);
        }
    };
    solver = new SymmLQ(maxIterations, 1E-10, true);
    solver.getIterationManager().addIterationListener(listener);
    final RealVector b = new ArrayRealVector(n);
    for (int j = 0; j < n; j++) {
        b.set(0.);
        b.setEntry(j, 1.);
        solver.solve(a, b);
    }
}

```

### 12

<span style="color:red"> Using random inputs testing, more tests could be done investigating the behaviour of fast fourier transfomer. </span>

[1955, 'src/test/java', 'org.apache.commons.math3.transform', 'FastFourierTransformerTest', 'testTransformFunctionSizeNotAPowerOfTwo', 93, 114]

[1955, 'src/test/java', 'org.apache.commons.math3.transform', 'FastFourierTransformerTest', 'testTransformFunctionInvalidBounds', 140, 161]

```java

@Test
public void testTransformFunctionSizeNotAPowerOfTwo() {
    final int n = 127;
    final UnivariateFunction f = new Sin();
    final DftNormalization[] norm;
    norm = DftNormalization.values();
    final TransformType[] type;
    type = TransformType.values();
    for (int i = 0; i < norm.length; i++) {
        for (int j = 0; j < type.length; j++) {
            final FastFourierTransformer fft;
            fft = new FastFourierTransformer(norm[i]);
            try {
                fft.transform(f, 0.0, Math.PI, n, type[j]);
                Assert.fail(norm[i] + ", " + type[j] +
                    ": MathIllegalArgumentException was expected");
            } catch (MathIllegalArgumentException e) {
                // Expected behaviour
            }
        }
    }
}

@Test
public void testTransformFunctionInvalidBounds() {
    final int n = 128;
    final UnivariateFunction f = new Sin();
    final DftNormalization[] norm;
    norm = DftNormalization.values();
    final TransformType[] type;
    type = TransformType.values();
    for (int i = 0; i < norm.length; i++) {
        for (int j = 0; j < type.length; j++) {
            final FastFourierTransformer fft;
            fft = new FastFourierTransformer(norm[i]);
            try {
                fft.transform(f, Math.PI, 0.0, n, type[j]);
                Assert.fail(norm[i] + ", " + type[j] +
                    ": NumberIsTooLargeException was expected");
            } catch (NumberIsTooLargeException e) {
                // Expected behaviour
            }
        }
    }
}

```

### 13

<span style="color:red">Many places within this clone pair may be investigated for bug search through random inputs testing from the coverage and semantic ananlysis perspective.</span>


[2070, 'src/test/java', 'org.apache.commons.math3.linear', 'Array2DRowRealMatrixTest', 'testWalk', 991, 1075]

[2070, 'src/test/java', 'org.apache.commons.math3.linear', 'BlockRealMatrixTest', 'testWalk', 1142, 1227]

```java

@Test
public void testWalk() {
    int rows    = 150;
    int columns = 75;

    RealMatrix m = new Array2DRowRealMatrix(rows, columns);
    m.walkInRowOrder(new SetVisitor());
    GetVisitor getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new Array2DRowRealMatrix(rows, columns);
    m.walkInRowOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(0.0, m.getEntry(i, 0), 0);
        Assert.assertEquals(0.0, m.getEntry(i, columns - 1), 0);
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(0.0, m.getEntry(0, j), 0);
        Assert.assertEquals(0.0, m.getEntry(rows - 1, j), 0);
    }

    m = new Array2DRowRealMatrix(rows, columns);
    m.walkInColumnOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new Array2DRowRealMatrix(rows, columns);
    m.walkInColumnOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(0.0, m.getEntry(i, 0), 0);
        Assert.assertEquals(0.0, m.getEntry(i, columns - 1), 0);
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(0.0, m.getEntry(0, j), 0);
        Assert.assertEquals(0.0, m.getEntry(rows - 1, j), 0);
    }

    m = new Array2DRowRealMatrix(rows, columns);
    m.walkInOptimizedOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInRowOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new Array2DRowRealMatrix(rows, columns);
    m.walkInOptimizedOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInRowOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(0.0, m.getEntry(i, 0), 0);
        Assert.assertEquals(0.0, m.getEntry(i, columns - 1), 0);
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(0.0, m.getEntry(0, j), 0);
        Assert.assertEquals(0.0, m.getEntry(rows - 1, j), 0);
    }

    m = new Array2DRowRealMatrix(rows, columns);
    m.walkInOptimizedOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInColumnOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new Array2DRowRealMatrix(rows, columns);
    m.walkInOptimizedOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInColumnOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(0.0, m.getEntry(i, 0), 0);
        Assert.assertEquals(0.0, m.getEntry(i, columns - 1), 0);
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(0.0, m.getEntry(0, j), 0);
        Assert.assertEquals(0.0, m.getEntry(rows - 1, j), 0);
    }
}

@Test
public void testWalk() {
    int rows    = 150;
    int columns = 75;

    RealMatrix m = new BlockRealMatrix(rows, columns);
    m.walkInRowOrder(new SetVisitor());
    GetVisitor getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new BlockRealMatrix(rows, columns);
    m.walkInRowOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(0.0, m.getEntry(i, 0), 0);
        Assert.assertEquals(0.0, m.getEntry(i, columns - 1), 0);
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(0.0, m.getEntry(0, j), 0);
        Assert.assertEquals(0.0, m.getEntry(rows - 1, j), 0);
    }

    m = new BlockRealMatrix(rows, columns);
    m.walkInColumnOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new BlockRealMatrix(rows, columns);
    m.walkInColumnOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(0.0, m.getEntry(i, 0), 0);
        Assert.assertEquals(0.0, m.getEntry(i, columns - 1), 0);
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(0.0, m.getEntry(0, j), 0);
        Assert.assertEquals(0.0, m.getEntry(rows - 1, j), 0);
    }

    m = new BlockRealMatrix(rows, columns);
    m.walkInOptimizedOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInRowOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new BlockRealMatrix(rows, columns);
    m.walkInOptimizedOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInRowOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(0.0, m.getEntry(i, 0), 0);
        Assert.assertEquals(0.0, m.getEntry(i, columns - 1), 0);
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(0.0, m.getEntry(0, j), 0);
        Assert.assertEquals(0.0, m.getEntry(rows - 1, j), 0);
    }

    m = new BlockRealMatrix(rows, columns);
    m.walkInOptimizedOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInColumnOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new BlockRealMatrix(rows, columns);
    m.walkInOptimizedOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInColumnOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(0.0, m.getEntry(i, 0), 0);
        Assert.assertEquals(0.0, m.getEntry(i, columns - 1), 0);
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(0.0, m.getEntry(0, j), 0);
        Assert.assertEquals(0.0, m.getEntry(rows - 1, j), 0);
    }

}

```

[2302, 'src/test/java', 'org.apache.commons.math3.linear', 'BlockFieldMatrixTest', 'testWalk', 1242, 1327]

[2302, 'src/test/java', 'org.apache.commons.math3.linear', 'FieldMatrixImplTest', 'testWalk', 969, 1054]

```java

@Test
public void testWalk() {
    int rows    = 150;
    int columns = 75;

    FieldMatrix<Fraction> m = new BlockFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInRowOrder(new SetVisitor());
    GetVisitor getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new BlockFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInRowOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(new Fraction(0), m.getEntry(i, 0));
        Assert.assertEquals(new Fraction(0), m.getEntry(i, columns - 1));
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(new Fraction(0), m.getEntry(0, j));
        Assert.assertEquals(new Fraction(0), m.getEntry(rows - 1, j));
    }

    m = new BlockFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInColumnOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new BlockFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInColumnOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(new Fraction(0), m.getEntry(i, 0));
        Assert.assertEquals(new Fraction(0), m.getEntry(i, columns - 1));
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(new Fraction(0), m.getEntry(0, j));
        Assert.assertEquals(new Fraction(0), m.getEntry(rows - 1, j));
    }

    m = new BlockFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInOptimizedOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInRowOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new BlockFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInOptimizedOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInRowOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(new Fraction(0), m.getEntry(i, 0));
        Assert.assertEquals(new Fraction(0), m.getEntry(i, columns - 1));
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(new Fraction(0), m.getEntry(0, j));
        Assert.assertEquals(new Fraction(0), m.getEntry(rows - 1, j));
    }

    m = new BlockFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInOptimizedOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInColumnOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new BlockFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInOptimizedOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInColumnOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(new Fraction(0), m.getEntry(i, 0));
        Assert.assertEquals(new Fraction(0), m.getEntry(i, columns - 1));
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(new Fraction(0), m.getEntry(0, j));
        Assert.assertEquals(new Fraction(0), m.getEntry(rows - 1, j));
    }

}

@Test
public void testWalk() {
    int rows    = 150;
    int columns = 75;

    FieldMatrix<Fraction> m =
        new Array2DRowFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInRowOrder(new SetVisitor());
    GetVisitor getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new Array2DRowFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInRowOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(new Fraction(0), m.getEntry(i, 0));
        Assert.assertEquals(new Fraction(0), m.getEntry(i, columns - 1));
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(new Fraction(0), m.getEntry(0, j));
        Assert.assertEquals(new Fraction(0), m.getEntry(rows - 1, j));
    }

    m = new Array2DRowFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInColumnOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new Array2DRowFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInColumnOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInOptimizedOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(new Fraction(0), m.getEntry(i, 0));
        Assert.assertEquals(new Fraction(0), m.getEntry(i, columns - 1));
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(new Fraction(0), m.getEntry(0, j));
        Assert.assertEquals(new Fraction(0), m.getEntry(rows - 1, j));
    }

    m = new Array2DRowFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInOptimizedOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInRowOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new Array2DRowFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInOptimizedOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInRowOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(new Fraction(0), m.getEntry(i, 0));
        Assert.assertEquals(new Fraction(0), m.getEntry(i, columns - 1));
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(new Fraction(0), m.getEntry(0, j));
        Assert.assertEquals(new Fraction(0), m.getEntry(rows - 1, j));
    }

    m = new Array2DRowFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInOptimizedOrder(new SetVisitor());
    getVisitor = new GetVisitor();
    m.walkInColumnOrder(getVisitor);
    Assert.assertEquals(rows * columns, getVisitor.getCount());

    m = new Array2DRowFieldMatrix<Fraction>(FractionField.getInstance(), rows, columns);
    m.walkInOptimizedOrder(new SetVisitor(), 1, rows - 2, 1, columns - 2);
    getVisitor = new GetVisitor();
    m.walkInColumnOrder(getVisitor, 1, rows - 2, 1, columns - 2);
    Assert.assertEquals((rows - 2) * (columns - 2), getVisitor.getCount());
    for (int i = 0; i < rows; ++i) {
        Assert.assertEquals(new Fraction(0), m.getEntry(i, 0));
        Assert.assertEquals(new Fraction(0), m.getEntry(i, columns - 1));
    }
    for (int j = 0; j < columns; ++j) {
        Assert.assertEquals(new Fraction(0), m.getEntry(0, j));
        Assert.assertEquals(new Fraction(0), m.getEntry(rows - 1, j));
    }
}

```

### 14

[2112, 'src/test/java', 'org.apache.commons.math3.ode.nonstiff', 'GillIntegratorTest', 'testDecreasingSteps', 55, 101]

[2112, 'src/test/java', 'org.apache.commons.math3.ode.nonstiff', 'ThreeEighthesIntegratorTest', 'testDecreasingSteps', 55, 101]

```java

@Test 
public void testDecreasingSteps() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {

  for (TestProblemAbstract pb : new TestProblemAbstract[] {
      new TestProblem1(), new TestProblem2(), new TestProblem3(),
      new TestProblem4(), new TestProblem5(), new TestProblem6()
  }) {

  double previousValueError = Double.NaN;
  double previousTimeError = Double.NaN;
  for (int i = 5; i < 10; ++i) {

    double step = (pb.getFinalTime() - pb.getInitialTime()) * FastMath.pow(2.0, -i);

    FirstOrderIntegrator integ = new GillIntegrator(step);
    TestProblemHandler handler = new TestProblemHandler(pb, integ);
    integ.addStepHandler(handler);
    EventHandler[] functions = pb.getEventsHandlers();
    for (int l = 0; l < functions.length; ++l) {
      integ.addEventHandler(functions[l],
                                 Double.POSITIVE_INFINITY, 1.0e-6 * step, 1000);
    }
    double stopTime = integ.integrate(pb, pb.getInitialTime(), pb.getInitialState(),
                                      pb.getFinalTime(), new double[pb.getDimension()]);
    if (functions.length == 0) {
        Assert.assertEquals(pb.getFinalTime(), stopTime, 1.0e-10);
    }

    double valueError = handler.getMaximalValueError();
    if (i > 5) {
      Assert.assertTrue(valueError < 1.01 * FastMath.abs(previousValueError));
    }
    previousValueError = valueError;

    double timeError = handler.getMaximalTimeError();
    if (i > 5) {
      Assert.assertTrue(timeError <= FastMath.abs(previousTimeError));
    }
    previousTimeError = timeError;

  }

 }
}

@Test 
public void testDecreasingSteps() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {

  for (TestProblemAbstract pb : new TestProblemAbstract[] {
      new TestProblem1(), new TestProblem2(), new TestProblem3(),
      new TestProblem4(), new TestProblem5(), new TestProblem6()
  }) {

  double previousValueError = Double.NaN;
  double previousTimeError = Double.NaN;
  for (int i = 4; i < 10; ++i) {

    double step = (pb.getFinalTime() - pb.getInitialTime()) * FastMath.pow(2.0, -i);

    FirstOrderIntegrator integ = new ThreeEighthesIntegrator(step);
    TestProblemHandler handler = new TestProblemHandler(pb, integ);
    integ.addStepHandler(handler);
    EventHandler[] functions = pb.getEventsHandlers();
    for (int l = 0; l < functions.length; ++l) {
      integ.addEventHandler(functions[l],
                                 Double.POSITIVE_INFINITY, 1.0e-6 * step, 1000);
    }
    double stopTime = integ.integrate(pb, pb.getInitialTime(), pb.getInitialState(),
                                      pb.getFinalTime(), new double[pb.getDimension()]);
    if (functions.length == 0) {
        Assert.assertEquals(pb.getFinalTime(), stopTime, 1.0e-10);
    }

    double error = handler.getMaximalValueError();
    if (i > 4) {
      Assert.assertTrue(error < 1.01 * FastMath.abs(previousValueError));
    }
    previousValueError = error;

    double timeError = handler.getMaximalTimeError();
    if (i > 4) {
      Assert.assertTrue(timeError <= FastMath.abs(previousTimeError));
    }
    previousTimeError = timeError;

  }

 }
}

```

[2333, 'src/test/java', 'org.apache.commons.math3.ode.nonstiff', 'EulerIntegratorTest', 'testDecreasingSteps', 55, 101]

[2333, 'src/test/java', 'org.apache.commons.math3.ode.nonstiff', 'MidpointIntegratorTest', 'testDecreasingSteps', 55, 101]

```java

@Test 
public void testDecreasingSteps() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {

  for (TestProblemAbstract pb : new TestProblemAbstract[] {
      new TestProblem1(), new TestProblem2(), new TestProblem3(),
      new TestProblem4(), new TestProblem5(), new TestProblem6()
  }) {

  double previousValueError = Double.NaN;
  double previousTimeError = Double.NaN;
  for (int i = 4; i < 8; ++i) {

    double step = (pb.getFinalTime() - pb.getInitialTime()) * FastMath.pow(2.0, -i);

    FirstOrderIntegrator integ = new EulerIntegrator(step);
    TestProblemHandler handler = new TestProblemHandler(pb, integ);
    integ.addStepHandler(handler);
    EventHandler[] functions = pb.getEventsHandlers();
    for (int l = 0; l < functions.length; ++l) {
      integ.addEventHandler(functions[l],
                                 Double.POSITIVE_INFINITY, 1.0e-6 * step, 1000);
    }
    double stopTime = integ.integrate(pb, pb.getInitialTime(), pb.getInitialState(),
                                      pb.getFinalTime(), new double[pb.getDimension()]);
    if (functions.length == 0) {
        Assert.assertEquals(pb.getFinalTime(), stopTime, 1.0e-10);
    }

    double valueError = handler.getMaximalValueError();
    if (i > 4) {
      Assert.assertTrue(valueError < FastMath.abs(previousValueError));
    }
    previousValueError = valueError;

    double timeError = handler.getMaximalTimeError();
    if (i > 4) {
      Assert.assertTrue(timeError <= FastMath.abs(previousTimeError));
    }
    previousTimeError = timeError;

  }

 }
}

@Test 
public void testDecreasingSteps() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {

  for (TestProblemAbstract pb : new TestProblemAbstract[] {
      new TestProblem1(), new TestProblem2(), new TestProblem3(),
      new TestProblem4(), new TestProblem5(), new TestProblem6()
  }) {

  double previousValueError = Double.NaN;
  double previousTimeError = Double.NaN;
  for (int i = 4; i < 10; ++i) {

    double step = (pb.getFinalTime() - pb.getInitialTime()) * FastMath.pow(2.0, -i);
    FirstOrderIntegrator integ = new MidpointIntegrator(step);
    TestProblemHandler handler = new TestProblemHandler(pb, integ);
    integ.addStepHandler(handler);
    EventHandler[] functions = pb.getEventsHandlers();
    for (int l = 0; l < functions.length; ++l) {
      integ.addEventHandler(functions[l],
                                 Double.POSITIVE_INFINITY, 1.0e-6 * step, 1000);
    }
    double stopTime = integ.integrate(pb,
                                      pb.getInitialTime(), pb.getInitialState(),
                                      pb.getFinalTime(), new double[pb.getDimension()]);
    if (functions.length == 0) {
        Assert.assertEquals(pb.getFinalTime(), stopTime, 1.0e-10);
    }

    double valueError = handler.getMaximalValueError();
    if (i > 4) {
      Assert.assertTrue(valueError < FastMath.abs(previousValueError));
    }
    previousValueError = valueError;

    double timeError = handler.getMaximalTimeError();
    if (i > 4) {
      Assert.assertTrue(timeError <= FastMath.abs(previousTimeError));
    }
    previousTimeError = timeError;

  }

 } 
}

```


[3019, 'src/test/java', 'org.apache.commons.math3.ode.nonstiff', 'ClassicalRungeKuttaIntegratorTest', 'testDecreasingSteps', 133, 182]

[3019, 'src/test/java', 'org.apache.commons.math3.ode.nonstiff', 'LutherIntegratorTest', 'testDecreasingSteps', 133, 182]

```java

@Test 
public void testDecreasingSteps() throws DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {

for (TestProblemAbstract pb : new TestProblemAbstract[] {
    new TestProblem1(), new TestProblem2(), new TestProblem3(),
    new TestProblem4(), new TestProblem5(), new TestProblem6()
}) {

  double previousValueError = Double.NaN;
  double previousTimeError = Double.NaN;
  for (int i = 4; i < 10; ++i) {

    double step = (pb.getFinalTime() - pb.getInitialTime()) * FastMath.pow(2.0, -i);

    FirstOrderIntegrator integ = new ClassicalRungeKuttaIntegrator(step);
    TestProblemHandler handler = new TestProblemHandler(pb, integ);
    integ.addStepHandler(handler);
    EventHandler[] functions = pb.getEventsHandlers();
    for (int l = 0; l < functions.length; ++l) {
      integ.addEventHandler(functions[l],
                                 Double.POSITIVE_INFINITY, 1.0e-6 * step, 1000);
    }
    Assert.assertEquals(functions.length, integ.getEventHandlers().size());
    double stopTime = integ.integrate(pb, pb.getInitialTime(), pb.getInitialState(),
                                      pb.getFinalTime(), new double[pb.getDimension()]);
    if (functions.length == 0) {
        Assert.assertEquals(pb.getFinalTime(), stopTime, 1.0e-10);
    }

    double error = handler.getMaximalValueError();
    if (i > 4) {
      Assert.assertTrue(error < 1.01 * FastMath.abs(previousValueError));
    }
    previousValueError = error;

    double timeError = handler.getMaximalTimeError();
    if (i > 4) {
      Assert.assertTrue(timeError <= FastMath.abs(previousTimeError));
    }
    previousTimeError = timeError;

    integ.clearEventHandlers();
    Assert.assertEquals(0, integ.getEventHandlers().size());
  }

 }
}

@Test
public void testDecreasingSteps()
        throws DimensionMismatchException, NumberIsTooSmallException,
        MaxCountExceededException, NoBracketingException {

    for (TestProblemAbstract pb : new TestProblemAbstract[] {
        new TestProblem1(), new TestProblem2(), new TestProblem3(),
        new TestProblem4(), new TestProblem5(), new TestProblem6()
    }) {

        double previousValueError = Double.NaN;
        double previousTimeError = Double.NaN;
        for (int i = 4; i < 10; ++i) {

            double step = (pb.getFinalTime() - pb.getInitialTime()) * FastMath.pow(2.0, -i);

            FirstOrderIntegrator integ = new LutherIntegrator(step);
            TestProblemHandler handler = new TestProblemHandler(pb, integ);
            integ.addStepHandler(handler);
            EventHandler[] functions = pb.getEventsHandlers();
            for (int l = 0; l < functions.length; ++l) {
                integ.addEventHandler(functions[l],
                                      Double.POSITIVE_INFINITY, 1.0e-6 * step, 1000);
            }
            Assert.assertEquals(functions.length, integ.getEventHandlers().size());
            double stopTime = integ.integrate(pb, pb.getInitialTime(), pb.getInitialState(),
                                              pb.getFinalTime(), new double[pb.getDimension()]);
            if (functions.length == 0) {
                Assert.assertEquals(pb.getFinalTime(), stopTime, 1.0e-10);
            }

            double error = handler.getMaximalValueError();
            if (i > 4) {
                Assert.assertTrue(error < 1.01 * FastMath.abs(previousValueError));
            }
            previousValueError = error;

            double timeError = handler.getMaximalTimeError();
            if (i > 4) {
                Assert.assertTrue(timeError <= FastMath.abs(previousTimeError));
            }
            previousTimeError = timeError;

            integ.clearEventHandlers();
            Assert.assertEquals(0, integ.getEventHandlers().size());
        }

    }

}


```

### 15

[2383, 'src/test/java', 'org.apache.commons.math3.ode.nonstiff', 'ClassicalRungeKuttaStepInterpolatorTest', 'serialization', 51, 96]

[2383, 'src/test/java', 'org.apache.commons.math3.ode.nonstiff', 'ThreeEighthesStepInterpolatorTest', 'serialization', 51, 96]

```java

@Test 
public void serialization() throws IOException, ClassNotFoundException, DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {

	TestProblem3 pb = new TestProblem3(0.9);
	double step = (pb.getFinalTime() - pb.getInitialTime()) * 0.0003;
	ClassicalRungeKuttaIntegrator integ = new ClassicalRungeKuttaIntegrator(step);
	integ.addStepHandler(new ContinuousOutputModel());
	integ.integrate(pb,
                pb.getInitialTime(), pb.getInitialState(),
                pb.getFinalTime(), new double[pb.getDimension()]);

	ByteArrayOutputStream bos = new ByteArrayOutputStream();
	ObjectOutputStream    oos = new ObjectOutputStream(bos);
	for (StepHandler handler : integ.getStepHandlers()) {
    		oos.writeObject(handler);
	}

	Assert.assertTrue(bos.size () > 880000);
	Assert.assertTrue(bos.size () < 900000);

	ByteArrayInputStream  bis = new ByteArrayInputStream(bos.toByteArray());
	ObjectInputStream     ois = new ObjectInputStream(bis);
	ContinuousOutputModel cm  = (ContinuousOutputModel) ois.readObject();

	Random random = new Random(347588535632l);
	double maxError = 0.0;
	for (int i = 0; i < 1000; ++i) {
  		double r = random.nextDouble();
  		double time = r * pb.getInitialTime() + (1.0 - r) * pb.getFinalTime();
  		cm.setInterpolatedTime(time);
  		double[] interpolatedY = cm.getInterpolatedState ();
  		double[] theoreticalY  = pb.computeTheoreticalState(time);
  		double dx = interpolatedY[0] - theoreticalY[0];
  		double dy = interpolatedY[1] - theoreticalY[1];
 		double error = dx * dx + dy * dy;
  		if (error > maxError) {
    			maxError = error;
  		}
	}

	Assert.assertTrue(maxError > 0.005);
}

@Test 
public void serialization() throws IOException, ClassNotFoundException, DimensionMismatchException, NumberIsTooSmallException, MaxCountExceededException, NoBracketingException {

	TestProblem3 pb = new TestProblem3(0.9);
	double step = (pb.getFinalTime() - pb.getInitialTime()) * 0.0003;
	ThreeEighthesIntegrator integ = new ThreeEighthesIntegrator(step);
	integ.addStepHandler(new ContinuousOutputModel());
	integ.integrate(pb,
                pb.getInitialTime(), pb.getInitialState(),
                pb.getFinalTime(), new double[pb.getDimension()]);

	ByteArrayOutputStream bos = new ByteArrayOutputStream();
	ObjectOutputStream    oos = new ObjectOutputStream(bos);
	for (StepHandler handler : integ.getStepHandlers()) {
    		oos.writeObject(handler);
	}

	Assert.assertTrue(bos.size () > 880000);
	Assert.assertTrue(bos.size () < 900000);

	ByteArrayInputStream  bis = new ByteArrayInputStream(bos.toByteArray());
	ObjectInputStream     ois = new ObjectInputStream(bis);
	ContinuousOutputModel cm  = (ContinuousOutputModel) ois.readObject();

	Random random = new Random(347588535632l);
	double maxError = 0.0;
	for (int i = 0; i < 1000; ++i) {
 		double r = random.nextDouble();
  		double time = r * pb.getInitialTime() + (1.0 - r) * pb.getFinalTime();
  		cm.setInterpolatedTime(time);
  		double[] interpolatedY = cm.getInterpolatedState ();
  		double[] theoreticalY  = pb.computeTheoreticalState(time);
  		double dx = interpolatedY[0] - theoreticalY[0];
  		double dy = interpolatedY[1] - theoreticalY[1];
 		double error = dx * dx + dy * dy;
  		if (error > maxError) {
    			maxError = error;
  		}
	}

	Assert.assertTrue(maxError > 0.005);
}

```

### 16

<span style="color:red">This clone pair with simple covariance test may be a good candidate for random input testing.</span>

[2540, 'src/test/java', 'org.apache.commons.math3.stat.correlation', 'StorelessCovarianceTest', 'testLonglySimpleVar', 116, 124]

[2540, 'src/test/java', 'org.apache.commons.math3.stat.correlation', 'StorelessCovarianceTest', 'testLonglySimpleCov', 126, 134]

```java

@Test
public void testLonglySimpleVar(){
    double rCov = 12333921.73333333246;
    StorelessBivariateCovariance cov = new StorelessBivariateCovariance();
    for(int i=0;i<longleyDataSimple.length;i++){
        cov.increment(longleyDataSimple[i][0],longleyDataSimple[i][0]);
    }
    TestUtils.assertEquals("simple covariance test", rCov, cov.getResult(), 10E-7);
}

@Test
public void testLonglySimpleCov(){
    double rCov = 36796.660000;
    StorelessBivariateCovariance cov = new StorelessBivariateCovariance();
    for(int i=0;i<longleyDataSimple.length;i++){
        cov.increment(longleyDataSimple[i][0], longleyDataSimple[i][1]);
    }
    TestUtils.assertEquals("simple covariance test", rCov, cov.getResult(), 10E-7);
}

```

### commons_io_2.5

### 17

<span style="color:red"> This clone pair is a good candidate for random testing (feedback-directed parameter search), from the coverage and possible semantic analysis perspective. </span>

[1581, 'src/test/java', 'org.apache.commons.io', 'FileUtilsTestCase', 'testMoveFileToDirectory_Errors', 2672, 2724]

[1581, 'src/test/java', 'org.apache.commons.io', 'FileUtilsTestCase', 'testMoveDirectoryToDirectory_Errors', 2889, 2941]

```java

@Test
public void testMoveFileToDirectory_Errors() throws Exception {
    try {
        FileUtils.moveFileToDirectory(null, new File("foo"), true);
        fail("Expected NullPointerException when source is null");
    } catch (final NullPointerException e) {
        // expected
    }
    try {
        FileUtils.moveFileToDirectory(new File("foo"), null, true);
        fail("Expected NullPointerException when destination is null");
    } catch (final NullPointerException e) {
        // expected
    }
    final File testFile1 = new File(getTestDirectory(), "testMoveFileFile1");
    final File testFile2 = new File(getTestDirectory(), "testMoveFileFile2");
    if (!testFile1.getParentFile().exists()) {
        throw new IOException("Cannot create file " + testFile1
                + " as the parent directory does not exist");
    }
    final BufferedOutputStream output1 =
            new BufferedOutputStream(new FileOutputStream(testFile1));
    try {
        TestUtils.generateTestData(output1, (long) 0);
    } finally {
        IOUtils.closeQuietly(output1);
    }
    if (!testFile2.getParentFile().exists()) {
        throw new IOException("Cannot create file " + testFile2
                + " as the parent directory does not exist");
    }
    final BufferedOutputStream output =
            new BufferedOutputStream(new FileOutputStream(testFile2));
    try {
        TestUtils.generateTestData(output, (long) 0);
    } finally {
        IOUtils.closeQuietly(output);
    }
    try {
        FileUtils.moveFileToDirectory(testFile1, testFile2, true);
        fail("Expected IOException when dest not a directory");
    } catch (final IOException e) {
        // expected
    }

    final File nonexistant = new File(getTestDirectory(), "testMoveFileNonExistant");
    try {
        FileUtils.moveFileToDirectory(testFile1, nonexistant, false);
        fail("Expected IOException when dest does not exist and create=false");
    } catch (final IOException e) {
        // expected
    }
}

@Test
public void testMoveDirectoryToDirectory_Errors() throws Exception {
    try {
        FileUtils.moveDirectoryToDirectory(null, new File("foo"), true);
        fail("Expected NullPointerException when source is null");
    } catch (final NullPointerException e) {
        // expected
    }
    try {
        FileUtils.moveDirectoryToDirectory(new File("foo"), null, true);
        fail("Expected NullPointerException when destination is null");
    } catch (final NullPointerException e) {
        // expected
    }
    final File testFile1 = new File(getTestDirectory(), "testMoveFileFile1");
    final File testFile2 = new File(getTestDirectory(), "testMoveFileFile2");
    if (!testFile1.getParentFile().exists()) {
        throw new IOException("Cannot create file " + testFile1
                + " as the parent directory does not exist");
    }
    final BufferedOutputStream output1 =
            new BufferedOutputStream(new FileOutputStream(testFile1));
    try {
        TestUtils.generateTestData(output1, (long) 0);
    } finally {
        IOUtils.closeQuietly(output1);
    }
    if (!testFile2.getParentFile().exists()) {
        throw new IOException("Cannot create file " + testFile2
                + " as the parent directory does not exist");
    }
    final BufferedOutputStream output =
            new BufferedOutputStream(new FileOutputStream(testFile2));
    try {
        TestUtils.generateTestData(output, (long) 0);
    } finally {
        IOUtils.closeQuietly(output);
    }
    try {
        FileUtils.moveDirectoryToDirectory(testFile1, testFile2, true);
        fail("Expected IOException when dest not a directory");
    } catch (final IOException e) {
        // expected
    }

    final File nonexistant = new File(getTestDirectory(), "testMoveFileNonExistant");
    try {
        FileUtils.moveDirectoryToDirectory(testFile1, nonexistant, false);
        fail("Expected IOException when dest does not exist and create=false");
    } catch (final IOException e) {
        // expected
    }
}

```

### 18

<span style="color:red"> Random inputs testing may help finding bugs for full path.  </span>

[1308, 'src/test/java', 'org.apache.commons.io', 'FilenameUtilsTestCase', 'testGetFullPath', 745, 778]

[1308, 'src/test/java', 'org.apache.commons.io', 'FilenameUtilsTestCase', 'testGetFullPathNoEndSeparator', 780, 813]

```java

@Test
public void testGetFullPath() {
    assertEquals(null, FilenameUtils.getFullPath(null));
    assertEquals("", FilenameUtils.getFullPath("noseperator.inthispath"));
    assertEquals("a/b/", FilenameUtils.getFullPath("a/b/c.txt"));
    assertEquals("a/b/", FilenameUtils.getFullPath("a/b/c"));
    assertEquals("a/b/c/", FilenameUtils.getFullPath("a/b/c/"));
    assertEquals("a\\b\\", FilenameUtils.getFullPath("a\\b\\c"));

    assertEquals(null, FilenameUtils.getFullPath(":"));
    assertEquals(null, FilenameUtils.getFullPath("1:/a/b/c.txt"));
    assertEquals(null, FilenameUtils.getFullPath("1:"));
    assertEquals(null, FilenameUtils.getFullPath("1:a"));
    assertEquals(null, FilenameUtils.getFullPath("///a/b/c.txt"));
    assertEquals(null, FilenameUtils.getFullPath("//a"));

    assertEquals("", FilenameUtils.getFullPath(""));
    assertEquals("C:", FilenameUtils.getFullPath("C:"));
    assertEquals("C:/", FilenameUtils.getFullPath("C:/"));
    assertEquals("//server/", FilenameUtils.getFullPath("//server/"));
    assertEquals("~/", FilenameUtils.getFullPath("~"));
    assertEquals("~/", FilenameUtils.getFullPath("~/"));
    assertEquals("~user/", FilenameUtils.getFullPath("~user"));
    assertEquals("~user/", FilenameUtils.getFullPath("~user/"));

    assertEquals("a/b/", FilenameUtils.getFullPath("a/b/c.txt"));
    assertEquals("/a/b/", FilenameUtils.getFullPath("/a/b/c.txt"));
    assertEquals("C:", FilenameUtils.getFullPath("C:a"));
    assertEquals("C:a/b/", FilenameUtils.getFullPath("C:a/b/c.txt"));
    assertEquals("C:/a/b/", FilenameUtils.getFullPath("C:/a/b/c.txt"));
    assertEquals("//server/a/b/", FilenameUtils.getFullPath("//server/a/b/c.txt"));
    assertEquals("~/a/b/", FilenameUtils.getFullPath("~/a/b/c.txt"));
    assertEquals("~user/a/b/", FilenameUtils.getFullPath("~user/a/b/c.txt"));
}

@Test
public void testGetFullPathNoEndSeparator() {
    assertEquals(null, FilenameUtils.getFullPathNoEndSeparator(null));
    assertEquals("", FilenameUtils.getFullPathNoEndSeparator("noseperator.inthispath"));
    assertEquals("a/b", FilenameUtils.getFullPathNoEndSeparator("a/b/c.txt"));
    assertEquals("a/b", FilenameUtils.getFullPathNoEndSeparator("a/b/c"));
    assertEquals("a/b/c", FilenameUtils.getFullPathNoEndSeparator("a/b/c/"));
    assertEquals("a\\b", FilenameUtils.getFullPathNoEndSeparator("a\\b\\c"));

    assertEquals(null, FilenameUtils.getFullPathNoEndSeparator(":"));
    assertEquals(null, FilenameUtils.getFullPathNoEndSeparator("1:/a/b/c.txt"));
    assertEquals(null, FilenameUtils.getFullPathNoEndSeparator("1:"));
    assertEquals(null, FilenameUtils.getFullPathNoEndSeparator("1:a"));
    assertEquals(null, FilenameUtils.getFullPathNoEndSeparator("///a/b/c.txt"));
    assertEquals(null, FilenameUtils.getFullPathNoEndSeparator("//a"));

    assertEquals("", FilenameUtils.getFullPathNoEndSeparator(""));
    assertEquals("C:", FilenameUtils.getFullPathNoEndSeparator("C:"));
    assertEquals("C:/", FilenameUtils.getFullPathNoEndSeparator("C:/"));
    assertEquals("//server/", FilenameUtils.getFullPathNoEndSeparator("//server/"));
    assertEquals("~", FilenameUtils.getFullPathNoEndSeparator("~"));
    assertEquals("~/", FilenameUtils.getFullPathNoEndSeparator("~/"));
    assertEquals("~user", FilenameUtils.getFullPathNoEndSeparator("~user"));
    assertEquals("~user/", FilenameUtils.getFullPathNoEndSeparator("~user/"));

    assertEquals("a/b", FilenameUtils.getFullPathNoEndSeparator("a/b/c.txt"));
    assertEquals("/a/b", FilenameUtils.getFullPathNoEndSeparator("/a/b/c.txt"));
    assertEquals("C:", FilenameUtils.getFullPathNoEndSeparator("C:a"));
    assertEquals("C:a/b", FilenameUtils.getFullPathNoEndSeparator("C:a/b/c.txt"));
    assertEquals("C:/a/b", FilenameUtils.getFullPathNoEndSeparator("C:/a/b/c.txt"));
    assertEquals("//server/a/b", FilenameUtils.getFullPathNoEndSeparator("//server/a/b/c.txt"));
    assertEquals("~/a/b", FilenameUtils.getFullPathNoEndSeparator("~/a/b/c.txt"));
    assertEquals("~user/a/b", FilenameUtils.getFullPathNoEndSeparator("~user/a/b/c.txt"));
}

```

### 19

[1898, 'src/test/java', 'org.apache.commons.io', 'FilenameUtilsTestCase', 'testGetExtension', 873, 888]

[1898, 'src/test/java', 'org.apache.commons.io', 'FilenameUtilsTestCase', 'testRemoveExtension', 890, 905]

```java

@Test
public void testGetExtension() {
    assertEquals(null, FilenameUtils.getExtension(null));
    assertEquals("ext", FilenameUtils.getExtension("file.ext"));
    assertEquals("", FilenameUtils.getExtension("README"));
    assertEquals("com", FilenameUtils.getExtension("domain.dot.com"));
    assertEquals("jpeg", FilenameUtils.getExtension("image.jpeg"));
    assertEquals("", FilenameUtils.getExtension("a.b/c"));
    assertEquals("txt", FilenameUtils.getExtension("a.b/c.txt"));
    assertEquals("", FilenameUtils.getExtension("a/b/c"));
    assertEquals("", FilenameUtils.getExtension("a.b\\c"));
    assertEquals("txt", FilenameUtils.getExtension("a.b\\c.txt"));
    assertEquals("", FilenameUtils.getExtension("a\\b\\c"));
    assertEquals("", FilenameUtils.getExtension("C:\\temp\\foo.bar\\README"));
    assertEquals("ext", FilenameUtils.getExtension("../filename.ext"));
}

@Test
public void testRemoveExtension() {
    assertEquals(null, FilenameUtils.removeExtension(null));
    assertEquals("file", FilenameUtils.removeExtension("file.ext"));
    assertEquals("README", FilenameUtils.removeExtension("README"));
    assertEquals("domain.dot", FilenameUtils.removeExtension("domain.dot.com"));
    assertEquals("image", FilenameUtils.removeExtension("image.jpeg"));
    assertEquals("a.b/c", FilenameUtils.removeExtension("a.b/c"));
    assertEquals("a.b/c", FilenameUtils.removeExtension("a.b/c.txt"));
    assertEquals("a/b/c", FilenameUtils.removeExtension("a/b/c"));
    assertEquals("a.b\\c", FilenameUtils.removeExtension("a.b\\c"));
    assertEquals("a.b\\c", FilenameUtils.removeExtension("a.b\\c.txt"));
    assertEquals("a\\b\\c", FilenameUtils.removeExtension("a\\b\\c"));
    assertEquals("C:\\temp\\foo.bar\\README", FilenameUtils.removeExtension("C:\\temp\\foo.bar\\README"));
    assertEquals("../filename", FilenameUtils.removeExtension("../filename.ext"));
}

```

### solr_6.6.6

### 20

[544, 'src/test', 'org.apache.solr.util.hll', 'FullHLLTest', 'smallRangeSmokeTest', 31, 67]

[544, 'src/test', 'org.apache.solr.util.hll', 'SparseHLLTest', 'smallRangeSmokeTest', 112, 148]

```java

@Test
public void smallRangeSmokeTest() {
    final int log2m = 11;
    final int m = (1 << log2m);
    final int regwidth = 5;

    // only one register set
    {
        final HLL hll = new HLL(log2m, regwidth, 128/*explicitThreshold, arbitrary, unused*/, 256/*sparseThreshold, arbitrary, unused*/, HLLType.FULL);
        hll.addRaw(ProbabilisticTestUtil.constructHLLValue(log2m, 0/*ix*/, 1/*val*/));

        final long cardinality = hll.cardinality();

        // Trivially true that small correction conditions hold: one register
        // set implies zeroes exist, and estimator trivially smaller than 5m/2.
        // Small range correction: m * log(m/V)
        final long expected = (long)Math.ceil(m * Math.log((double)m / (m - 1)/*# of zeroes*/));
        assertEquals(cardinality, expected);
    }

    // all but one register set
    {
        final HLL hll = new HLL(log2m, regwidth, 128/*explicitThreshold, arbitrary, unused*/, 256/*sparseThreshold, arbitrary, unused*/, HLLType.FULL);
        for(int i=0; i<(m - 1); i++) {
            hll.addRaw(ProbabilisticTestUtil.constructHLLValue(log2m, i/*ix*/, 1/*val*/));
        }

        // Trivially true that small correction conditions hold: all but
        // one register set implies a zero exists, and estimator trivially
        // smaller than 5m/2 since it's alpha / ((m-1)/2)
        final long cardinality = hll.cardinality();

        // Small range correction: m * log(m/V)
        final long expected = (long)Math.ceil(m * Math.log((double)m / 1/*# of zeroes*/));
        assertEquals(cardinality, expected);
    }
}

@Test
public void smallRangeSmokeTest() {
    final int log2m = 11;
    final int m = (1 << log2m);
    final int regwidth = 5;

    // only one register set
    {
        final HLL hll = new HLL(log2m, regwidth, 128/*explicitThreshold, arbitrary, unused*/, 256/*sparseThreshold, arbitrary*/, HLLType.SPARSE);
        hll.addRaw(ProbabilisticTestUtil.constructHLLValue(log2m, 0, 1));

        final long cardinality = hll.cardinality();

        // Trivially true that small correction conditions hold: one register
        // set implies zeroes exist, and estimator trivially smaller than 5m/2.
        // Small range correction: m * log(m/V)
        final long expected = (long)Math.ceil(m * Math.log((double)m / (m - 1)/*# of zeroes*/));
        assertEquals(cardinality, expected);
    }

    // all but one register set
    {
        final HLL hll = new HLL(log2m, regwidth, 128/*explicitThreshold, arbitrary, unused*/, 256/*sparseThreshold, arbitrary*/, HLLType.SPARSE);
        for(int i=0; i<(m - 1); i++) {
            hll.addRaw(ProbabilisticTestUtil.constructHLLValue(log2m, i, 1));
        }

        // Trivially true that small correction conditions hold: all but
        // one register set implies a zero exists, and estimator trivially
        // smaller than 5m/2 since it's alpha / ((m-1)/2)
        final long cardinality = hll.cardinality();

        // Small range correction: m * log(m/V)
        final long expected = (long)Math.ceil(m * Math.log((double)m / 1/*# of zeroes*/));
        assertEquals(cardinality, expected);
    }
}

```

### 21

[586, 'src/test', 'org.apache.solr.update.processor', 'ClassificationUpdateProcessorTest', 'knnMonoClass_boostFields_shouldAssignCorrectClass', 125, 145]

[586, 'src/test', 'org.apache.solr.update.processor', 'ClassificationUpdateProcessorTest', 'bayesMonoClass_boostFields_shouldAssignCorrectClass', 189, 209]


```java

  @Test
  public void knnMonoClass_boostFields_shouldAssignCorrectClass() throws Exception {
    UpdateRequestProcessor mockProcessor=mock(UpdateRequestProcessor.class);
    prepareTrainedIndexMonoClass();

    AddUpdateCommand update=new AddUpdateCommand(req());
    SolrInputDocument unseenDocument1 = sdoc(ID, "10",
        TITLE, "word4 word4 word4",
        CONTENT, "word2 word2 ",
        AUTHOR, "unseenAuthor");
    update.solrDoc=unseenDocument1;

    ClassificationUpdateProcessorParams params = initParams(ClassificationUpdateProcessorFactory.Algorithm.KNN);
    params.setInputFieldNames(new String[]{TITLE + "^1.5", CONTENT + "^0.5", AUTHOR + "^2.5"});

    updateProcessorToTest=new ClassificationUpdateProcessor(params,mockProcessor,reader,req().getSchema());

    updateProcessorToTest.processAdd(update);

    assertThat(unseenDocument1.getFieldValue(TRAINING_CLASS),is("class2"));
  }

  @Test
  public void bayesMonoClass_boostFields_shouldAssignCorrectClass() throws Exception {
    UpdateRequestProcessor mockProcessor=mock(UpdateRequestProcessor.class);
    prepareTrainedIndexMonoClass();

    AddUpdateCommand update=new AddUpdateCommand(req());
    SolrInputDocument unseenDocument1 = sdoc(ID, "10",
        TITLE, "word4 word4 word4",
        CONTENT, "word2 word2 ",
        AUTHOR, "unseenAuthor");
    update.solrDoc=unseenDocument1;

    ClassificationUpdateProcessorParams params= initParams(ClassificationUpdateProcessorFactory.Algorithm.BAYES);
    params.setInputFieldNames(new String[]{TITLE+"^1.5",CONTENT+"^0.5",AUTHOR+"^2.5"});

    updateProcessorToTest=new ClassificationUpdateProcessor(params,mockProcessor,reader,req().getSchema());

    updateProcessorToTest.processAdd(update);

    assertThat(unseenDocument1.getFieldValue(TRAINING_CLASS),is("class2"));
  }

```

[612, 'src/test', 'org.apache.solr.update.processor', 'ClassificationUpdateProcessorTest', 'knnMultiClass_boostFieldsMaxOutputClasses2_shouldAssignMax2Classes', 282, 306]

[612, 'src/test', 'org.apache.solr.update.processor', 'ClassificationUpdateProcessorTest', 'bayesMultiClass_boostFieldsMaxOutputClasses2_shouldAssignMax2Classes', 308, 332]

```java

  @Test
  public void knnMultiClass_boostFieldsMaxOutputClasses2_shouldAssignMax2Classes() throws Exception {
    UpdateRequestProcessor mockProcessor=mock(UpdateRequestProcessor.class);
    prepareTrainedIndexMultiClass();

    AddUpdateCommand update=new AddUpdateCommand(req());
    SolrInputDocument unseenDocument1 = sdoc(ID, "10",
        TITLE, "word4 word4 word4",
        CONTENT, "word2 word2 ",
        AUTHOR, "unseenAuthor");
    update.solrDoc=unseenDocument1;

    ClassificationUpdateProcessorParams params= initParams(ClassificationUpdateProcessorFactory.Algorithm.KNN);
    params.setInputFieldNames(new String[]{TITLE+"^1.5",CONTENT+"^0.5",AUTHOR+"^2.5"});
    params.setMaxPredictedClasses(2);

    updateProcessorToTest=new ClassificationUpdateProcessor(params,mockProcessor,reader,req().getSchema());

    updateProcessorToTest.processAdd(update);

    ArrayList<Object> assignedClasses = (ArrayList)unseenDocument1.getFieldValues(TRAINING_CLASS);
    assertThat(assignedClasses.size(),is(2));
    assertThat(assignedClasses.get(0),is("class4"));
    assertThat(assignedClasses.get(1),is("class6"));
  }

  @Test
  public void bayesMultiClass_boostFieldsMaxOutputClasses2_shouldAssignMax2Classes() throws Exception {
    UpdateRequestProcessor mockProcessor=mock(UpdateRequestProcessor.class);
    prepareTrainedIndexMultiClass();

    AddUpdateCommand update=new AddUpdateCommand(req());
    SolrInputDocument unseenDocument1 = sdoc(ID, "10",
        TITLE, "word4 word4 word4",
        CONTENT, "word2 word2 ",
        AUTHOR, "unseenAuthor");
    update.solrDoc=unseenDocument1;

    ClassificationUpdateProcessorParams params= initParams(ClassificationUpdateProcessorFactory.Algorithm.BAYES);
    params.setInputFieldNames(new String[]{TITLE+"^1.5",CONTENT+"^0.5",AUTHOR+"^2.5"});
    params.setMaxPredictedClasses(2);

    updateProcessorToTest=new ClassificationUpdateProcessor(params,mockProcessor,reader,req().getSchema());

    updateProcessorToTest.processAdd(update);

    ArrayList<Object> assignedClasses = (ArrayList)unseenDocument1.getFieldValues(TRAINING_CLASS);
    assertThat(assignedClasses.size(),is(2));
    assertThat(assignedClasses.get(0),is("class4"));
    assertThat(assignedClasses.get(1),is("class6"));
  }

```

[1112, 'src/test', 'org.apache.solr.update.processor', 'ClassificationUpdateProcessorTest', 'knnMultiClass_maxOutputClasses2_shouldAssignMax2Classes', 234, 256]

[1112, 'src/test', 'org.apache.solr.update.processor', 'ClassificationUpdateProcessorTest', 'bayesMultiClass_maxOutputClasses2_shouldAssignMax2Classes', 258, 280]

```java

  @Test
  public void knnMultiClass_maxOutputClasses2_shouldAssignMax2Classes() throws Exception {
    UpdateRequestProcessor mockProcessor=mock(UpdateRequestProcessor.class);
    prepareTrainedIndexMultiClass();

    AddUpdateCommand update=new AddUpdateCommand(req());
    SolrInputDocument unseenDocument1 = sdoc(ID, "10",
        TITLE, "word1 word1 word1",
        CONTENT, "word2 word2 ",
        AUTHOR, "unseenAuthor");
    update.solrDoc=unseenDocument1;

    ClassificationUpdateProcessorParams params= initParams(ClassificationUpdateProcessorFactory.Algorithm.KNN);
    params.setMaxPredictedClasses(2);

    updateProcessorToTest=new ClassificationUpdateProcessor(params,mockProcessor,reader,req().getSchema());
    updateProcessorToTest.processAdd(update);

    ArrayList<Object> assignedClasses = (ArrayList)unseenDocument1.getFieldValues(TRAINING_CLASS);
    assertThat(assignedClasses.size(),is(2));
    assertThat(assignedClasses.get(0),is("class2"));
    assertThat(assignedClasses.get(1),is("class1"));
  }

  @Test
  public void bayesMultiClass_maxOutputClasses2_shouldAssignMax2Classes() throws Exception {
    UpdateRequestProcessor mockProcessor=mock(UpdateRequestProcessor.class);
    prepareTrainedIndexMultiClass();

    AddUpdateCommand update=new AddUpdateCommand(req());
    SolrInputDocument unseenDocument1 = sdoc(ID, "10",
        TITLE, "word1 word1 word1",
        CONTENT, "word2 word2 ",
        AUTHOR, "unseenAuthor");
    update.solrDoc=unseenDocument1;

    ClassificationUpdateProcessorParams params= initParams(ClassificationUpdateProcessorFactory.Algorithm.BAYES);
    params.setMaxPredictedClasses(2);

    updateProcessorToTest=new ClassificationUpdateProcessor(params,mockProcessor,reader,req().getSchema());
    updateProcessorToTest.processAdd(update);

    ArrayList<Object> assignedClasses = (ArrayList)unseenDocument1.getFieldValues(TRAINING_CLASS);
    assertThat(assignedClasses.size(),is(2));
    assertThat(assignedClasses.get(0),is("class2"));
    assertThat(assignedClasses.get(1),is("class1"));
  }

```

[1767, 'src/test', 'org.apache.solr.update.processor', 'ClassificationUpdateProcessorTest', 'knnMonoClass_sampleParams_shouldAssignCorrectClass', 105, 123]

[1767, 'src/test', 'org.apache.solr.update.processor', 'ClassificationUpdateProcessorTest', 'bayesMonoClass_sampleParams_shouldAssignCorrectClass', 147, 165]

```java

  @Test
  public void knnMonoClass_sampleParams_shouldAssignCorrectClass() throws Exception {
    UpdateRequestProcessor mockProcessor=mock(UpdateRequestProcessor.class);
    prepareTrainedIndexMonoClass();

    AddUpdateCommand update=new AddUpdateCommand(req());
    SolrInputDocument unseenDocument1 = sdoc(ID, "10",
        TITLE, "word4 word4 word4",
        CONTENT, "word2 word2 ",
        AUTHOR, "unseenAuthor");
    update.solrDoc=unseenDocument1;

    ClassificationUpdateProcessorParams params = initParams(ClassificationUpdateProcessorFactory.Algorithm.KNN);

    updateProcessorToTest=new ClassificationUpdateProcessor(params,mockProcessor,reader,req().getSchema());
    updateProcessorToTest.processAdd(update);

    assertThat(unseenDocument1.getFieldValue(TRAINING_CLASS),is("class1"));
  }

  @Test
  public void bayesMonoClass_sampleParams_shouldAssignCorrectClass() throws Exception {
    UpdateRequestProcessor mockProcessor=mock(UpdateRequestProcessor.class);
    prepareTrainedIndexMonoClass();

    AddUpdateCommand update=new AddUpdateCommand(req());
    SolrInputDocument unseenDocument1 = sdoc(ID, "10",
        TITLE, "word4 word4 word4",
        CONTENT, "word2 word2 ",
        AUTHOR, "unseenAuthor");
    update.solrDoc=unseenDocument1;

    ClassificationUpdateProcessorParams params= initParams(ClassificationUpdateProcessorFactory.Algorithm.BAYES);

    updateProcessorToTest=new ClassificationUpdateProcessor(params,mockProcessor,reader,req().getSchema());
    updateProcessorToTest.processAdd(update);

    assertThat(unseenDocument1.getFieldValue(TRAINING_CLASS),is("class1"));
  }

```

### 22

[869, 'src/test', 'org.apache.solr.schema', 'DocValuesMultiTest', 'testFloatDocValuesMatch', 182, 217]

[869, 'src/test', 'org.apache.solr.schema', 'DocValuesMultiTest', 'testDoubleDocValuesMatch', 222, 257]

```java

  @Test
  public void testFloatDocValuesMatch() throws Exception {
    assertU(adoc("id", "1", "floatdv", "2"));
    assertU(adoc("id", "2", "floatdv", "-5"));
    assertU(adoc("id", "3", "floatdv", "3.0", "floatdv", "-1.3", "floatdv", "2.2"));
    assertU(adoc("id", "4", "floatdv", "3"));
    assertU(adoc("id", "5", "floatdv", "-0.5"));
    assertU(commit());
    
    // float: termquery
    assertQ(req("q", "floatdv:3", "sort", "id asc"),
        "//*[@numFound='2']",
        "//result/doc[1]/str[@name='id'][.=3]",
        "//result/doc[2]/str[@name='id'][.=4]"
    );
    
    // float: rangequery
    assertQ(req("q", "floatdv:[-1 TO 2.5]", "sort", "id asc"),
            "//*[@numFound='3']",
            "//result/doc[1]/str[@name='id'][.=1]",
            "//result/doc[2]/str[@name='id'][.=3]",
            "//result/doc[3]/str[@name='id'][.=5]"
    );

    // (neg) float: rangequery
    assertQ(req("q", "floatdv:[-6 TO -4]", "sort", "id asc"),
            "//*[@numFound='1']",
            "//result/doc[1]/str[@name='id'][.=2]"
            );
    
    // (neg) float: termquery
    assertQ(req("q", "floatdv:\"-5\"", "sort", "id asc"),
            "//*[@numFound='1']",
            "//result/doc[1]/str[@name='id'][.=2]"
            );
  }

  @Test
  public void testDoubleDocValuesMatch() throws Exception {
    assertU(adoc("id", "1", "doubledv", "2"));
    assertU(adoc("id", "2", "doubledv", "-5"));
    assertU(adoc("id", "3", "doubledv", "3.0", "doubledv", "-1.3", "doubledv", "2.2"));
    assertU(adoc("id", "4", "doubledv", "3"));
    assertU(adoc("id", "5", "doubledv", "-0.5"));
    assertU(commit());
    
    // double: termquery
    assertQ(req("q", "doubledv:3", "sort", "id asc"),
        "//*[@numFound='2']",
        "//result/doc[1]/str[@name='id'][.=3]",
        "//result/doc[2]/str[@name='id'][.=4]"
    );
    
    // double: rangequery
    assertQ(req("q", "doubledv:[-1 TO 2.5]", "sort", "id asc"),
            "//*[@numFound='3']",
            "//result/doc[1]/str[@name='id'][.=1]",
            "//result/doc[2]/str[@name='id'][.=3]",
            "//result/doc[3]/str[@name='id'][.=5]"
    );

    // (neg) double: rangequery
    assertQ(req("q", "doubledv:[-6 TO -4]", "sort", "id asc"),
            "//*[@numFound='1']",
            "//result/doc[1]/str[@name='id'][.=2]"
            );
    
    // (neg) double: termquery
    assertQ(req("q", "doubledv:\"-5\"", "sort", "id asc"),
            "//*[@numFound='1']",
            "//result/doc[1]/str[@name='id'][.=2]"
            );
  }

```

### 23

[955, 'src/test', 'org.apache.solr.handler.component', 'QueryElevationComponentTest', 'testFieldType', 78, 109]

[955, 'src/test', 'org.apache.solr.handler.component', 'QueryElevationComponentTest', 'testTrieFieldType', 313, 344]

```java

  @Test
  public void testFieldType() throws Exception {
    try {
      init("schema11.xml");
      clearIndex();
      assertU(commit());
      assertU(adoc("id", "1", "text", "XXXX XXXX", "str_s", "a"));
      assertU(adoc("id", "2", "text", "YYYY", "str_s", "b"));
      assertU(adoc("id", "3", "text", "ZZZZ", "str_s", "c"));

      assertU(adoc("id", "4", "text", "XXXX XXXX", "str_s", "x"));
      assertU(adoc("id", "5", "text", "YYYY YYYY", "str_s", "y"));
      assertU(adoc("id", "6", "text", "XXXX XXXX", "str_s", "z"));
      assertU(adoc("id", "7", "text", "AAAA", "str_s", "a"));
      assertU(adoc("id", "8", "text", "AAAA", "str_s", "a"));
      assertU(adoc("id", "9", "text", "AAAA AAAA", "str_s", "a"));
      assertU(commit());

      assertQ("", req(CommonParams.Q, "AAAA", CommonParams.QT, "/elevate",
          CommonParams.FL, "id, score, [elevated]")
          , "//*[@numFound='3']"
          , "//result/doc[1]/float[@name='id'][.='7.0']"
          , "//result/doc[2]/float[@name='id'][.='8.0']"
          , "//result/doc[3]/float[@name='id'][.='9.0']",
          "//result/doc[1]/bool[@name='[elevated]'][.='true']",
          "//result/doc[2]/bool[@name='[elevated]'][.='false']",
          "//result/doc[3]/bool[@name='[elevated]'][.='false']"
      );
    } finally {
      delete();
    }
  }

  @Test
  public void testTrieFieldType() throws Exception {
    try {
      init("schema.xml");
      clearIndex();
      assertU(commit());
      assertU(adoc("id", "1", "text", "XXXX XXXX",           "str_s", "a" ));
      assertU(adoc("id", "2", "text", "YYYY",      "str_s", "b" ));
      assertU(adoc("id", "3", "text", "ZZZZ", "str_s", "c" ));

      assertU(adoc("id", "4", "text", "XXXX XXXX",                 "str_s", "x" ));
      assertU(adoc("id", "5", "text", "YYYY YYYY",         "str_s", "y" ));
      assertU(adoc("id", "6", "text", "XXXX XXXX", "str_s", "z" ));
      assertU(adoc("id", "7", "text", "AAAA", "str_s", "a" ));
      assertU(adoc("id", "8", "text", "AAAA", "str_s", "a" ));
      assertU(adoc("id", "9", "text", "AAAA AAAA", "str_s", "a" ));
      assertU(commit());

      assertQ("", req(CommonParams.Q, "AAAA", CommonParams.QT, "/elevate",
          CommonParams.FL, "id, score, [elevated]")
              ,"//*[@numFound='3']"
              ,"//result/doc[1]/int[@name='id'][.='7']"
              ,"//result/doc[2]/int[@name='id'][.='8']"
              ,"//result/doc[3]/int[@name='id'][.='9']",
              "//result/doc[1]/bool[@name='[elevated]'][.='true']",
              "//result/doc[2]/bool[@name='[elevated]'][.='false']",
              "//result/doc[3]/bool[@name='[elevated]'][.='false']"
              );
    } finally{
      delete();
    }
  }


```

### 24

[1310, 'src/test', 'org.apache.solr.cloud.rule', 'ImplicitSnitchTest', 'testGetTags_withAllIPv4RequestedTags_with_omitted_zeros_returns_four_tags', 54, 66]

[1310, 'src/test', 'org.apache.solr.cloud.rule', 'ImplicitSnitchTest', 'testGetTags_withAllIPv4RequestedTags_returns_four_tags', 69, 81]

```java

  @Test
  public void testGetTags_withAllIPv4RequestedTags_with_omitted_zeros_returns_four_tags() throws Exception {
    String node = "5:8983_solr";

    snitch.getTags(node, Sets.newHashSet(IP_1, IP_2, IP_3, IP_4), context);

    Map<String, Object> tags = context.getTags();
    assertThat(tags.entrySet().size(), is(4));
    assertThat(tags.get(IP_1), is("5"));
    assertThat(tags.get(IP_2), is("0"));
    assertThat(tags.get(IP_3), is("0"));
    assertThat(tags.get(IP_4), is("0"));
  }

  @Test
  public void testGetTags_withAllIPv4RequestedTags_returns_four_tags() throws Exception {
    String node = "192.168.1.2:8983_solr";

    snitch.getTags(node, Sets.newHashSet(IP_1, IP_2, IP_3, IP_4), context);

    Map<String, Object> tags = context.getTags();
    assertThat(tags.entrySet().size(), is(4));
    assertThat(tags.get(IP_1), is("2"));
    assertThat(tags.get(IP_2), is("1"));
    assertThat(tags.get(IP_3), is("168"));
    assertThat(tags.get(IP_4), is("192"));
  }

```

### 25

[1485, 'src/test', 'org.apache.solr.rest.schema', 'TestDynamicFieldResource', 'testJsonGetDynamicField', 51, 69]

[1485, 'src/test', 'org.apache.solr.rest.schema', 'TestFieldTypeResource', 'testJsonGetFieldType', 54, 72]


```java

  @Test
  public void testJsonGetDynamicField() throws Exception {
    assertJQ("/schema/dynamicfields/*_i?indent=on&showDefaults=on",
             "/dynamicField/name=='*_i'",
             "/dynamicField/type=='int'",
             "/dynamicField/indexed==true",
             "/dynamicField/stored==true",
             "/dynamicField/docValues==false",
             "/dynamicField/termVectors==false",
             "/dynamicField/termPositions==false",
             "/dynamicField/termOffsets==false",
             "/dynamicField/omitNorms==true",
             "/dynamicField/omitTermFreqAndPositions==true",
             "/dynamicField/omitPositions==false",
             "/dynamicField/storeOffsetsWithPositions==false",
             "/dynamicField/multiValued==false",
             "/dynamicField/required==false",
             "/dynamicField/tokenized==false");
  }

  @Test
  public void testJsonGetFieldType() throws Exception {
    assertJQ("/schema/fieldtypes/float?indent=on&showDefaults=on",  // assertJQ will add "&wt=json"
             "/fieldType/name=='float'",
             "/fieldType/class=='solr.TrieFloatField'",
             "/fieldType/precisionStep=='0'",
             "/fieldType/indexed==true",
             "/fieldType/stored==true",
             "/fieldType/docValues==false",
             "/fieldType/termVectors==false",
             "/fieldType/termPositions==false",
             "/fieldType/termOffsets==false",
             "/fieldType/omitNorms==true",
             "/fieldType/omitTermFreqAndPositions==true",
             "/fieldType/omitPositions==false",
             "/fieldType/storeOffsetsWithPositions==false",
             "/fieldType/multiValued==false",
             "/fieldType/tokenized==false");
  }
  
```

### 26

[1610, 'src/test', 'org.apache.solr', 'TestTolerantSearch', 'testGetFieldsPhaseError', 112, 158]

[1610, 'src/test', 'org.apache.solr', 'TestTolerantSearch', 'testGetTopIdsPhaseError', 160, 207]


```java

  @SuppressWarnings("unchecked")
  public void testGetFieldsPhaseError() throws SolrServerException, IOException {
    BadResponseWriter.failOnGetFields = true;
    BadResponseWriter.failOnGetTopIds = false;
    SolrQuery query = new SolrQuery();
    query.setQuery("subject:batman OR subject:superman");
    query.addField("id");
    query.addField("subject");
    query.set("distrib", "true");
    query.set("shards", shard1 + "," + shard2);
    query.set(ShardParams.SHARDS_INFO, "true");
    query.set("debug", "true");
    query.set("stats", "true");
    query.set("stats.field", "id");
    query.set("mlt", "true");
    query.set("mlt.fl", "title");
    query.set("mlt.count", "1");
    query.set("mlt.mintf", "0");
    query.set("mlt.mindf", "0");
    query.setHighlight(true);
    query.addFacetField("id");
    query.setFacet(true);
    
    ignoreException("Dummy exception in BadResponseWriter");
    try {
      collection1.query(query);
      fail("Should get an exception");
    } catch (Exception e) {
      //expected
    }
    query.set(ShardParams.SHARDS_TOLERANT, "true");
    QueryResponse response = collection1.query(query);
    assertTrue(response.getResponseHeader().getBooleanArg(SolrQueryResponse.RESPONSE_HEADER_PARTIAL_RESULTS_KEY));
    NamedList<Object> shardsInfo = ((NamedList<Object>)response.getResponse().get(ShardParams.SHARDS_INFO));
    boolean foundError = false;
    for (int i = 0; i < shardsInfo.size(); i++) {
      if (shardsInfo.getName(i).contains("collection2")) {
        assertNotNull(((NamedList<Object>)shardsInfo.getVal(i)).get("error"));
        foundError = true;
        break;
      }
    }
    assertTrue(foundError);
    assertEquals(1, response.getResults().get(0).getFieldValue("id"));
    assertEquals("batman", response.getResults().get(0).getFirstValue("subject"));
    unIgnoreException("Dummy exception in BadResponseWriter");
  }

  @SuppressWarnings("unchecked")
  public void testGetTopIdsPhaseError() throws SolrServerException, IOException {
    BadResponseWriter.failOnGetTopIds = true;
    BadResponseWriter.failOnGetFields = false;
    SolrQuery query = new SolrQuery();
    query.setQuery("subject:batman OR subject:superman");
    query.addField("id");
    query.addField("subject");
    query.set("distrib", "true");
    query.set("shards", shard1 + "," + shard2);
    query.set(ShardParams.SHARDS_INFO, "true");
    query.set("debug", "true");
    query.set("stats", "true");
    query.set("stats.field", "id");
    query.set("mlt", "true");
    query.set("mlt.fl", "title");
    query.set("mlt.count", "1");
    query.set("mlt.mintf", "0");
    query.set("mlt.mindf", "0");
    query.setHighlight(true);
    query.addFacetField("id");
    query.setFacet(true);
    
    ignoreException("Dummy exception in BadResponseWriter");
    try {
      collection1.query(query);
      fail("Should get an exception");
    } catch (Exception e) {
      //expected
    }
    query.set(ShardParams.SHARDS_TOLERANT, "true");
    QueryResponse response = collection1.query(query);
    assertTrue(response.getResponseHeader().getBooleanArg(SolrQueryResponse.RESPONSE_HEADER_PARTIAL_RESULTS_KEY));
    NamedList<Object> shardsInfo = ((NamedList<Object>)response.getResponse().get(ShardParams.SHARDS_INFO));
    boolean foundError = false;
    for (int i = 0; i < shardsInfo.size(); i++) {
      if (shardsInfo.getName(i).contains("collection2")) {
        assertNotNull(((NamedList<Object>)shardsInfo.getVal(i)).get("error"));
        foundError = true;
        break;
      }
    }
    assertTrue(foundError);
    
    assertEquals(1, response.getResults().get(0).getFieldValue("id"));
    assertEquals("batman", response.getResults().get(0).getFirstValue("subject"));
    unIgnoreException("Dummy exception in BadResponseWriter");
  }

```

### 27

[2178, 'src/test', 'org.apache.solr.schema', 'DocValuesMissingTest', 'testStringSort', 410, 429]

[2178, 'src/test', 'org.apache.solr.schema', 'DocValuesMissingTest', 'testBoolSort', 479, 498]


```java

  @Test
  public void testStringSort() throws Exception {

    // note: cant use checkSortMissingDefault because 
    // nothing sorts lower then the default of ""
    for (String field : new String[] {"stringdv","dyn_stringdv"}) {
      assertU(adoc("id", "0")); // missing
      assertU(adoc("id", "1", field, "a"));
      assertU(adoc("id", "2", field, "z"));
      assertU(commit());
      assertQ(req("q", "*:*", "sort", field+" asc"),
              "//result/doc[1]/str[@name='id'][.=0]",
              "//result/doc[2]/str[@name='id'][.=1]",
              "//result/doc[3]/str[@name='id'][.=2]");
      assertQ(req("q", "*:*", "sort", field+" desc"),
              "//result/doc[1]/str[@name='id'][.=2]",
              "//result/doc[2]/str[@name='id'][.=1]",
              "//result/doc[3]/str[@name='id'][.=0]");
    }
  }

  @Test
  public void testBoolSort() throws Exception {
    // note: cant use checkSortMissingDefault because 
    // nothing sorts lower then the default of "" and
    // bool fields are, at root, string fields.
    for (String field : new String[] {"booldv","dyn_booldv"}) {
      assertU(adoc("id", "0")); // missing
      assertU(adoc("id", "1", field, "false"));
      assertU(adoc("id", "2", field, "true"));
      assertU(commit());
      assertQ(req("q", "*:*", "sort", field+" asc"),
          "//result/doc[1]/str[@name='id'][.=0]",
          "//result/doc[2]/str[@name='id'][.=1]",
          "//result/doc[3]/str[@name='id'][.=2]");
      assertQ(req("q", "*:*", "sort", field+" desc"),
          "//result/doc[1]/str[@name='id'][.=2]",
          "//result/doc[2]/str[@name='id'][.=1]",
          "//result/doc[3]/str[@name='id'][.=0]");
    }
  }
  
```

### 28

[2240, 'src/test', 'org.apache.solr', 'BasicFunctionalityTest', 'testDocBoost', 411, 428]

[2240, 'src/test', 'org.apache.solr', 'BasicFunctionalityTest', 'testFieldBoost', 430, 447]

```java

  @Test
  public void testDocBoost() throws Exception {
    String res = h.update("<add>" + "<doc><field name=\"id\">1</field>"+
                                          "<field name=\"text\">hello</field></doc>" + 
                          "<doc boost=\"2.0\"><field name=\"id\">2</field>" +
                                          "<field name=\"text\">hello</field></doc>" + 
                          "</add>");

    // assertEquals("<result status=\"0\"></result>", res);
    assertU("<commit/>");
    assertQ(req("text:hello")
            ,"//*[@numFound='2']"
            );
    String resp = h.query(lrf.makeRequest("q", "text:hello", CommonParams.DEBUG_QUERY, "true"));
    //System.out.println(resp);
    // second doc ranked first
    assertTrue( resp.indexOf("\"2\"") < resp.indexOf("\"1\"") );
  }

  @Test
  public void testFieldBoost() throws Exception {
    String res = h.update("<add>" + "<doc><field name=\"id\">1</field>"+
                                      "<field name=\"text\">hello</field></doc>" + 
                                    "<doc><field name=\"id\">2</field>" +
                                      "<field boost=\"2.0\" name=\"text\">hello</field></doc>" + 
                          "</add>");

    // assertEquals("<result status=\"0\"></result>", res);
    assertU("<commit/>");
    assertQ(req("text:hello"),
            "//*[@numFound='2']"
            );
    String resp = h.query(lrf.makeRequest("q", "text:hello", CommonParams.DEBUG_QUERY, "true"));
    //System.out.println(resp);
    // second doc ranked first
    assertTrue( resp.indexOf("\"2\"") < resp.indexOf("\"1\"") );
  }
```

### 28

[3093, 'src/test', 'org.apache.solr.handler.component', 'SuggestComponentTest', 'testExpressionBased', 100, 113]

[3093, 'src/test', 'org.apache.solr.handler.component', 'SuggestComponentTest', 'testFileBased', 115, 128]

```java

  @Test
  public void testExpressionBased() throws Exception {
    assertQ(req("qt", rh, 
        SuggesterParams.SUGGEST_DICT, "suggest_fuzzy_doc_expr_dict", 
        SuggesterParams.SUGGEST_BUILD, "true",
        SuggesterParams.SUGGEST_Q, "exampel",
        SuggesterParams.SUGGEST_COUNT, "5"),
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_doc_expr_dict']/lst[@name='exampel']/int[@name='numFound'][.='2']",
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_doc_expr_dict']/lst[@name='exampel']/arr[@name='suggestions']/lst[1]/str[@name='term'][.='example inputdata']",
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_doc_expr_dict']/lst[@name='exampel']/arr[@name='suggestions']/lst[1]/long[@name='weight'][.='120']",
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_doc_expr_dict']/lst[@name='exampel']/arr[@name='suggestions']/lst[2]/str[@name='term'][.='example data']",
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_doc_expr_dict']/lst[@name='exampel']/arr[@name='suggestions']/lst[2]/long[@name='weight'][.='110']"
        );
  }

  @Test
  public void testFileBased() throws Exception {
    assertQ(req("qt", rh, 
        SuggesterParams.SUGGEST_DICT, "suggest_fuzzy_file_based", 
        SuggesterParams.SUGGEST_BUILD, "true",
        SuggesterParams.SUGGEST_Q, "chn",
        SuggesterParams.SUGGEST_COUNT, "2"),
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_file_based']/lst[@name='chn']/int[@name='numFound'][.='2']",
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_file_based']/lst[@name='chn']/arr[@name='suggestions']/lst[1]/str[@name='term'][.='chance']",
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_file_based']/lst[@name='chn']/arr[@name='suggestions']/lst[1]/long[@name='weight'][.='1']",
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_file_based']/lst[@name='chn']/arr[@name='suggestions']/lst[2]/str[@name='term'][.='change']",
        "//lst[@name='suggest']/lst[@name='suggest_fuzzy_file_based']/lst[@name='chn']/arr[@name='suggestions']/lst[2]/long[@name='weight'][.='1']"
        );
  }

```

### 29

[3162, 'src/test', 'org.apache.solr', 'TestRandomDVFaceting', 'testRandomFaceting', 124, 144]

[3162, 'src/test', 'org.apache.solr', 'TestRandomFaceting', 'testRandomFaceting', 149, 169]

```java

  @Test
  public void testRandomFaceting() throws Exception {
    Random rand = random();
    int iter = atLeast(100);
    init();
    addMoreDocs(0);
    
    for (int i=0; i<iter; i++) {
      doFacetTests();
      
      if (rand.nextInt(100) < 5) {
        init();
      }
      
      addMoreDocs(rand.nextInt(indexSize) + 1);
      
      if (rand.nextInt(100) < 50) {
        deleteSomeDocs();
      }
    }
  }

  @Test
  public void testRandomFaceting() throws Exception {
    Random rand = random();
    int iter = atLeast(100);
    init();
    addMoreDocs(0);
    
    for (int i=0; i<iter; i++) {
      doFacetTests();
      
      if (rand.nextInt(100) < 5) {
        init();
      }
      
      addMoreDocs(rand.nextInt(indexSize) + 1);
      
      if (rand.nextInt(100) < 50) {
        deleteSomeDocs();
      }
    }
  }
```

### joda_time_2.10

### 30

[37, 'src/test/java', 'org.joda.time', 'TestMutableDateTime_Properties', 'testPropertyRoundHalfFloorHourOfDay', 538, 550]

[37, 'src/test/java', 'org.joda.time', 'TestMutableDateTime_Properties', 'testPropertyRoundHalfCeilingHourOfDay', 552, 564]

```java

public void testPropertyRoundHalfFloorHourOfDay() {
    MutableDateTime test = new MutableDateTime(2004, 6, 9, 13, 30, 0, 0);
    test.hourOfDay().roundHalfFloor();
    assertEquals("2004-06-09T13:00:00.000+01:00", test.toString());

    test = new MutableDateTime(2004, 6, 9, 13, 30, 0, 1);
    test.hourOfDay().roundHalfFloor();
    assertEquals("2004-06-09T14:00:00.000+01:00", test.toString());

    test = new MutableDateTime(2004, 6, 9, 13, 29, 59, 999);
    test.hourOfDay().roundHalfFloor();
    assertEquals("2004-06-09T13:00:00.000+01:00", test.toString());
}

public void testPropertyRoundHalfCeilingHourOfDay() {
    MutableDateTime test = new MutableDateTime(2004, 6, 9, 13, 30, 0, 0);
    test.hourOfDay().roundHalfCeiling();
    assertEquals("2004-06-09T14:00:00.000+01:00", test.toString());

    test = new MutableDateTime(2004, 6, 9, 13, 30, 0, 1);
    test.hourOfDay().roundHalfCeiling();
    assertEquals("2004-06-09T14:00:00.000+01:00", test.toString());

    test = new MutableDateTime(2004, 6, 9, 13, 29, 59, 999);
    test.hourOfDay().roundHalfCeiling();
    assertEquals("2004-06-09T13:00:00.000+01:00", test.toString());
}

```

[462, 'src/test/java', 'org.joda.time', 'TestDateMidnight_Properties', 'testPropertyRoundHalfFloorMonthOfYear', 319, 331]

[462, 'src/test/java', 'org.joda.time', 'TestDateMidnight_Properties', 'testPropertyRoundHalfCeilingMonthOfYear', 333, 345]

```java

public void testPropertyRoundHalfFloorMonthOfYear() {
    DateMidnight test = new DateMidnight(2004, 6, 16);
    DateMidnight copy = test.monthOfYear().roundHalfFloorCopy();
    assertEquals("2004-06-01T00:00:00.000+01:00", copy.toString());

    test = new DateMidnight(2004, 6, 17);
    copy = test.monthOfYear().roundHalfFloorCopy();
    assertEquals("2004-07-01T00:00:00.000+01:00", copy.toString());

    test = new DateMidnight(2004, 6, 15);
    copy = test.monthOfYear().roundHalfFloorCopy();
    assertEquals("2004-06-01T00:00:00.000+01:00", copy.toString());
}

public void testPropertyRoundHalfCeilingMonthOfYear() {
    DateMidnight test = new DateMidnight(2004, 6, 16);
    DateMidnight copy = test.monthOfYear().roundHalfCeilingCopy();
    assertEquals("2004-07-01T00:00:00.000+01:00", copy.toString());

    test = new DateMidnight(2004, 6, 17);
    copy = test.monthOfYear().roundHalfCeilingCopy();
    assertEquals("2004-07-01T00:00:00.000+01:00", copy.toString());

    test = new DateMidnight(2004, 6, 15);
    copy = test.monthOfYear().roundHalfCeilingCopy();
    assertEquals("2004-06-01T00:00:00.000+01:00", copy.toString());
}

```

### 31

[53, 'src/test/java', 'org.joda.time', 'TestDateTime_Properties', 'testPropertyGetWeekyear', 188, 204]

[53, 'src/test/java', 'org.joda.time', 'TestLocalDateTime_Properties', 'testPropertyGetYear', 88, 104]

```java

public void testPropertyGetWeekyear() {
    DateTime test = new DateTime(2004, 6, 9, 0, 0, 0, 0);
    assertSame(test.getChronology().weekyear(), test.weekyear().getField());
    assertEquals("weekyear", test.weekyear().getName());
    assertEquals("Property[weekyear]", test.weekyear().toString());
    assertSame(test, test.weekyear().getDateTime());
    assertEquals(2004, test.weekyear().get());
    assertEquals("2004", test.weekyear().getAsString());
    assertEquals("2004", test.weekyear().getAsText());
    assertEquals("2004", test.weekyear().getAsText(Locale.FRENCH));
    assertEquals("2004", test.weekyear().getAsShortText());
    assertEquals("2004", test.weekyear().getAsShortText(Locale.FRENCH));
    assertEquals(test.getChronology().weekyears(), test.weekyear().getDurationField());
    assertEquals(null, test.weekyear().getRangeDurationField());
    assertEquals(9, test.weekyear().getMaximumTextLength(null));
    assertEquals(9, test.weekyear().getMaximumShortTextLength(null));
}

public void testPropertyGetYear() {
    LocalDateTime test = new LocalDateTime(1972, 6, 9, 10, 20, 30, 40);
    assertSame(test.getChronology().year(), test.year().getField());
    assertEquals("year", test.year().getName());
    assertEquals("Property[year]", test.year().toString());
    assertSame(test, test.year().getLocalDateTime());
    assertEquals(1972, test.year().get());
    assertEquals("1972", test.year().getAsString());
    assertEquals("1972", test.year().getAsText());
    assertEquals("1972", test.year().getAsText(Locale.FRENCH));
    assertEquals("1972", test.year().getAsShortText());
    assertEquals("1972", test.year().getAsShortText(Locale.FRENCH));
    assertEquals(test.getChronology().years(), test.year().getDurationField());
    assertEquals(null, test.year().getRangeDurationField());
    assertEquals(9, test.year().getMaximumTextLength(null));
    assertEquals(9, test.year().getMaximumShortTextLength(null));
}

```

### 32

[250, 'src/test/java', 'org.joda.time.format', 'TestPeriodFormat', 'test_wordBased_ja_checkRedundantSeparator', 365, 373]

[250, 'src/test/java', 'org.joda.time.format', 'TestPeriodFormat', 'test_wordBased_pl_checkRedundantSeparator', 408, 415]

```java

public void test_wordBased_ja_checkRedundantSeparator() {
    try {
        // Spaces are not valid separators in Japanese
        PeriodFormat.wordBased(JA).parsePeriod("2\u65E5 ");
        fail("No exception was caught");
    } catch (Exception e) {
        assertEquals(IllegalArgumentException.class, e.getClass());
    }
}   

public void test_wordBased_pl_checkRedundantSeparator() {
    try {
        PeriodFormat.wordBased(PL).parsePeriod("2 dni and 5 godzin ");
        fail("No exception was caught");
    } catch (Exception e) {
        assertEquals(IllegalArgumentException.class, e.getClass());
    }
}

```

### 33

[292, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormat', 'testFormat_invalid', 824, 841]

[292, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormatStyle', 'testForStyle_stringLengths', 92, 109]

```java

public void testFormat_invalid() {
    try {
        DateTimeFormat.forPattern(null);
        fail();
    } catch (IllegalArgumentException ex) {}
    try {
        DateTimeFormat.forPattern("");
        fail();
    } catch (IllegalArgumentException ex) {}
    try {
        DateTimeFormat.forPattern("A");
        fail();
    } catch (IllegalArgumentException ex) {}
    try {
        DateTimeFormat.forPattern("dd/mm/AA");
        fail();
    } catch (IllegalArgumentException ex) {}
}

public void testForStyle_stringLengths() {
    try {
        DateTimeFormat.forStyle(null);
        fail();
    } catch (IllegalArgumentException ex) {}
    try {
        DateTimeFormat.forStyle("");
        fail();
    } catch (IllegalArgumentException ex) {}
    try {
        DateTimeFormat.forStyle("S");
        fail();
    } catch (IllegalArgumentException ex) {}
    try {
        DateTimeFormat.forStyle("SSS");
        fail();
    } catch (IllegalArgumentException ex) {}
}
```

### 34

[463, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormat', 'testFormatParse_textEraAD_UK', 1034, 1046]

[463, 'src/test/java', 'org.joda.time.format', 'TestDateTimeFormat', 'testFormatParse_textEraAD_France', 1048, 1060]

```java

public void testFormatParse_textEraAD_UK() {
    DateTimeFormatter dateFormatter = new DateTimeFormatterBuilder()
        .appendLiteral('$')
        .appendEraText()
        .appendYear(4, 4)
        .toFormatter()
        .withLocale(Locale.UK).withZoneUTC();

    String str = new DateTime(2007, 6, 23, 0, 0, 0, 0, UTC).toString(dateFormatter);
    assertEquals("$AD2007", str);
    DateTime date = dateFormatter.parseDateTime(str);
    check(date, 2007, 1, 1);
}

public void testFormatParse_textEraAD_France() {
    DateTimeFormatter dateFormatter = new DateTimeFormatterBuilder()
        .appendLiteral('$')
        .appendEraText()
        .appendYear(4, 4)
        .toFormatter()
        .withLocale(Locale.FRANCE).withZoneUTC();

    String str = new DateTime(2007, 6, 23, 0, 0, 0, 0, UTC).toString(dateFormatter);
    assertEquals("$ap. J.-C.2007", str);
    DateTime date = dateFormatter.parseDateTime(str);
    check(date, 2007, 1, 1);
}
```

### 35

[486, 'src/test/java', 'org.joda.time.format', 'TestPeriodFormatterBuilder', 'testFormatPrefixRegEx1', 432, 443]

[486, 'src/test/java', 'org.joda.time.format', 'TestPeriodFormatterBuilder', 'testFormatPrefixRegEx2', 445, 456]

```java

public void testFormatPrefixRegEx1() {
    PeriodFormatter f = builder.appendPrefix(new String[] { "^1$", "^.*$" }, new String[] { "Year:", "Years:" }).appendYears()
            .toFormatter();
    assertEquals("Year:1", f.print(PERIOD));
    assertEquals(6, f.getPrinter().calculatePrintedLength(PERIOD, null));
    assertEquals(1, f.getPrinter().countFieldsToPrint(PERIOD, Integer.MAX_VALUE, null));

    Period p = new Period(0, 0, 0, 0, 0, 0, 0, 0);
    assertEquals("Years:0", f.print(p));
    assertEquals(7, f.getPrinter().calculatePrintedLength(p, null));
    assertEquals(1, f.getPrinter().countFieldsToPrint(p, Integer.MAX_VALUE, null));
}

public void testFormatPrefixRegEx2() {
    PeriodFormatter f = builder.appendPrefix(new String[] { "^1$", "^.*$" }, new String[] { "Hour:", "Hours:" }).appendHours()
            .toFormatter();
    assertEquals("Hours:5", f.print(PERIOD));
    assertEquals(7, f.getPrinter().calculatePrintedLength(PERIOD, null));
    assertEquals(1, f.getPrinter().countFieldsToPrint(PERIOD, Integer.MAX_VALUE, null));

    Period p = new Period(0, 0, 0, 0, 0, 0, 0, 0);
    assertEquals("Hours:0", f.print(p));
    assertEquals(7, f.getPrinter().calculatePrintedLength(p, null));
    assertEquals(1, f.getPrinter().countFieldsToPrint(p, Integer.MAX_VALUE, null));
}
```

### 36

[878, 'src/test/java', 'org.joda.time.format', 'TestPeriodFormatterBuilder', 'testFormatPrefixPlural4IgnoringPrefix', 404, 420]

[878, 'src/test/java', 'org.joda.time.format', 'TestPeriodFormatterBuilder', 'testFormatSuffixPlural4IgnoringPrefix', 628, 644]

```java

public void testFormatPrefixPlural4IgnoringPrefix() {
    PeriodFormatter f = builder.appendPrefix("m", "ms").appendMinutes()
            .appendSeparator(" ").appendPrefix("mss", "msss").appendMillis().toFormatter();
    String oneMS = Period.millis(1).toString(f);
    assertEquals("mss1", oneMS);
    Period period = f.parsePeriod(oneMS);
    assertEquals(Period.millis(1), period);
    period = f.parsePeriod(oneMS.toUpperCase(Locale.ENGLISH));
    assertEquals(Period.millis(1), period);

    String twoMS = Period.millis(2).toString(f);
    assertEquals("msss2", twoMS);
    Period period2 = f.parsePeriod(twoMS);
    assertEquals(Period.millis(2), period2);
    period = f.parsePeriod(twoMS.toUpperCase(Locale.ENGLISH));
    assertEquals(Period.millis(2), period2);
}

public void testFormatSuffixPlural4IgnoringPrefix() {
    PeriodFormatter f = builder.appendMinutes().appendSuffix("m", "ms")
            .appendSeparator(" ").appendMillis().appendSuffix("mss", "msss").toFormatter();
    String oneMS = Period.millis(1).toString(f);
    assertEquals("1mss", oneMS);
    Period period = f.parsePeriod(oneMS);
    assertEquals(Period.millis(1), period);
    period = f.parsePeriod(oneMS.toUpperCase(Locale.ENGLISH));
    assertEquals(Period.millis(1), period);

    String twoMS = Period.millis(2).toString(f);
    assertEquals("2msss", twoMS);
    Period period2 = f.parsePeriod(twoMS);
    assertEquals(Period.millis(2), period2);
    period = f.parsePeriod(twoMS.toUpperCase(Locale.ENGLISH));
    assertEquals(Period.millis(2), period);
}
```

### 37

[2002, 'src/test/java', 'org.joda.time', 'TestMonthDay_Basics', 'testCompareTo', 223, 263]

[2002, 'src/test/java', 'org.joda.time', 'TestYearMonth_Basics', 'testCompareTo', 218, 258]

```java

public void testCompareTo() {
    MonthDay test1 = new MonthDay(6, 6);
    MonthDay test1a = new MonthDay(6, 6);
    assertEquals(0, test1.compareTo(test1a));
    assertEquals(0, test1a.compareTo(test1));
    assertEquals(0, test1.compareTo(test1));
    assertEquals(0, test1a.compareTo(test1a));

    MonthDay test2 = new MonthDay(6, 7);
    assertEquals(-1, test1.compareTo(test2));
    assertEquals(+1, test2.compareTo(test1));

    MonthDay test3 = new MonthDay(6, 7, GregorianChronology.getInstanceUTC());
    assertEquals(-1, test1.compareTo(test3));
    assertEquals(+1, test3.compareTo(test1));
    assertEquals(0, test3.compareTo(test2));

    DateTimeFieldType[] types = new DateTimeFieldType[] {
        DateTimeFieldType.monthOfYear(),
        DateTimeFieldType.dayOfMonth()
    };
    int[] values = new int[] {6, 6};
    Partial p = new Partial(types, values);
    assertEquals(0, test1.compareTo(p));
    try {
        test1.compareTo(null);
        fail();
    } catch (NullPointerException ex) {}
    try {
        test1.compareTo(new LocalTime());
        fail();
    } catch (ClassCastException ex) {}
    Partial partial = new Partial()
        .with(DateTimeFieldType.centuryOfEra(), 1)
        .with(DateTimeFieldType.halfdayOfDay(), 0)
        .with(DateTimeFieldType.dayOfMonth(), 9);
    try {
        new MonthDay(10, 6).compareTo(partial);
        fail();
    } catch (ClassCastException ex) {}
}

public void testCompareTo() {
    YearMonth test1 = new YearMonth(2005, 6);
    YearMonth test1a = new YearMonth(2005, 6);
    assertEquals(0, test1.compareTo(test1a));
    assertEquals(0, test1a.compareTo(test1));
    assertEquals(0, test1.compareTo(test1));
    assertEquals(0, test1a.compareTo(test1a));

    YearMonth test2 = new YearMonth(2005, 7);
    assertEquals(-1, test1.compareTo(test2));
    assertEquals(+1, test2.compareTo(test1));

    YearMonth test3 = new YearMonth(2005, 7, GregorianChronology.getInstanceUTC());
    assertEquals(-1, test1.compareTo(test3));
    assertEquals(+1, test3.compareTo(test1));
    assertEquals(0, test3.compareTo(test2));

    DateTimeFieldType[] types = new DateTimeFieldType[] {
        DateTimeFieldType.year(),
        DateTimeFieldType.monthOfYear(),
    };
    int[] values = new int[] {2005, 6};
    Partial p = new Partial(types, values);
    assertEquals(0, test1.compareTo(p));
    try {
        test1.compareTo(null);
        fail();
    } catch (NullPointerException ex) {}
    try {
        test1.compareTo(new LocalTime());
        fail();
    } catch (ClassCastException ex) {}
    Partial partial = new Partial()
        .with(DateTimeFieldType.centuryOfEra(), 1)
        .with(DateTimeFieldType.halfdayOfDay(), 0)
        .with(DateTimeFieldType.dayOfMonth(), 9);
    try {
        new YearMonth(1970, 6).compareTo(partial);
        fail();
    } catch (ClassCastException ex) {}
}

```

### jfreechart_1.0.10

### 38

[41, 'tests', 'org.jfree.data.junit', 'DefaultKeyedValues2DTests', 'testSerialization', 139, 165]

[41, 'tests', 'org.jfree.data.junit', 'KeyedObjects2DTests', 'testSerialization', 124, 150]

```java

public void testSerialization() {

    DefaultKeyedValues2D kv2D1 = new DefaultKeyedValues2D();
    kv2D1.addValue(new Double(234.2), "Row1", "Col1");
    kv2D1.addValue(null, "Row1", "Col2");
    kv2D1.addValue(new Double(345.9), "Row2", "Col1");
    kv2D1.addValue(new Double(452.7), "Row2", "Col2");

    DefaultKeyedValues2D kv2D2 = null;

    try {
        ByteArrayOutputStream buffer = new ByteArrayOutputStream();
        ObjectOutput out = new ObjectOutputStream(buffer);
        out.writeObject(kv2D1);
        out.close();

        ObjectInput in = new ObjectInputStream(
                new ByteArrayInputStream(buffer.toByteArray()));
        kv2D2 = (DefaultKeyedValues2D) in.readObject();
        in.close();
    }
    catch (Exception e) {
        e.printStackTrace();
    }
    assertEquals(kv2D1, kv2D2);

}

public void testSerialization() {

    KeyedObjects2D ko2D1 = new KeyedObjects2D();
    ko2D1.addObject(new Double(234.2), "Row1", "Col1");
    ko2D1.addObject(null, "Row1", "Col2");
    ko2D1.addObject(new Double(345.9), "Row2", "Col1");
    ko2D1.addObject(new Double(452.7), "Row2", "Col2");

    KeyedObjects2D ko2D2 = null;

    try {
        ByteArrayOutputStream buffer = new ByteArrayOutputStream();
        ObjectOutput out = new ObjectOutputStream(buffer);
        out.writeObject(ko2D1);
        out.close();

        ObjectInput in = new ObjectInputStream(
                new ByteArrayInputStream(buffer.toByteArray()));
        ko2D2 = (KeyedObjects2D) in.readObject();
        in.close();
    }
    catch (Exception e) {
        e.printStackTrace();
    }
    assertEquals(ko2D1, ko2D2);

}

```

### 39

[65, 'tests', 'org.jfree.chart.axis.junit', 'NumberAxisTests', 'testXYAutoRange1', 346, 368]

[65, 'tests', 'org.jfree.chart.axis.junit', 'NumberAxisTests', 'testXYAutoRange2', 374, 396]

```java

public void testXYAutoRange1() {
    XYSeries series = new XYSeries("Series 1");
    series.add(1.0, 1.0);
    series.add(2.0, 2.0);
    series.add(3.0, 3.0);
    XYSeriesCollection dataset = new XYSeriesCollection();
    dataset.addSeries(series);
    JFreeChart chart = ChartFactory.createScatterPlot(
        "Test", 
        "X",
        "Y",
        dataset,
        PlotOrientation.VERTICAL,
        false, 
        false,
        false
    );
    XYPlot plot = (XYPlot) chart.getPlot();
    NumberAxis axis = (NumberAxis) plot.getDomainAxis();
    axis.setAutoRangeIncludesZero(false);
    assertEquals(0.9, axis.getLowerBound(), EPSILON);    
    assertEquals(3.1, axis.getUpperBound(), EPSILON);    
}

public void testXYAutoRange2() {
    XYSeries series = new XYSeries("Series 1");
    series.add(1.0, 1.0);
    series.add(2.0, 2.0);
    series.add(3.0, 3.0);
    XYSeriesCollection dataset = new XYSeriesCollection();
    dataset.addSeries(series);
    JFreeChart chart = ChartFactory.createScatterPlot(
        "Test", 
        "X",
        "Y",
        dataset,
        PlotOrientation.VERTICAL,
        false, 
        false,
        false
    );
    XYPlot plot = (XYPlot) chart.getPlot();
    NumberAxis axis = (NumberAxis) plot.getRangeAxis();
    axis.setAutoRangeIncludesZero(false);
    assertEquals(0.9, axis.getLowerBound(), EPSILON);    
    assertEquals(3.1, axis.getUpperBound(), EPSILON);    
}
```

[148, 'tests', 'org.jfree.chart.axis.junit', 'LogAxisTests', 'testXYAutoRange1', 253, 275]

[148, 'tests', 'org.jfree.chart.axis.junit', 'LogAxisTests', 'testXYAutoRange2', 281, 303]

```java

public void testXYAutoRange1() {
    XYSeries series = new XYSeries("Series 1");
    series.add(1.0, 1.0);
    series.add(2.0, 2.0);
    series.add(3.0, 3.0);
    XYSeriesCollection dataset = new XYSeriesCollection();
    dataset.addSeries(series);
    JFreeChart chart = ChartFactory.createScatterPlot(
        "Test",
        "X",
        "Y",
        dataset,
        PlotOrientation.VERTICAL,
        false,
        false,
        false
    );
    XYPlot plot = (XYPlot) chart.getPlot();
    LogAxis axis = new LogAxis("Log(Y)");
    plot.setRangeAxis(axis);
    assertEquals(0.9465508226401592, axis.getLowerBound(), EPSILON);
    assertEquals(3.1694019256486126, axis.getUpperBound(), EPSILON);
}

public void testXYAutoRange2() {
    XYSeries series = new XYSeries("Series 1");
    series.add(1.0, 1.0);
    series.add(2.0, 2.0);
    series.add(3.0, 3.0);
    XYSeriesCollection dataset = new XYSeriesCollection();
    dataset.addSeries(series);
    JFreeChart chart = ChartFactory.createScatterPlot(
        "Test",
        "X",
        "Y",
        dataset,
        PlotOrientation.VERTICAL,
        false,
        false,
        false
    );
    XYPlot plot = (XYPlot) chart.getPlot();
    LogAxis axis = new LogAxis("Log(Y)");
    plot.setRangeAxis(axis);
    assertEquals(0.9465508226401592, axis.getLowerBound(), EPSILON);
    assertEquals(3.1694019256486126, axis.getUpperBound(), EPSILON);
}
```

### 40

[220, 'tests', 'org.jfree.chart.renderer.junit', 'RendererUtilitiesTests', 'testFindLiveItemsLowerBoundDescending', 196, 255]

[220, 'tests', 'org.jfree.chart.renderer.junit', 'RendererUtilitiesTests', 'testFindLiveItemsUpperBoundDescending', 379, 438]

```java
public void testFindLiveItemsLowerBoundDescending() {
    DefaultXYDataset d = new DefaultXYDataset() {
        public DomainOrder getDomainOrder() {
            // we're doing this for testing only, and make sure that we 
            // only add data in ascending order by x-value
            return DomainOrder.DESCENDING;
        }
    };
    // check a series with no items
    d.addSeries("S1", new double[][] {{}, {}});
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 0, 10.0, 
            11.0));

    // check a series with one item
    d.addSeries("S2", new double[][] {{1.0}, {2.0}});
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 1, 0.0, 
            1.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 1, 1.1, 
            2.0));

    // check a series with two items
    d.addSeries("S3", new double[][] {{2.0, 1.0}, {2.0, 2.0}});
    assertEquals(1, RendererUtilities.findLiveItemsLowerBound(d, 2, 0.1, 
            0.5));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 2, 0.1, 
            1.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 2, 1.1, 
            2.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 2, 2.2, 
            3.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 2, 3.3, 
            4.0));

    // check a series with three items
    d.addSeries("S4", new double[][] {{3.0, 2.0, 1.0}, {2.0, 2.0, 2.0}});
    assertEquals(1, RendererUtilities.findLiveItemsLowerBound(d, 3, 0.0, 
            1.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 3, 1.0, 
            2.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 3, 2.0, 
            3.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 3, 3.0, 
            4.0));

    // check a series with four items
    d.addSeries("S5", new double[][] {{4.0, 3.0, 2.0, 1.0}, {2.0, 2.0, 
            2.0, 2.0}});
    assertEquals(3, RendererUtilities.findLiveItemsLowerBound(d, 4, 0.1, 
            0.5));
    assertEquals(2, RendererUtilities.findLiveItemsLowerBound(d, 4, 0.1, 
            1.0));
    assertEquals(1, RendererUtilities.findLiveItemsLowerBound(d, 4, 1.1, 
            2.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 4, 2.2, 
            3.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 4, 3.3, 
            4.0));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 4, 4.4,
            5.0));
}

public void testFindLiveItemsUpperBoundDescending() {
    DefaultXYDataset d = new DefaultXYDataset() {
        public DomainOrder getDomainOrder() {
            // we're doing this for testing only, and make sure that we 
            // only add data in ascending order by x-value
            return DomainOrder.DESCENDING;
        }
    };
    // check a series with no items
    d.addSeries("S1", new double[][] {{}, {}});
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 0, 10.0, 
            11.0));

    // check a series with one item
    d.addSeries("S2", new double[][] {{1.0}, {2.0}});
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 1, 0.0, 
            1.0));
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 1, 1.1, 
            2.0));

    // check a series with two items
    d.addSeries("S3", new double[][] {{2.0, 1.0}, {2.0, 2.0}});
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 2, 0.1, 
            0.5));
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 2, 0.1, 
            1.0));
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 2, 1.1, 
            2.0));
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 2, 2.2, 
            3.0));
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 2, 3.3, 
            4.0));

    // check a series with three items
    d.addSeries("S4", new double[][] {{3.0, 2.0, 1.0}, {2.0, 2.0, 2.0}});
    assertEquals(2, RendererUtilities.findLiveItemsUpperBound(d, 3, 0.0, 
            1.0));
    assertEquals(2, RendererUtilities.findLiveItemsUpperBound(d, 3, 1.0, 
            2.0));
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 3, 2.0, 
            3.0));
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 3, 3.0, 
            4.0));

    // check a series with four items
    d.addSeries("S5", new double[][] {{4.0, 3.0, 2.0, 1.0}, {2.0, 2.0, 
            2.0, 2.0}});
    assertEquals(3, RendererUtilities.findLiveItemsUpperBound(d, 4, 0.1, 
            0.5));
    assertEquals(3, RendererUtilities.findLiveItemsUpperBound(d, 4, 0.1, 
            1.0));
    assertEquals(2, RendererUtilities.findLiveItemsUpperBound(d, 4, 1.1, 
            2.0));
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 4, 2.2, 
            3.0));
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 4, 3.3, 
            4.0));
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 4, 4.4,
            5.0));
}
```

[1094, 'tests', 'org.jfree.chart.renderer.junit', 'RendererUtilitiesTests', 'testFindLiveItemsLowerBoundAscending', 134, 190]

[1094, 'tests', 'org.jfree.chart.renderer.junit', 'RendererUtilitiesTests', 'testFindLiveItemsUpperBoundAscending', 317, 373]

```java

public void testFindLiveItemsLowerBoundAscending() {
    DefaultXYDataset d = new DefaultXYDataset() {
        public DomainOrder getDomainOrder() {
            // we're doing this for testing only, and make sure that we 
            // only add data in ascending order by x-value
            return DomainOrder.ASCENDING;
        }
    };
    // check a series with no items
    d.addSeries("S1", new double[][] {{}, {}});
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 0, 10.0, 
            11.1));

    // check a series with one item
    d.addSeries("S2", new double[][] {{1.0}, {2.0}});
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 1, 0.0, 
            1.1));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 1, 2.0, 
            2.2));

    // check a series with two items
    d.addSeries("S3", new double[][] {{1.0, 2.0}, {2.0, 2.0}});
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 2, 0.0, 
            1.1));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 2, 1.0, 
            2.2));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 2, 2.0, 
            3.3));
    assertEquals(1, RendererUtilities.findLiveItemsLowerBound(d, 2, 3.0, 
            4.4));

    // check a series with three items
    d.addSeries("S4", new double[][] {{1.0, 2.0, 3.0}, {2.0, 2.0, 2.0}});
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 3, 0.0, 
            1.1));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 3, 1.0, 
            2.2));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 3, 2.0, 
            3.3));
    assertEquals(1, RendererUtilities.findLiveItemsLowerBound(d, 3, 3.0, 
            4.4));

    // check a series with four items
    d.addSeries("S5", new double[][] {{1.0, 2.0, 3.0, 4.0}, {2.0, 2.0, 
            2.0, 2.0}});
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 4, 0.0, 
            1.1));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 4, 1.0, 
            2.2));
    assertEquals(0, RendererUtilities.findLiveItemsLowerBound(d, 4, 2.0, 
            3.3));
    assertEquals(1, RendererUtilities.findLiveItemsLowerBound(d, 4, 3.0, 
            4.4));
    assertEquals(2, RendererUtilities.findLiveItemsLowerBound(d, 4, 4.0, 
            5.5));

}

public void testFindLiveItemsUpperBoundAscending() {
    DefaultXYDataset d = new DefaultXYDataset() {
        public DomainOrder getDomainOrder() {
            // we're doing this for testing only, and make sure that we 
            // only add data in ascending order by x-value
            return DomainOrder.ASCENDING;
        }
    };
    // check a series with no items
    d.addSeries("S1", new double[][] {{}, {}});
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 0, 10.0, 
            11.1));

    // check a series with one item
    d.addSeries("S2", new double[][] {{1.0}, {2.0}});
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 1, 0.0, 
            1.1));
    assertEquals(0, RendererUtilities.findLiveItemsUpperBound(d, 1, 2.0, 
            2.2));

    // check a series with two items
    d.addSeries("S3", new double[][] {{1.0, 2.0}, {2.0, 2.0}});
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 2, 0.0, 
            1.0));
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 2, 1.0, 
            2.2));
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 2, 2.0, 
            3.3));
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 2, 3.0, 
            4.4));

    // check a series with three items
    d.addSeries("S4", new double[][] {{1.0, 2.0, 3.0}, {2.0, 2.0, 2.0}});
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 3, 0.0, 
            1.1));
    assertEquals(2, RendererUtilities.findLiveItemsUpperBound(d, 3, 1.0, 
            2.2));
    assertEquals(2, RendererUtilities.findLiveItemsUpperBound(d, 3, 2.0, 
            3.3));
    assertEquals(2, RendererUtilities.findLiveItemsUpperBound(d, 3, 3.0, 
            4.4));

    // check a series with four items
    d.addSeries("S5", new double[][] {{1.0, 2.0, 3.0, 4.0}, {2.0, 2.0, 
            2.0, 2.0}});
    assertEquals(1, RendererUtilities.findLiveItemsUpperBound(d, 4, 0.0, 
            1.1));
    assertEquals(2, RendererUtilities.findLiveItemsUpperBound(d, 4, 1.0, 
            2.2));
    assertEquals(3, RendererUtilities.findLiveItemsUpperBound(d, 4, 2.0, 
            3.3));
    assertEquals(3, RendererUtilities.findLiveItemsUpperBound(d, 4, 3.0, 
            4.4));
    assertEquals(3, RendererUtilities.findLiveItemsUpperBound(d, 4, 4.0, 
            5.5));

}

```

### 41

[737, 'tests', 'org.jfree.chart.renderer.xy.junit', 'XYLineAndShapeRendererTests', 'testFindDomainBounds', 281, 295]

[737, 'tests', 'org.jfree.chart.renderer.xy.junit', 'XYLineAndShapeRendererTests', 'testFindRangeBounds', 300, 314]

```java

public void testFindDomainBounds() {
    XYSeriesCollection dataset
            = RendererXYPackageTests.createTestXYSeriesCollection();
    JFreeChart chart = ChartFactory.createXYLineChart(
            "Test Chart", "X", "Y", dataset, PlotOrientation.VERTICAL,
            false, false, false);
    XYPlot plot = (XYPlot) chart.getPlot();
    NumberAxis domainAxis = (NumberAxis) plot.getDomainAxis();
    domainAxis.setAutoRangeIncludesZero(false);
    Range bounds = domainAxis.getRange();
    assertFalse(bounds.contains(0.9));
    assertTrue(bounds.contains(1.0));
    assertTrue(bounds.contains(2.0));
    assertFalse(bounds.contains(2.10));
}

public void testFindRangeBounds() {
    TableXYDataset dataset
            = RendererXYPackageTests.createTestTableXYDataset();
    JFreeChart chart = ChartFactory.createXYLineChart(
            "Test Chart", "X", "Y", dataset, PlotOrientation.VERTICAL,
            false, false, false);
    XYPlot plot = (XYPlot) chart.getPlot();
    NumberAxis rangeAxis = (NumberAxis) plot.getRangeAxis();
    rangeAxis.setAutoRangeIncludesZero(false);
    Range bounds = rangeAxis.getRange();
    assertFalse(bounds.contains(1.0));
    assertTrue(bounds.contains(2.0));
    assertTrue(bounds.contains(5.0));
    assertFalse(bounds.contains(6.0));
}
```

### jmeter_5.1.1

### 42

[3, 'test/src', 'org.apache.jmeter.protocol.http.proxy', 'TestProxyControl', 'testContentTypeInclude', 102, 113]

[3, 'test/src', 'org.apache.jmeter.protocol.http.proxy', 'TestProxyControl', 'testContentTypeExclude', 115, 126]

```java

    @Test
    public void testContentTypeInclude() throws Exception {
        SampleResult result = new SampleResult();
        control.setContentTypeInclude("text/html|text/ascii");

        result.setContentType(null);
        assertTrue("Should allow if no content-type present", control.filterContentType(result));           
        result.setContentType("text/html; charset=utf-8");
        assertTrue("Should allow text/html", control.filterContentType(result));            
        result.setContentType("text/css");
        assertFalse("Should not allow text/css", control.filterContentType(result));
    }

    @Test
    public void testContentTypeExclude() throws Exception {
        SampleResult result = new SampleResult();
        control.setContentTypeExclude("text/css");

        result.setContentType(null);
        assertTrue("Should allow if no content-type present", control.filterContentType(result));           
        result.setContentType("text/html; charset=utf-8");
        assertTrue("Should allow text/html", control.filterContentType(result));            
        result.setContentType("text/css");
        assertFalse("Should not allow text/css", control.filterContentType(result));
    }
``` 

### 43

[90, 'test/src', 'org.apache.jmeter.assertions', 'ResponseAssertionTest', 'testResponseAssertionResponseHeaders', 130, 144]

[90, 'test/src', 'org.apache.jmeter.assertions', 'ResponseAssertionTest', 'testResponseAssertionRequestHeaders', 146, 160]

```java

@Test
public void testResponseAssertionResponseHeaders() throws Exception{
    assertion.unsetNotType();
    assertion.setToEqualsType();
    assertion.setTestFieldResponseHeaders();
    assertion.addTestString("X-Header: abcd");
    assertion.addTestString("X-Header: abcdx");
    result = assertion.getResult(sample);
    assertFailed();

    assertion.clearTestStrings();
    assertion.addTestString("X-Header: abcd");
    result = assertion.getResult(sample);
    assertPassed();
}

@Test
public void testResponseAssertionRequestHeaders() throws Exception{
    assertion.unsetNotType();
    assertion.setToEqualsType();
    assertion.setTestFieldRequestHeaders();
    assertion.addTestString("X-reqHeader: cdef");
    assertion.addTestString("X-reqHeader: cdefx");
    result = assertion.getResult(sample);
    assertFailed();

    assertion.clearTestStrings();
    assertion.addTestString("X-reqHeader: cdef");
    result = assertion.getResult(sample);
    assertPassed();
}
```

### 44

[113, 'test/src', 'org.apache.jmeter.protocol.http.control', 'TestHC4CookieManager', 'testCookies1', 333, 343]

[113, 'test/src', 'org.apache.jmeter.protocol.http.control', 'TestHC4CookieManager', 'testCookies3', 360, 370]

```java
    @Test
    public void testCookies1() throws Exception {
        man.setCookiePolicy(CookieSpecs.DEFAULT);
        man.testStarted(); // ensure policy is picked up
        URL url = new URL("http://a.b.c.d/testCookies1");
        man.addCookieFromHeader("test1=1; comment=\"how,now\", test2=2; version=1", url);
        assertEquals(2,man.getCookieCount());
        String s = man.getCookieHeaderForURL(url);
        assertNotNull(s);
        assertEquals("test1=1; test2=2", s);
    }

    @Test
    public void testCookies3() throws Exception {
        man.setCookiePolicy(CookieSpecs.DEFAULT);
        man.testStarted(); // ensure policy is picked up
        URL url = new URL("https://a.b.c.d/testCookies2");
        man.addCookieFromHeader("test1=1;secure, test2=2;secure; version=1", url);
        assertEquals(2,man.getCookieCount());
        String s = man.getCookieHeaderForURL(url);
        assertNotNull(s);
        assertEquals("test1=1; test2=2", s);
    }
```

[557, 'test/src', 'org.apache.jmeter.protocol.http.control', 'TestHC4CookieManager', 'testNewCookie', 281, 289]

[557, 'test/src', 'org.apache.jmeter.protocol.http.control', 'TestHC4CookieManager', 'testCookies2', 345, 358]

```java

    @Test
    public void testNewCookie() throws Exception {
        URL url = new URL("http://a.b.c/");
        man.addCookieFromHeader("test=1; expires=Mon, 01-Jan-2990 00:00:00 GMT", url);
        assertEquals(1,man.getCookieCount());
        String s = man.getCookieHeaderForURL(url);
        assertNotNull(s);
        assertEquals("test=1", s);
    }

    @Test
    public void testCookies2() throws Exception {
        URL url = new URL("https://a.b.c.d/testCookies2");
        //The cookie in question does not have a version attribute mandatory for
        //standard (RFC 2109 and RFC 2965) cookies. Therefore it is parsed as
        //Netscape style cookie in which case comma is not considered a valid
        //header element delimiter and is treated as normal character.

        man.addCookieFromHeader("test1=1;secure, test2=2;secure", url);
        assertEquals(1,man.getCookieCount());
        String s = man.getCookieHeaderForURL(url);
        assertNotNull(s);
        assertEquals("test1=1", s);
    }

```

[764, 'test/src', 'org.apache.jmeter.protocol.http.control', 'TestHC4CookieManager', 'testHttpOnlyCookie', 292, 303]

[764, 'test/src', 'org.apache.jmeter.protocol.http.control', 'TestHC4CookieManager', 'testSecureCookieWithHttps', 319, 330]

```java

    @Test
    public void testHttpOnlyCookie() throws Exception {
        URL url = new URL("http://a.b.c/");
        man.addCookieFromHeader(
                "mySASession=s%3AcafPSGf6UJguyhddGFFeLdHBy9CYbzIS.NhYyA26LGTAVoLxhCQUK%2F2Bs34MW5kGHmErKzG6r3XI; Path=/;"
                + " Expires=Tue, 07 Feb 2990 09:13:14 GMT; HttpOnly",
                url);
        assertEquals(1,man.getCookieCount());
        String s = man.getCookieHeaderForURL(url);
        assertNotNull(s);
        assertEquals("mySASession=s%3AcafPSGf6UJguyhddGFFeLdHBy9CYbzIS.NhYyA26LGTAVoLxhCQUK%2F2Bs34MW5kGHmErKzG6r3XI", s);
    }

    @Test
    public void testSecureCookieWithHttps() throws Exception {
        URL url = new URL("https://a.b.c/");
        man.addCookieFromHeader(
                "mySASession=s%3AcafPSGf6UJguyhddGFFeLdHBy9CYbzIS.NhYyA26LGTAVoLxhCQUK%2F2Bs34MW5kGHmErKzG6r3XI; Path=/;"
                + " Expires=Tue, 07 Feb 2990 09:13:14 GMT; HttpOnly; secure",
                url);
        assertEquals(1,man.getCookieCount());
        String s = man.getCookieHeaderForURL(url);
        assertNotNull(s);
        assertEquals("mySASession=s%3AcafPSGf6UJguyhddGFFeLdHBy9CYbzIS.NhYyA26LGTAVoLxhCQUK%2F2Bs34MW5kGHmErKzG6r3XI", s);
    }

```

[825, 'test/src', 'org.apache.jmeter.protocol.http.control', 'TestHC4CookieManager', 'testSendCookie', 80, 88]

[825, 'test/src', 'org.apache.jmeter.protocol.http.control', 'TestHC4CookieManager', 'testSendCookie2', 90, 99]

```java

    @Test
    public void testSendCookie() throws Exception {
        man.add(new Cookie("id", "value", "jakarta.apache.org", "/", false, 9999999999L));
        HTTPSamplerBase sampler = new HTTPNullSampler();
        sampler.setDomain("jakarta.apache.org");
        sampler.setPath("/index.html");
        sampler.setMethod(HTTPConstants.GET);
        assertNotNull(man.getCookieHeaderForURL(sampler.getUrl()));
    }

    @Test
    public void testSendCookie2() throws Exception {
        man.add(new Cookie("id", "value", ".apache.org", "/", false, 9999999999L));
        HTTPSamplerBase sampler = new HTTPNullSampler();
        sampler.setDomain("jakarta.apache.org");

        sampler.setPath("/index.html");
        sampler.setMethod(HTTPConstants.GET);
        assertNotNull(man.getCookieHeaderForURL(sampler.getUrl()));
    }
    
``` 

### 45

[125, 'test/src', 'org.apache.jmeter.control', 'TestWhileController', 'testVariable1', 169, 217]

[125, 'test/src', 'org.apache.jmeter.control', 'TestWhileController', 'testVariable2', 220, 269]

```java

    @Test
    public void testVariable1() throws Exception {
        GenericController controller = new GenericController();
        WhileController while_cont = new WhileController();
        setLastSampleStatus(false);
        while_cont.setCondition("${VAR}");
        jmvars.put("VAR", "");
        ValueReplacer vr = new ValueReplacer();
        vr.replaceValues(while_cont);
        setRunning(while_cont);
        controller.addTestElement(new TestSampler("before"));
        controller.addTestElement(while_cont);
        while_cont.addTestElement(new TestSampler("one"));
        while_cont.addTestElement(new TestSampler("two"));
        GenericController simple = new GenericController();
        while_cont.addTestElement(simple);
        simple.addTestElement(new TestSampler("three"));
        simple.addTestElement(new TestSampler("four"));
        controller.addTestElement(new TestSampler("after"));
        controller.initialize();
        for (int i = 1; i <= 3; i++) {
            assertEquals("Loop: "+i,"before", nextName(controller));
            assertEquals("Loop: "+i,"one", nextName(controller));
            assertEquals("Loop: "+i,"two", nextName(controller));
            assertEquals("Loop: "+i,"three", nextName(controller));
            assertEquals("Loop: "+i,"four", nextName(controller));
            assertEquals("Loop: "+i,"after", nextName(controller));
            assertNull("Loop: "+i,nextName(controller));
        }
        jmvars.put("VAR", "LAST"); // Should not enter the loop
        for (int i = 1; i <= 3; i++) {
            assertEquals("Loop: "+i,"before", nextName(controller));
            assertEquals("Loop: "+i,"after", nextName(controller));
            assertNull("Loop: "+i,nextName(controller));
        }
        jmvars.put("VAR", "");
        for (int i = 1; i <= 3; i++) {
            assertEquals("Loop: "+i,"before", nextName(controller));
            if (i==1) {
                assertEquals("Loop: "+i,"one", nextName(controller));
                assertEquals("Loop: "+i,"two", nextName(controller));
                assertEquals("Loop: "+i,"three", nextName(controller));
                jmvars.put("VAR", "LAST"); // Should not enter the loop next time
                assertEquals("Loop: "+i,"four", nextName(controller));
            }
            assertEquals("Loop: "+i,"after", nextName(controller));
            assertNull("Loop: "+i,nextName(controller));
        }
    }

    @Test
    public void testVariable2() throws Exception {
        GenericController controller = new GenericController();
        WhileController while_cont = new WhileController();
        setLastSampleStatus(false);
        while_cont.setCondition("${VAR}");
        jmvars.put("VAR", "");
        ValueReplacer vr = new ValueReplacer();
        vr.replaceValues(while_cont);
        setRunning(while_cont);
        controller.addTestElement(new TestSampler("before"));
        controller.addTestElement(while_cont);
        GenericController simple = new GenericController();
        while_cont.addTestElement(simple);
        simple.addTestElement(new TestSampler("one"));
        simple.addTestElement(new TestSampler("two"));
        while_cont.addTestElement(new TestSampler("three"));
        while_cont.addTestElement(new TestSampler("four"));
        controller.addTestElement(new TestSampler("after"));
        controller.initialize();
        for (int i = 1; i <= 3; i++) {
            assertEquals("Loop: "+i,"before", nextName(controller));
            assertEquals("Loop: "+i,"one", nextName(controller));
            assertEquals("Loop: "+i,"two", nextName(controller));
            assertEquals("Loop: "+i,"three", nextName(controller));
            assertEquals("Loop: "+i,"four", nextName(controller));
            assertEquals("Loop: "+i,"after", nextName(controller));
            assertNull("Loop: "+i,nextName(controller));
        }
        jmvars.put("VAR", "LAST"); // Should not enter the loop
        for (int i = 1; i <= 3; i++) {
            assertEquals("Loop: "+i,"before", nextName(controller));
            assertEquals("Loop: "+i,"after", nextName(controller));
            assertNull("Loop: "+i,nextName(controller));
        }
        jmvars.put("VAR", "");
        for (int i = 1; i <= 3; i++) {
            assertEquals("Loop: "+i,"before", nextName(controller));
            if (i==1){
                assertEquals("Loop: "+i,"one", nextName(controller));
                assertEquals("Loop: "+i,"two", nextName(controller));
                jmvars.put("VAR", "LAST"); // Should not enter the loop next time
                // But should continue to the end of the loop
                assertEquals("Loop: "+i,"three", nextName(controller));
                assertEquals("Loop: "+i,"four", nextName(controller));
            }
            assertEquals("Loop: "+i,"after", nextName(controller));
            assertNull("Loop: "+i,nextName(controller));
        }
    }
```

### 46

[168, 'test/src', 'org.apache.jmeter.protocol.http.modifier', 'TestAnchorModifier', 'testSimpleParse4', 206, 222]

[168, 'test/src', 'org.apache.jmeter.protocol.http.modifier', 'TestAnchorModifier', 'testSimpleParse5', 224, 240]

```java

    @Test
    public void testSimpleParse4() throws Exception {
        HTTPSamplerBase config = makeUrlConfig("/subdir/index\\..*");
        HTTPSamplerBase context = makeContext("http://www.apache.org/subdir/previous.html");
        String responseText = "<html><head><title>Test page</title></head><body>"
                + "<A HREF=\"index.html\">Goto index page</A></body></html>";
        HTTPSampleResult result = new HTTPSampleResult();
        result.setResponseData(responseText, null);
        result.setSampleLabel(context.toString());
        result.setURL(context.getUrl());
        jmctx.setCurrentSampler(context);
        jmctx.setCurrentSampler(config);
        jmctx.setPreviousResult(result);
        parser.process();
        String newUrl = config.getUrl().toString();
        assertEquals("http://www.apache.org/subdir/index.html", newUrl);
    }

    @Test
    public void testSimpleParse5() throws Exception {
        HTTPSamplerBase config = makeUrlConfig("/subdir/index\\.h.*");
        HTTPSamplerBase context = makeContext("http://www.apache.org/subdir/one/previous.html");
        String responseText = "<html><head><title>Test page</title></head><body>"
                + "<a href=\"../index.html\">Goto index page</a></body></html>";
        HTTPSampleResult result = new HTTPSampleResult();
        result.setResponseData(responseText, null);
        result.setSampleLabel(context.toString());
        result.setURL(context.getUrl());
        jmctx.setCurrentSampler(context);
        jmctx.setCurrentSampler(config);
        jmctx.setPreviousResult(result);
        parser.process();
        String newUrl = config.getUrl().toString();
        assertEquals("http://www.apache.org/subdir/index.html", newUrl);
    }
```

### 47

[323, 'test/src', 'org.apache.jmeter.protocol.http.proxy', 'TestHttpRequestHdr', 'testParse1', 523, 536]

[323, 'test/src', 'org.apache.jmeter.protocol.http.proxy', 'TestHttpRequestHdr', 'testParse2', 539, 552]

```java
@Test
public void testParse1() throws Exception {// no space after :
    HttpRequestHdr req = new HttpRequestHdr();
    ByteArrayInputStream bis = null;
    bis = new ByteArrayInputStream("GET xxx HTTP/1.0\r\nname:value \r\n".getBytes("ISO-8859-1"));
    req.parse(bis);
    bis.close();
    HeaderManager mgr = req.getHeaderManager();
    Header header;
    mgr.getHeaders();
    header = mgr.getHeader(0);
    assertEquals("name",header.getName());
    assertEquals("value",header.getValue());
}

@Test
public void testParse2() throws Exception {// spaces after :
    HttpRequestHdr req = new HttpRequestHdr();
    ByteArrayInputStream bis = null;
    bis = new ByteArrayInputStream("GET xxx HTTP/1.0\r\nname:           value \r\n".getBytes("ISO-8859-1"));
    req.parse(bis);
    bis.close();
    HeaderManager mgr = req.getHeaderManager();
    Header header;
    mgr.getHeaders();
    header = mgr.getHeader(0);
    assertEquals("name",header.getName());
    assertEquals("value",header.getValue());
}
```

### 48

[373, 'test/src', 'org.apache.jmeter.functions', 'EvalFunctionTest', 'evalTest1', 46, 60]

[373, 'test/src', 'org.apache.jmeter.functions', 'EvalFunctionTest', 'evalTest2', 62, 75]

```java

@Test
public void evalTest1() throws Exception {
    EvalFunction eval = new EvalFunction();
    vars.put("query","select ${column} from ${table}");
    vars.put("column","name");
    vars.put("table","customers");
    Collection<CompoundVariable> parms;
    String s;

    parms = makeParams("${query}",null,null);
    eval.setParameters(parms);
    s = eval.execute(null,null);
    assertEquals("select name from customers",s);

}

@Test
public void evalTest2() throws Exception {
    EvalVarFunction evalVar = new EvalVarFunction();
    vars.put("query","select ${column} from ${table}");
    vars.put("column","name");
    vars.put("table","customers");
    Collection<CompoundVariable> parms;
    String s;

    parms = makeParams("query",null,null);
    evalVar.setParameters(parms);
    s = evalVar.execute(null,null);
    assertEquals("select name from customers",s);
}
```

### 49

[395, 'test/src', 'org.apache.jmeter.protocol.http.modifier', 'TestAnchorModifier', 'testSimpleFormParse', 296, 315]

[395, 'test/src', 'org.apache.jmeter.protocol.http.modifier', 'TestAnchorModifier', 'testBadCharParse', 317, 336]

```java

    @Test
    public void testSimpleFormParse() throws Exception {
        HTTPSamplerBase config = makeUrlConfig(".*index.html");
        config.addArgument("test", "g.*");
        config.setMethod(HTTPConstants.POST);
        HTTPSamplerBase context = makeContext("http://www.apache.org/subdir/previous.html");
        String responseText = "<html><head><title>Test page</title></head><body>"
                + "<form action=\"index.html\" method=\"POST\">" + "<input type=\"checkbox\" name=\"test\""
                + " value=\"goto\">Goto index page</form></body></html>";
        HTTPSampleResult result = new HTTPSampleResult();
        result.setResponseData(responseText, null);
        result.setSampleLabel(context.toString());
        result.setURL(context.getUrl());
        jmctx.setCurrentSampler(context);
        jmctx.setCurrentSampler(config);
        jmctx.setPreviousResult(result);
        parser.process();
        assertEquals("http://www.apache.org/subdir/index.html", config.getUrl().toString());
        assertEquals("test=goto", config.getQueryString());
    }

    @Test
    public void testBadCharParse() throws Exception {
        HTTPSamplerBase config = makeUrlConfig(".*index.html");
        config.addArgument("te$st", "g.*");
        config.setMethod(HTTPConstants.POST);
        HTTPSamplerBase context = makeContext("http://www.apache.org/subdir/previous.html");
        String responseText = "<html><head><title>Test page</title></head><body>"
                + "<form action=\"index.html\" method=\"POST\">" + "<input type=\"checkbox\" name=\"te$st\""
                + " value=\"goto\">Goto index page</form></body></html>";
        HTTPSampleResult result = new HTTPSampleResult();
        result.setResponseData(responseText, null);
        result.setSampleLabel(context.toString());
        result.setURL(context.getUrl());
        jmctx.setCurrentSampler(context);
        jmctx.setCurrentSampler(config);
        jmctx.setPreviousResult(result);
        parser.process();
        assertEquals("http://www.apache.org/subdir/index.html", config.getUrl().toString());
        assertEquals("te%24st=goto", config.getQueryString());
    }
```

### 50

[448, 'test/src', 'org.apache.jmeter.curl', 'BasicCurlParserTest', 'testChromeParsing', 51, 65]

[448, 'test/src', 'org.apache.jmeter.curl', 'BasicCurlParserTest', 'testPost', 95, 109]

```java

@Test
public void testChromeParsing() {
    String cmdLine = "curl 'https://jmeter.apache.org/' -H 'Proxy-Connection: keep-alive' "
            + "-H 'Proxy-Authorization: Basic XXXXXXXXX/' -H 'Upgrade-Insecure-Requests: 1' "
            + "-H 'User-Agent: Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) "
            + "Chrome/70.0.3538.102 Mobile Safari/537.36' "
            + "-H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8' "
            + "-H 'Accept-Encoding: gzip, deflate' -H 'Accept-Language: en-US,en;q=0.9,fr;q=0.8' --compressed";
    BasicCurlParser basicCurlParser = new BasicCurlParser();
    BasicCurlParser.Request request = basicCurlParser.parse(cmdLine);
    Assert.assertEquals("https://jmeter.apache.org/", request.getUrl());
    Assert.assertEquals(7, request.getHeaders().size());
    Assert.assertTrue(request.isCompressed());
    Assert.assertEquals("GET", request.getMethod());
}

@Test
public void testPost() {
    String cmdLine = "curl 'https://jmeter.apache.org/test' "
            + "-H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:63.0) Gecko/20100101 Firefox/63.0' -H 'Accept: */*' "
            + "-H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Referer: https://www.example.com/' "
            + "-H 'content-type: application/json;charset=UTF-8' -H 'Origin: https://www.example.com' "
            + "-H 'DNT: 1' -H 'Connection: keep-alive' -H 'TE: Trailers' "
            + "--data '{\"abc\":\"123\",\"no\":\"matter on sunshine\"}'";
    BasicCurlParser basicCurlParser = new BasicCurlParser();
    BasicCurlParser.Request request = basicCurlParser.parse(cmdLine);
    Assert.assertEquals("https://jmeter.apache.org/test", request.getUrl());
    Assert.assertEquals(9, request.getHeaders().size());
    Assert.assertTrue(request.isCompressed());
    Assert.assertEquals("POST", request.getMethod());
}
```

### 51

[493, 'test/src', 'org.apache.jmeter.protocol.http.config', 'MultipartUrlConfigTest', 'testParseArgumentsLF', 45, 92]

[493, 'test/src', 'org.apache.jmeter.protocol.http.config', 'MultipartUrlConfigTest', 'testParseArgumentsCRLF', 94, 141]

```java

@Test
public void testParseArgumentsLF() {
    String queryString
        = "Content-Disposition: form-data; name=\"aa\"\n"
        + "Content-Type: text/plain; charset=ISO-8859-1\n"
        + "Content-Transfer-Encoding: 8bit\n"
        + "\n"
        + "bb\n"
        + "--7d159c1302d0y0\n"
        + "Content-Disposition: form-data; name=\"xx\"\n"
        + "Content-Type: text/plain; charset=ISO-8859-1\n"
        + "Content-Transfer-Encoding: 8bit\n"
        + "\n"
        + "yy\n"
        + "--7d159c1302d0y0\n"
        + "Content-Disposition: form-data; name=\"abc\"\n"
        + "Content-Type: text/plain; charset=ISO-8859-1\n"
        + "Content-Transfer-Encoding: 8bit\n"
        + "\n"
        + "xyz  \n"
        + "xyz  \n"
        + "--7d159c1302d0y0\n"
        + "Content-Disposition: form-data; name=\"param1\"; filename=\"file1\"\n"
        + "Content-Type: text/plain\n"
        + "Content-Transfer-Encoding: binary\n"
        + "\n"
        + "file content\n"
        + "\n";
    MultipartUrlConfig muc = new MultipartUrlConfig("7d159c1302d0y0");
    muc.parseArguments(queryString);
    HTTPFileArgs files = muc.getHTTPFileArgs();
    assertEquals(1, files.getHTTPFileArgCount());
    HTTPFileArg file = (HTTPFileArg) files.iterator().next().getObjectValue();
    assertEquals("file1", file.getPath());
    assertEquals("param1", file.getParamName());
    assertEquals("text/plain", file.getMimeType());
    Arguments args = muc.getArguments();
    assertEquals(3, args.getArgumentCount());
    Argument arg = args.getArgument(0);
    assertEquals("aa", arg.getName());
    assertEquals("bb", arg.getValue());
    arg = args.getArgument(1);
    assertEquals("xx", arg.getName());
    assertEquals("yy", arg.getValue());
    arg = args.getArgument(2);
    assertEquals("abc", arg.getName());
    assertEquals("xyz  \nxyz  ", arg.getValue());
}

@Test
public void testParseArgumentsCRLF() {
    String queryString
        = "Content-Disposition: form-data; name=\"aa\"\r\n"
        + "Content-Type: text/plain; charset=ISO-8859-1\r\n"
        + "Content-Transfer-Encoding: 8bit\r\n"
        + "\r\n"
        + "bb\r\n"
        + "--7d159c1302d0y0\r\n"
        + "Content-Disposition: form-data; name=\"xx\"\r\n"
        + "Content-Type: text/plain; charset=ISO-8859-1\r\n"
        + "Content-Transfer-Encoding: 8bit\r\n"
        + "\r\n"
        + "yy\r\n"
        + "--7d159c1302d0y0\r\n"
        + "Content-Disposition: form-data; name=\"abc\"\r\n"
        + "Content-Type: text/plain; charset=ISO-8859-1\r\n"
        + "Content-Transfer-Encoding: 8bit\r\n"
        + "\r\n"
        + "xyz  \r\n"
        + "xyz  \r\n"
        + "--7d159c1302d0y0\r\n"
        + "Content-Disposition: form-data; name=\"param1\"; filename=\"file1\"\r\n"
        + "Content-Type: text/plain\r\n"
        + "Content-Transfer-Encoding: binary\r\n"
        + "\r\n"
        + "file content\r\n"
        + "\r\n";
    MultipartUrlConfig muc = new MultipartUrlConfig("7d159c1302d0y0");
    muc.parseArguments(queryString);
    HTTPFileArgs files = muc.getHTTPFileArgs();
    assertEquals(1, files.getHTTPFileArgCount());
    HTTPFileArg file = (HTTPFileArg) files.iterator().next().getObjectValue();
    assertEquals("file1", file.getPath());
    assertEquals("param1", file.getParamName());
    assertEquals("text/plain", file.getMimeType());
    Arguments args = muc.getArguments();
    assertEquals(3, args.getArgumentCount());
    Argument arg = args.getArgument(0);
    assertEquals("aa", arg.getName());
    assertEquals("bb", arg.getValue());
    arg = args.getArgument(1);
    assertEquals("xx", arg.getName());
    assertEquals("yy", arg.getValue());
    arg = args.getArgument(2);
    assertEquals("abc", arg.getName());
    assertEquals("xyz  \r\nxyz  ", arg.getValue());
}
```

### 52

[580, 'test/src', 'org.apache.jmeter.protocol.http.modifier', 'TestURLRewritingModifier', 'testGrabSessionId', 61, 76]

[580, 'test/src', 'org.apache.jmeter.protocol.http.modifier', 'TestURLRewritingModifier', 'testGrabSessionId6', 115, 130]

```java
    @Test
    public void testGrabSessionId() throws Exception {
        String html = "location: http://server.com/index.html" + "?session_id=jfdkjdkf%20jddkfdfjkdjfdf%22;";
        response = new SampleResult();
        response.setResponseData(html, null);
        mod.setArgumentName("session_id");
        HTTPSamplerBase sampler = createSampler();
        sampler.addArgument("session_id", "adfasdfdsafasdfasd");
        context.setCurrentSampler(sampler);
        context.setPreviousResult(response);
        mod.process();
        Arguments args = sampler.getArguments();
        assertEquals("jfdkjdkf jddkfdfjkdjfdf\"", ((Argument) args.getArguments().get(0).getObjectValue())
                .getValue());
        assertEquals("http://server.com/index.html?" + "session_id=jfdkjdkf+jddkfdfjkdjfdf%22", sampler.toString());
    }

    @Test
    public void testGrabSessionId6() throws Exception {
        String html = "location: http://server.com/index.html" + "?session_id=bonjour+monsieur";
        response = new SampleResult();
        response.setResponseData(html, null);
        mod.setArgumentName("session_id");
        HTTPSamplerBase sampler = createSampler();
        sampler.addArgument("session_id", "adfasdfdsafasdfasd");
        context.setCurrentSampler(sampler);
        context.setPreviousResult(response);
        mod.process();
        Arguments args = sampler.getArguments();
        assertEquals("bonjour monsieur", ((Argument) args.getArguments().get(0).getObjectValue())
                .getValue());
        assertEquals("http://server.com/index.html?" + "session_id=bonjour+monsieur", sampler.toString());
    }
``` 

### gson_2.8.5

### 53

[24, 'src/test/java', 'com.google.gson.internal', 'LinkedHashTreeMapTest', 'testForceDoublingAndRehash', 104, 118]

[24, 'src/test/java', 'com.google.gson.internal', 'LinkedTreeMapTest', 'testLargeSetOfRandomKeys', 101, 115]

```java

  public void testForceDoublingAndRehash() throws Exception {
    Random random = new Random(1367593214724L);
    LinkedHashTreeMap<String, String> map = new LinkedHashTreeMap<String, String>();
    String[] keys = new String[1000];
    for (int i = 0; i < keys.length; i++) {
      keys[i] = Integer.toString(Math.abs(random.nextInt()), 36) + "-" + i;
      map.put(keys[i], "" + i);
    }

    for (int i = 0; i < keys.length; i++) {
      String key = keys[i];
      assertTrue(map.containsKey(key));
      assertEquals("" + i, map.get(key));
    }
  }

  public void testLargeSetOfRandomKeys() throws Exception {
    Random random = new Random(1367593214724L);
    LinkedTreeMap<String, String> map = new LinkedTreeMap<String, String>();
    String[] keys = new String[1000];
    for (int i = 0; i < keys.length; i++) {
      keys[i] = Integer.toString(Math.abs(random.nextInt()), 36) + "-" + i;
      map.put(keys[i], "" + i);
    }

    for (int i = 0; i < keys.length; i++) {
      String key = keys[i];
      assertTrue(map.containsKey(key));
      assertEquals("" + i, map.get(key));
    }
  }

```

### 54

[43, 'src/test/java', 'com.google.gson.functional', 'RawSerializationTest', 'testTwoLevelParameterizedObject', 64, 73]

[43, 'src/test/java', 'com.google.gson.functional', 'RawSerializationTest', 'testThreeLevelParameterizedObject', 75, 84]

```java

  public void testTwoLevelParameterizedObject() {
    Bar<Bar<Foo>> bar = new Bar<Bar<Foo>>(new Bar<Foo>(new Foo(1)));
    String expectedJson = "{\"t\":{\"t\":{\"b\":1}}}";
    // Ensure that serialization works without specifying the type explicitly
    String json = gson.toJson(bar);
    assertEquals(expectedJson, json);
    // Ensure that serialization also works when the type is specified explicitly
    json = gson.toJson(bar, new TypeToken<Bar<Bar<Foo>>>(){}.getType());
    assertEquals(expectedJson, json);
  }

  public void testThreeLevelParameterizedObject() {
    Bar<Bar<Bar<Foo>>> bar = new Bar<Bar<Bar<Foo>>>(new Bar<Bar<Foo>>(new Bar<Foo>(new Foo(1))));
    String expectedJson = "{\"t\":{\"t\":{\"t\":{\"b\":1}}}}";
    // Ensure that serialization works without specifying the type explicitly
    String json = gson.toJson(bar);
    assertEquals(expectedJson, json);
    // Ensure that serialization also works when the type is specified explicitly
    json = gson.toJson(bar, new TypeToken<Bar<Bar<Bar<Foo>>>>(){}.getType());
    assertEquals(expectedJson, json);
  }
```

### 55

[158, 'src/test/java', 'com.google.gson.stream', 'JsonReaderTest', 'testLenientNonExecutePrefix', 1300, 1306]

[158, 'src/test/java', 'com.google.gson.stream', 'JsonReaderTest', 'testLenientNonExecutePrefixWithLeadingWhitespace', 1308, 1314]

```java

  public void testLenientNonExecutePrefix() throws IOException {
    JsonReader reader = new JsonReader(reader(")]}'\n []"));
    reader.setLenient(true);
    reader.beginArray();
    reader.endArray();
    assertEquals(JsonToken.END_DOCUMENT, reader.peek());
  }

  public void testLenientNonExecutePrefixWithLeadingWhitespace() throws IOException {
    JsonReader reader = new JsonReader(reader("\r\n \t)]}'\n []"));
    reader.setLenient(true);
    reader.beginArray();
    reader.endArray();
    assertEquals(JsonToken.END_DOCUMENT, reader.peek());
  }
```

### 56

[339, 'src/test/java', 'com.google.gson.stream', 'JsonReaderPathTest', 'arrayOfArrays', 221, 239]

[339, 'src/test/java', 'com.google.gson.stream', 'JsonReaderPathTest', 'arrayOfObjects', 201, 219]

```java

  @Test public void arrayOfArrays() throws IOException {
    JsonReader reader = factory.create("[[],[],[]]");
    reader.beginArray();
    assertEquals("$[0]", reader.getPath());
    reader.beginArray();
    assertEquals("$[0][0]", reader.getPath());
    reader.endArray();
    assertEquals("$[1]", reader.getPath());
    reader.beginArray();
    assertEquals("$[1][0]", reader.getPath());
    reader.endArray();
    assertEquals("$[2]", reader.getPath());
    reader.beginArray();
    assertEquals("$[2][0]", reader.getPath());
    reader.endArray();
    assertEquals("$[3]", reader.getPath());
    reader.endArray();
    assertEquals("$", reader.getPath());
  }

  @Test public void arrayOfObjects() throws IOException {
    JsonReader reader = factory.create("[{},{},{}]");
    reader.beginArray();
    assertEquals("$[0]", reader.getPath());
    reader.beginObject();
    assertEquals("$[0].", reader.getPath());
    reader.endObject();
    assertEquals("$[1]", reader.getPath());
    reader.beginObject();
    assertEquals("$[1].", reader.getPath());
    reader.endObject();
    assertEquals("$[2]", reader.getPath());
    reader.beginObject();
    assertEquals("$[2].", reader.getPath());
    reader.endObject();
    assertEquals("$[3]", reader.getPath());
    reader.endArray();
    assertEquals("$", reader.getPath());
  }
```

### zookeeper_3.5.4

### 57


[244, 'src/java/test', 'org.apache.zookeeper.server', 'ZooKeeperServerMainTest', 'testReadOnlyTxnLogDir', 251, 283]

[244, 'src/java/test', 'org.apache.zookeeper.server', 'ZooKeeperServerMainTest', 'testReadOnlySnapshotDir', 211, 243]

```java

@Test(timeout = 30000)
public void testReadOnlyTxnLogDir() throws Exception {
    ClientBase.setupTestEnv();
    final int CLIENT_PORT = PortAssignment.unique();

    // Start up the ZK server to automatically create the necessary directories
    // and capture the directory where data is stored
    MainThread main = new MainThread(CLIENT_PORT, true, null);
    File tmpDir = main.tmpDir;
    main.start();
    Assert.assertTrue("waiting for server being up", ClientBase
            .waitForServerUp("127.0.0.1:" + CLIENT_PORT,
                    CONNECTION_TIMEOUT / 2));
    main.shutdown();

    // Make the transaction log directory read only
    File logDir = new File(main.logDir, FileTxnSnapLog.version + FileTxnSnapLog.VERSION);
    logDir.setWritable(false);

    // Restart ZK and observe a failure
    main = new MainThread(CLIENT_PORT, false, tmpDir, null);
    main.start();

    Assert.assertFalse("waiting for server being up", ClientBase
            .waitForServerUp("127.0.0.1:" + CLIENT_PORT,
                    CONNECTION_TIMEOUT / 2));

    main.shutdown();

    logDir.setWritable(true);

    main.deleteDirs();
}

@Test(timeout = 30000)
public void testReadOnlySnapshotDir() throws Exception {
    ClientBase.setupTestEnv();
    final int CLIENT_PORT = PortAssignment.unique();

    // Start up the ZK server to automatically create the necessary directories
    // and capture the directory where data is stored
    MainThread main = new MainThread(CLIENT_PORT, true, null);
    File tmpDir = main.tmpDir;
    main.start();
    Assert.assertTrue("waiting for server being up", ClientBase
            .waitForServerUp("127.0.0.1:" + CLIENT_PORT,
                    CONNECTION_TIMEOUT / 2));
    main.shutdown();

    // Make the snapshot directory read only
    File snapDir = new File(main.dataDir, FileTxnSnapLog.version + FileTxnSnapLog.VERSION);
    snapDir.setWritable(false);

    // Restart ZK and observe a failure
    main = new MainThread(CLIENT_PORT, false, tmpDir, null);
    main.start();

    Assert.assertFalse("waiting for server being up", ClientBase
            .waitForServerUp("127.0.0.1:" + CLIENT_PORT,
                    CONNECTION_TIMEOUT / 2));

    main.shutdown();

    snapDir.setWritable(true);

    main.deleteDirs();
}
```

### 58

[510, 'src/java/test', 'org.apache.zookeeper', 'ZooKeeperTest', 'testACLWithExtraAgruments', 302, 312]

[510, 'src/java/test', 'org.apache.zookeeper', 'ZooKeeperTest', 'testCreatePersistentNode', 314, 322]

```java

@Test
public void testACLWithExtraAgruments() throws Exception {
    final ZooKeeper zk = createClient();
    ZooKeeperMain zkMain = new ZooKeeperMain(zk);
    // create persistent sequential node
    String cmdstring = "create -s /l data ip:10.18.52.144:cdrwa f g h";
    zkMain.cl.parseCommand(cmdstring);
    Assert.assertTrue(
            "Not considering the extra arguments after the acls.", zkMain
                    .processZKCmd(zkMain.cl));
}

@Test
public void testCreatePersistentNode() throws Exception {
    final ZooKeeper zk = createClient();
    ZooKeeperMain zkMain = new ZooKeeperMain(zk);
    String cmdstring = "create /node2";
    zkMain.cl.parseCommand(cmdstring);
    Assert.assertTrue("Not creating Persistent node.", zkMain
            .processZKCmd(zkMain.cl));
}
```

### 59

[512, 'src/java/test', 'org.apache.zookeeper.test', 'SaslAuthFailTest', 'testAuthFail', 63, 75]

[512, 'src/java/test', 'org.apache.zookeeper.test', 'SaslAuthMissingClientConfigTest', 'testAuth', 67, 80]

```java
@Test
public void testAuthFail() throws Exception {
    ZooKeeper zk = createClient();
    try {
        zk.create("/path1", null, Ids.CREATOR_ALL_ACL, CreateMode.PERSISTENT);
        Assert.fail("Should have gotten exception.");
    } catch(Exception e ) {
        // ok, exception as expected.
        LOG.info("Got exception as expected: " + e);
    } finally {
        zk.close();
    }
}

@Test
public void testAuth() throws Exception {
    ZooKeeper zk = createClient();
    try {
        zk.create("/path1", null, Ids.CREATOR_ALL_ACL, CreateMode.PERSISTENT);
        Assert.fail("Should have gotten exception.");
    } catch (KeeperException e) {
        // ok, exception as expected.
        LOG.info("Got exception as expected: " + e);
    }
    finally {
        zk.close();
    }
}
```

### 60

[1329, 'src/java/test', 'org.apache.zookeeper.server', 'CreateTTLTest', 'testCreate', 63, 78]

[1329, 'src/java/test', 'org.apache.zookeeper.server', 'Emulate353TTLTest', 'testCreate', 51, 66]

```java
@Test
public void testCreate()
        throws KeeperException, InterruptedException {
    Stat stat = new Stat();
    zk.create("/foo", new byte[0], ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT_WITH_TTL, stat, 100);
    Assert.assertEquals(0, stat.getEphemeralOwner());

    final AtomicLong fakeElapsed = new AtomicLong(0);
    ContainerManager containerManager = newContainerManager(fakeElapsed);
    containerManager.checkContainers();
    Assert.assertNotNull("Ttl node should not have been deleted yet", zk.exists("/foo", false));

    fakeElapsed.set(1000);
    containerManager.checkContainers();
    Assert.assertNull("Ttl node should have been deleted", zk.exists("/foo", false));
}

@Test
public void testCreate()
        throws KeeperException, InterruptedException {
    Stat stat = new Stat();
    zk.create("/foo", new byte[0], ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT_WITH_TTL, stat, 100);
    Assert.assertEquals(0, stat.getEphemeralOwner());

    final AtomicLong fakeElapsed = new AtomicLong(0);
    ContainerManager containerManager = newContainerManager(fakeElapsed);
    containerManager.checkContainers();
    Assert.assertNotNull("Ttl node should not have been deleted yet", zk.exists("/foo", false));

    fakeElapsed.set(1000);
    containerManager.checkContainers();
    Assert.assertNull("Ttl node should have been deleted", zk.exists("/foo", false));
}
```

### commons_collections_4.3

### 61

[180, 'src/test/java', 'org.apache.commons.collections4.map', 'Flat3MapTest', 'testEquals1', 61, 70]

[180, 'src/test/java', 'org.apache.commons.collections4.map', 'Flat3MapTest', 'testEquals2', 72, 81]

```java

@SuppressWarnings("unchecked")
public void testEquals1() {
    final Flat3Map<K, V> map1 = makeObject();
    map1.put((K) "a", (V) "testA");
    map1.put((K) "b", (V) "testB");
    final Flat3Map<K, V> map2 = makeObject();
    map2.put((K) "a", (V) "testB");
    map2.put((K) "b", (V) "testA");
    assertEquals(false, map1.equals(map2));
}

@SuppressWarnings("unchecked")
public void testEquals2() {
    final Flat3Map<K, V> map1 = makeObject();
    map1.put((K) "a", (V) "testA");
    map1.put((K) "b", (V) "testB");
    final Flat3Map<K, V> map2 = makeObject();
    map2.put((K) "a", (V) "testB");
    map2.put((K) "c", (V) "testA");
    assertEquals(false, map1.equals(map2));
}
```

### 62

[404, 'src/test/java', 'org.apache.commons.collections4.set', 'ListOrderedSet2Test', 'testListAddRemove', 88, 116]

[404, 'src/test/java', 'org.apache.commons.collections4.set', 'ListOrderedSetTest', 'testListAddRemove', 99, 127]

```java

@SuppressWarnings("unchecked")
public void testListAddRemove() {
    final ListOrderedSet<E> set = makeObject();
    final List<E> view = set.asList();
    set.add((E) ZERO);
    set.add((E) ONE);
    set.add((E) TWO);

    assertEquals(3, set.size());
    assertSame(ZERO, set.get(0));
    assertSame(ONE, set.get(1));
    assertSame(TWO, set.get(2));
    assertEquals(3, view.size());
    assertSame(ZERO, view.get(0));
    assertSame(ONE, view.get(1));
    assertSame(TWO, view.get(2));

    assertEquals(0, set.indexOf(ZERO));
    assertEquals(1, set.indexOf(ONE));
    assertEquals(2, set.indexOf(TWO));

    set.remove(1);
    assertEquals(2, set.size());
    assertSame(ZERO, set.get(0));
    assertSame(TWO, set.get(1));
    assertEquals(2, view.size());
    assertSame(ZERO, view.get(0));
    assertSame(TWO, view.get(1));
}

@SuppressWarnings("unchecked")
public void testListAddRemove() {
    final ListOrderedSet<E> set = makeObject();
    final List<E> view = set.asList();
    set.add((E) ZERO);
    set.add((E) ONE);
    set.add((E) TWO);

    assertEquals(3, set.size());
    assertSame(ZERO, set.get(0));
    assertSame(ONE, set.get(1));
    assertSame(TWO, set.get(2));
    assertEquals(3, view.size());
    assertSame(ZERO, view.get(0));
    assertSame(ONE, view.get(1));
    assertSame(TWO, view.get(2));

    assertEquals(0, set.indexOf(ZERO));
    assertEquals(1, set.indexOf(ONE));
    assertEquals(2, set.indexOf(TWO));

    set.remove(1);
    assertEquals(2, set.size());
    assertSame(ZERO, set.get(0));
    assertSame(TWO, set.get(1));
    assertEquals(2, view.size());
    assertSame(ZERO, view.get(0));
    assertSame(TWO, view.get(1));
}

```

### 63

[423, 'src/test/java', 'org.apache.commons.collections4.iterators', 'LoopingListIteratorTest', 'testRemovingElementsAndIteratingForward', 171, 197]

[423, 'src/test/java', 'org.apache.commons.collections4.iterators', 'LoopingListIteratorTest', 'testRemovingElementsAndIteratingBackwards', 202, 228]

```java

@Test
public void testRemovingElementsAndIteratingForward() {
    final List<String> list = new ArrayList<>(Arrays.asList("a", "b", "c"));
    final LoopingListIterator<String> loop = new LoopingListIterator<>(list); // <a> b c

    assertTrue(loop.hasNext());
    assertEquals("a", loop.next()); // a <b> c
    loop.remove();                  // <b> c
    assertEquals(2, list.size());

    assertTrue(loop.hasNext());
    assertEquals("b", loop.next()); // b <c>
    loop.remove();                  // <c>
    assertEquals(1, list.size());

    assertTrue(loop.hasNext());
    assertEquals("c", loop.next()); // <c>
    loop.remove();                  // ---
    assertEquals(0, list.size());

    assertFalse(loop.hasNext());
    try {
        loop.next();
        fail();
    } catch (final NoSuchElementException ex) {
    }
}

@Test
public void testRemovingElementsAndIteratingBackwards() {
    final List<String> list = new ArrayList<>(Arrays.asList("a", "b", "c"));
    final LoopingListIterator<String> loop = new LoopingListIterator<>(list); // <a> b c

    assertTrue(loop.hasPrevious());
    assertEquals("c", loop.previous()); // a b <c>
    loop.remove();                      // <a> b
    assertEquals(2, list.size());

    assertTrue(loop.hasPrevious());
    assertEquals("b", loop.previous()); // a <b>
    loop.remove();                      // <a>
    assertEquals(1, list.size());

    assertTrue(loop.hasPrevious());
    assertEquals("a", loop.previous()); // <a>
    loop.remove();                      // ---
    assertEquals(0, list.size());

    assertFalse(loop.hasPrevious());
    try {
        loop.previous();
        fail();
    } catch (final NoSuchElementException ex) {
    }
}
```

### 64

[506, 'src/test/java', 'org.apache.commons.collections4.iterators', 'BoundedIteratorTest', 'testRemoveFirst', 250, 276]

[506, 'src/test/java', 'org.apache.commons.collections4.iterators', 'BoundedIteratorTest', 'testRemoveMiddle', 282, 308]

```java

@Test
public void testRemoveFirst() {
    final List<E> testListCopy = new ArrayList<>(testList);
    final Iterator<E> iter = new BoundedIterator<>(testListCopy.iterator(), 1, 5);

    assertTrue(iter.hasNext());
    assertEquals("b", iter.next());

    iter.remove();
    assertFalse(testListCopy.contains("b"));

    assertTrue(iter.hasNext());
    assertEquals("c", iter.next());
    assertTrue(iter.hasNext());
    assertEquals("d", iter.next());
    assertTrue(iter.hasNext());
    assertEquals("e", iter.next());
    assertTrue(iter.hasNext());
    assertEquals("f", iter.next());

    assertFalse(iter.hasNext());
    try {
        iter.next();
        fail("Expected NoSuchElementException.");
    } catch (final NoSuchElementException nsee) { /* Success case */
    }
}

@Test
public void testRemoveMiddle() {
    final List<E> testListCopy = new ArrayList<>(testList);
    final Iterator<E> iter = new BoundedIterator<>(testListCopy.iterator(), 1, 5);

    assertTrue(iter.hasNext());
    assertEquals("b", iter.next());
    assertTrue(iter.hasNext());
    assertEquals("c", iter.next());
    assertTrue(iter.hasNext());
    assertEquals("d", iter.next());

    iter.remove();
    assertFalse(testListCopy.contains("d"));

    assertTrue(iter.hasNext());
    assertEquals("e", iter.next());
    assertTrue(iter.hasNext());
    assertEquals("f", iter.next());

    assertFalse(iter.hasNext());
    try {
        iter.next();
        fail("Expected NoSuchElementException.");
    } catch (final NoSuchElementException nsee) { /* Success case */
    }
}
```

### 65

[526, 'src/test/java', 'org.apache.commons.collections4.map', 'StaticBucketMapTest', 'test_containsKey_nullMatchesIncorrectly', 75, 85]

[526, 'src/test/java', 'org.apache.commons.collections4.map', 'StaticBucketMapTest', 'test_containsValue_nullMatchesIncorrectly', 87, 97]

```java
@SuppressWarnings("unchecked")
public void test_containsKey_nullMatchesIncorrectly() {
    final StaticBucketMap<K, V> map = new StaticBucketMap<>(17);
    map.put(null, (V) "A");
    assertEquals(true, map.containsKey(null));
    // loop so we find a string that is in the same bucket as the null
    for (int i = 'A'; i <= 'Z'; i++) {
        final String str = String.valueOf((char) i);
        assertEquals("String: " + str, false, map.containsKey(str));
    }
}

@SuppressWarnings("unchecked")
public void test_containsValue_nullMatchesIncorrectly() {
    final StaticBucketMap<K, V> map = new StaticBucketMap<>(17);
    map.put((K) "A", null);
    assertEquals(true, map.containsValue(null));
    // loop so we find a string that is in the same bucket as the null
    for (int i = 'A'; i <= 'Z'; i++) {
        final String str = String.valueOf((char) i);
        assertEquals("String: " + str, false, map.containsValue(str));
    }
}
```